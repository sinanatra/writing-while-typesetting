(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();const Yi=!1;var pn=Array.isArray,ba=Array.prototype.indexOf,Qn=Array.from,On=Object.defineProperty,Pt=Object.getOwnPropertyDescriptor,ka=Object.getOwnPropertyDescriptors,wa=Object.prototype,xa=Array.prototype,Xi=Object.getPrototypeOf,Ei=Object.isExtensible;function ya(e){return e()}function nn(e){for(var t=0;t<e.length;t++)e[t]()}function Sa(){var e,t,n=new Promise((i,r)=>{e=i,t=r});return{promise:n,resolve:e,reject:t}}const he=2,Vn=4,hn=8,Bt=16,qe=32,rt=64,Ji=128,ve=256,rn=512,ne=1024,me=2048,Oe=4096,ke=8192,kt=16384,Yn=32768,Xn=65536,Ai=1<<17,$a=1<<18,Jn=1<<19,Kn=1<<20,jn=1<<21,er=1<<22,Xe=1<<23,He=Symbol("$state"),tr=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Ea(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function Ki(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Aa(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function za(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Ta(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Ra(e){throw new Error("https://svelte.dev/e/effect_orphan")}function Ia(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Ca(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Pa(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function La(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const dn=1,gn=2,es=4,Na=8,Ma=16,qa=1,Oa=2,te=Symbol();function ja(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}let Da=!1;function ts(e){return e===this.v}function Ba(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function ns(e){return!Ba(e,this.v)}let Ft=!1,Fa=!1;function Ha(){Ft=!0}let Q=null;function sn(e){Q=e}function rs(e,t=!1,n){Q={p:Q,c:null,e:null,s:e,x:null,l:Ft&&!t?{s:null,u:null,$:[]}:null}}function is(e){var t=Q,n=t.e;if(n!==null){t.e=null;for(var i of n)ws(i)}return Q=t.p,{}}function wt(){return!Ft||Q!==null&&Q.l===null}const Ua=new WeakMap;function Za(e){var t=q;if(t===null)return j.f|=Xe,e;if((t.f&Yn)===0){if((t.f&Ji)===0)throw!t.parent&&e instanceof Error&&ss(e),e;t.b.error(e)}else nr(e,t)}function nr(e,t){for(;t!==null;){if((t.f&Ji)!==0)try{t.b.error(e);return}catch(n){e=n}t=t.parent}throw e instanceof Error&&ss(e),e}function ss(e){const t=Ua.get(e);t&&(On(e,"message",{value:t.message}),On(e,"stack",{value:t.stack}))}let Mt=[],Dn=[];function ls(){var e=Mt;Mt=[],nn(e)}function Ga(){var e=Dn;Dn=[],nn(e)}function rr(e){Mt.length===0&&queueMicrotask(ls),Mt.push(e)}function Wa(){Mt.length>0&&ls(),Dn.length>0&&Ga()}function Qa(){for(var e=q.b;e!==null&&!e.has_pending_snippet();)e=e.parent;return e===null&&Ea(),e}function ir(e){var t=he|me,n=j!==null&&(j.f&he)!==0?j:null;return q===null||n!==null&&(n.f&ve)!==0?t|=ve:q.f|=Jn,{ctx:Q,deps:null,effects:null,equals:ts,f:t,fn:e,reactions:null,rv:0,v:te,wv:0,parent:n??q,ac:null}}function Va(e,t){let n=q;n===null&&Aa();var i=n.b,r=void 0,s=qt(te),l=null,o=!j;return uo(()=>{try{var u=e()}catch(v){u=Promise.reject(v)}var c=()=>u;r=l?.then(c,c)??Promise.resolve(u),l=r;var f=U,h=i.pending;o&&(i.update_pending_count(1),h||f.increment());const g=(v,p=void 0)=>{l=null,h||f.activate(),p?p!==tr&&(s.f|=Xe,bt(s,p)):((s.f&Xe)!==0&&(s.f^=Xe),bt(s,v)),o&&(i.update_pending_count(-1),h||f.decrement()),cs()};if(r.then(g,v=>g(null,v||"unknown")),f)return()=>{queueMicrotask(()=>f.neuter())}}),new Promise(u=>{function c(f){function h(){f===r?u(s):c(r)}f.then(h,h)}c(r)})}function as(e){const t=ir(e);return t.equals=ns,t}function os(e){var t=e.effects;if(t!==null){e.effects=null;for(var n=0;n<t.length;n+=1)Me(t[n])}}function Ya(e){for(var t=e.parent;t!==null;){if((t.f&he)===0)return t;t=t.parent}return null}function sr(e){var t,n=q;Ue(Ya(e));try{os(e),t=Ps(e)}finally{Ue(n)}return t}function us(e){var t=sr(e);if(e.equals(t)||(e.v=t,e.wv=Is()),!yt)if(vt!==null)vt.set(e,e.v);else{var n=(Fe||(e.f&ve)!==0)&&e.deps!==null?Oe:ne;ue(e,n)}}function Xa(e,t,n){const i=wt()?ir:as;if(t.length===0){n(e.map(i));return}var r=U,s=q,l=Ja(),o=Qa();Promise.all(t.map(u=>Va(u))).then(u=>{r?.activate(),l();try{n([...e.map(i),...u])}catch(c){(s.f&kt)===0&&nr(c,s)}r?.deactivate(),cs()}).catch(u=>{o.error(u)})}function Ja(){var e=q,t=j,n=Q;return function(){Ue(e),Ae(t),sn(n)}}function cs(){Ue(null),Ae(null),sn(null)}const $t=new Set;let U=null,Kt=null,vt=null,zi=new Set,ln=[];function fs(){const e=ln.shift();ln.length>0&&queueMicrotask(fs),e()}let et=[],_n=null,Bn=!1,en=!1;class mt{current=new Map;#i=new Map;#s=new Set;#e=0;#u=null;#c=!1;#n=[];#l=[];#r=[];#t=[];#a=[];#f=[];#p=[];skipped_effects=new Set;process(t){et=[],Kt=null;var n=null;if($t.size>1){n=new Map,vt=new Map;for(const[s,l]of this.current)n.set(s,{v:s.v,wv:s.wv}),s.v=l;for(const s of $t)if(s!==this)for(const[l,o]of s.#i)n.has(l)||(n.set(l,{v:l.v,wv:l.wv}),l.v=o)}for(const s of t)this.#d(s);if(this.#n.length===0&&this.#e===0){this.#h();var i=this.#r,r=this.#t;this.#r=[],this.#t=[],this.#a=[],Kt=U,U=null,Ti(i),Ti(r),U===null?U=this:$t.delete(this),this.#u?.resolve()}else this.#o(this.#r),this.#o(this.#t),this.#o(this.#a);if(n){for(const[s,{v:l,wv:o}]of n)s.wv<=o&&(s.v=l);vt=null}for(const s of this.#n)gt(s);for(const s of this.#l)gt(s);this.#n=[],this.#l=[]}#d(t){t.f^=ne;for(var n=t.first;n!==null;){var i=n.f,r=(i&(qe|rt))!==0,s=r&&(i&ne)!==0,l=s||(i&ke)!==0||this.skipped_effects.has(n);if(!l&&n.fn!==null){if(r)n.f^=ne;else if((i&ne)===0)if((i&Vn)!==0)this.#t.push(n);else if((i&er)!==0){var o=n.b?.pending?this.#l:this.#n;o.push(n)}else Ht(n)&&((n.f&Bt)!==0&&this.#a.push(n),gt(n));var u=n.first;if(u!==null){n=u;continue}}var c=n.parent;for(n=n.next;n===null&&c!==null;)n=c.next,c=c.parent}}#o(t){for(const n of t)((n.f&me)!==0?this.#f:this.#p).push(n),ue(n,ne);t.length=0}capture(t,n){this.#i.has(t)||this.#i.set(t,n),this.current.set(t,t.v)}activate(){U=this}deactivate(){U=null,Kt=null;for(const t of zi)if(zi.delete(t),t(),U!==null)break}neuter(){this.#c=!0}flush(){et.length>0?ps():this.#h(),U===this&&(this.#e===0&&$t.delete(this),this.deactivate())}#h(){if(!this.#c)for(const t of this.#s)t();this.#s.clear()}increment(){this.#e+=1}decrement(){if(this.#e-=1,this.#e===0){for(const t of this.#f)ue(t,me),tt(t);for(const t of this.#p)ue(t,Oe),tt(t);this.#r=[],this.#t=[],this.flush()}else this.deactivate()}add_callback(t){this.#s.add(t)}settled(){return(this.#u??=Sa()).promise}static ensure(){if(U===null){const t=U=new mt;$t.add(U),en||mt.enqueue(()=>{U===t&&t.flush()})}return U}static enqueue(t){ln.length===0&&queueMicrotask(fs),ln.unshift(t)}}function Ka(e){var t=en;en=!0;try{for(var n;;){if(Wa(),et.length===0&&(U?.flush(),et.length===0))return _n=null,n;ps()}}finally{en=t}}function ps(){var e=dt;Bn=!0;try{var t=0;for(Pi(!0);et.length>0;){var n=mt.ensure();if(t++>1e3){var i,r;eo()}n.process(et),Je.clear()}}finally{Bn=!1,Pi(e),_n=null}}function eo(){try{Ia()}catch(e){nr(e,_n)}}function Ti(e){var t=e.length;if(t!==0){for(var n=0;n<t;){var i=e[n++];if((i.f&(kt|ke))===0&&Ht(i)){var r=U?U.current.size:0;if(gt(i),i.deps===null&&i.first===null&&i.nodes_start===null&&(i.teardown===null&&i.ac===null?As(i):i.fn=null),U!==null&&U.current.size>r&&(i.f&Kn)!==0)break}}for(;n<t;)tt(e[n++])}}function tt(e){for(var t=_n=e;t.parent!==null;){t=t.parent;var n=t.f;if(Bn&&t===q&&(n&Bt)!==0)return;if((n&(rt|qe))!==0){if((n&ne)===0)return;t.f^=ne}}et.push(t)}const Je=new Map;function qt(e,t){var n={f:0,v:e,reactions:null,equals:ts,rv:0,wv:0};return n}function je(e,t){const n=qt(e);return po(n),n}function M(e,t=!1,n=!0){const i=qt(e);return t||(i.equals=ns),Ft&&n&&Q!==null&&Q.l!==null&&(Q.l.s??=[]).push(i),i}function Yt(e,t){return x(e,O(()=>a(e))),t}function x(e,t,n=!1){j!==null&&(!Ee||(j.f&Ai)!==0)&&wt()&&(j.f&(he|Bt|er|Ai))!==0&&!Ne?.includes(e)&&La();let i=n?It(t):t;return bt(e,i)}function bt(e,t){if(!e.equals(t)){var n=e.v;yt?Je.set(e,t):Je.set(e,n),e.v=t;var i=mt.ensure();i.capture(e,n),(e.f&he)!==0&&((e.f&me)!==0&&sr(e),ue(e,(e.f&ve)===0?ne:Oe)),e.wv=Is(),hs(e,me),wt()&&q!==null&&(q.f&ne)!==0&&(q.f&(qe|rt))===0&&(_e===null?ho([e]):_e.push(e))}return t}function Ln(e){x(e,e.v+1)}function hs(e,t){var n=e.reactions;if(n!==null)for(var i=wt(),r=n.length,s=0;s<r;s++){var l=n[s],o=l.f;if(!(!i&&l===q)){var u=(o&me)===0;u&&ue(l,t),(o&he)!==0?hs(l,Oe):u&&tt(l)}}}function It(e){if(typeof e!="object"||e===null||He in e)return e;const t=Xi(e);if(t!==wa&&t!==xa)return e;var n=new Map,i=pn(e),r=je(0),s=Ke,l=o=>{if(Ke===s)return o();var u=j,c=Ke;Ae(null),Ni(s);var f=o();return Ae(u),Ni(c),f};return i&&n.set("length",je(e.length)),new Proxy(e,{defineProperty(o,u,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&Ca();var f=n.get(u);return f===void 0?f=l(()=>{var h=je(c.value);return n.set(u,h),h}):x(f,c.value,!0),!0},deleteProperty(o,u){var c=n.get(u);if(c===void 0){if(u in o){const f=l(()=>je(te));n.set(u,f),Ln(r)}}else x(c,te),Ln(r);return!0},get(o,u,c){if(u===He)return e;var f=n.get(u),h=u in o;if(f===void 0&&(!h||Pt(o,u)?.writable)&&(f=l(()=>{var v=It(h?o[u]:te),p=je(v);return p}),n.set(u,f)),f!==void 0){var g=a(f);return g===te?void 0:g}return Reflect.get(o,u,c)},getOwnPropertyDescriptor(o,u){var c=Reflect.getOwnPropertyDescriptor(o,u);if(c&&"value"in c){var f=n.get(u);f&&(c.value=a(f))}else if(c===void 0){var h=n.get(u),g=h?.v;if(h!==void 0&&g!==te)return{enumerable:!0,configurable:!0,value:g,writable:!0}}return c},has(o,u){if(u===He)return!0;var c=n.get(u),f=c!==void 0&&c.v!==te||Reflect.has(o,u);if(c!==void 0||q!==null&&(!f||Pt(o,u)?.writable)){c===void 0&&(c=l(()=>{var g=f?It(o[u]):te,v=je(g);return v}),n.set(u,c));var h=a(c);if(h===te)return!1}return f},set(o,u,c,f){var h=n.get(u),g=u in o;if(i&&u==="length")for(var v=c;v<h.v;v+=1){var p=n.get(v+"");p!==void 0?x(p,te):v in o&&(p=l(()=>je(te)),n.set(v+"",p))}if(h===void 0)(!g||Pt(o,u)?.writable)&&(h=l(()=>je(void 0)),x(h,It(c)),n.set(u,h));else{g=h.v!==te;var _=l(()=>It(c));x(h,_)}var b=Reflect.getOwnPropertyDescriptor(o,u);if(b?.set&&b.set.call(f,c),!g){if(i&&typeof u=="string"){var S=n.get("length"),E=Number(u);Number.isInteger(E)&&E>=S.v&&x(S,E+1)}Ln(r)}return!0},ownKeys(o){a(r);var u=Reflect.ownKeys(o).filter(h=>{var g=n.get(h);return g===void 0||g.v!==te});for(var[c,f]of n)f.v!==te&&!(c in o)&&u.push(c);return u},setPrototypeOf(){Pa()}})}function Ri(e){try{if(e!==null&&typeof e=="object"&&He in e)return e[He]}catch{}return e}function to(e,t){return Object.is(Ri(e),Ri(t))}var Ii,ds,gs,_s;function no(){if(Ii===void 0){Ii=window,ds=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;gs=Pt(t,"firstChild").get,_s=Pt(t,"nextSibling").get,Ei(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),Ei(n)&&(n.__t=void 0)}}function xt(e=""){return document.createTextNode(e)}function Be(e){return gs.call(e)}function vn(e){return _s.call(e)}function y(e,t){return Be(e)}function Xt(e,t){{var n=Be(e);return n instanceof Comment&&n.data===""?vn(n):n}}function k(e,t=1,n=!1){let i=e;for(;t--;)i=vn(i);return i}function ro(e){e.textContent=""}function vs(){return!1}let Ci=!1;function io(){Ci||(Ci=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function mn(e){var t=j,n=q;Ae(null),Ue(null);try{return e()}finally{Ae(t),Ue(n)}}function ms(e,t,n,i=n){e.addEventListener(t,()=>mn(n));const r=e.__on_r;r?e.__on_r=()=>{r(),i(!0)}:e.__on_r=()=>i(!0),io()}function bs(e){q===null&&j===null&&Ra(),j!==null&&(j.f&ve)!==0&&q===null&&Ta(),yt&&za()}function so(e,t){var n=t.last;n===null?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}function Te(e,t,n,i=!0){var r=q;r!==null&&(r.f&ke)!==0&&(e|=ke);var s={ctx:Q,deps:null,nodes_start:null,nodes_end:null,f:e|me,first:null,fn:t,last:null,next:null,parent:r,b:r&&r.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(n)try{gt(s),s.f|=Yn}catch(u){throw Me(s),u}else t!==null&&tt(s);var l=n&&s.deps===null&&s.first===null&&s.nodes_start===null&&s.teardown===null&&(s.f&Jn)===0;if(!l&&i&&(r!==null&&so(s,r),j!==null&&(j.f&he)!==0&&(e&rt)===0)){var o=j;(o.effects??=[]).push(s)}return s}function ks(e){const t=Te(hn,null,!1);return ue(t,ne),t.teardown=e,t}function Fn(e){bs();var t=q.f,n=!j&&(t&qe)!==0&&(t&Yn)===0;if(n){var i=Q;(i.e??=[]).push(e)}else return ws(e)}function ws(e){return Te(Vn|Kn,e,!1)}function lo(e){return bs(),Te(hn|Kn,e,!0)}function ao(e){mt.ensure();const t=Te(rt,e,!0);return(n={})=>new Promise(i=>{n.outro?lr(t,()=>{Me(t),i(void 0)}):(Me(t),i(void 0))})}function xs(e){return Te(Vn,e,!1)}function H(e,t){var n=Q,i={effect:null,ran:!1,deps:e};n.l.$.push(i),i.effect=bn(()=>{e(),!i.ran&&(i.ran=!0,O(t))})}function oo(){var e=Q;bn(()=>{for(var t of e.l.$){t.deps();var n=t.effect;(n.f&ne)!==0&&ue(n,Oe),Ht(n)&&gt(n),t.ran=!1}})}function uo(e){return Te(er|Jn,e,!0)}function bn(e,t=0){return Te(hn|t,e,!0)}function ee(e,t=[],n=[]){Xa(t,n,i=>{Te(hn,()=>e(...i.map(a)),!0)})}function ys(e,t=0){var n=Te(Bt|t,e,!0);return n}function Ot(e,t=!0){return Te(qe,e,!0,t)}function Ss(e){var t=e.teardown;if(t!==null){const n=yt,i=j;Li(!0),Ae(null);try{t.call(null)}finally{Li(n),Ae(i)}}}function $s(e,t=!1){var n=e.first;for(e.first=e.last=null;n!==null;){const r=n.ac;r!==null&&mn(()=>{r.abort(tr)});var i=n.next;(n.f&rt)!==0?n.parent=null:Me(n,t),n=i}}function co(e){for(var t=e.first;t!==null;){var n=t.next;(t.f&qe)===0&&Me(t),t=n}}function Me(e,t=!0){var n=!1;(t||(e.f&$a)!==0)&&e.nodes_start!==null&&e.nodes_end!==null&&(Es(e.nodes_start,e.nodes_end),n=!0),$s(e,t&&!n),an(e,0),ue(e,kt);var i=e.transitions;if(i!==null)for(const s of i)s.stop();Ss(e);var r=e.parent;r!==null&&r.first!==null&&As(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=e.ac=null}function Es(e,t){for(;e!==null;){var n=e===t?null:vn(e);e.remove(),e=n}}function As(e){var t=e.parent,n=e.prev,i=e.next;n!==null&&(n.next=i),i!==null&&(i.prev=n),t!==null&&(t.first===e&&(t.first=i),t.last===e&&(t.last=n))}function lr(e,t){var n=[];ar(e,n,!0),zs(n,()=>{Me(e),t&&t()})}function zs(e,t){var n=e.length;if(n>0){var i=()=>--n||t();for(var r of e)r.out(i)}else t()}function ar(e,t,n){if((e.f&ke)===0){if(e.f^=ke,e.transitions!==null)for(const l of e.transitions)(l.is_global||n)&&t.push(l);for(var i=e.first;i!==null;){var r=i.next,s=(i.f&Xn)!==0||(i.f&qe)!==0;ar(i,t,s?n:!1),i=r}}}function or(e){Ts(e,!0)}function Ts(e,t){if((e.f&ke)!==0){e.f^=ke,(e.f&ne)===0&&(ue(e,me),tt(e));for(var n=e.first;n!==null;){var i=n.next,r=(n.f&Xn)!==0||(n.f&qe)!==0;Ts(n,r?t:!1),n=i}if(e.transitions!==null)for(const s of e.transitions)(s.is_global||t)&&s.in()}}let ht=null;function fo(e){var t=ht;try{if(ht=new Set,O(e),t!==null)for(var n of ht)t.add(n);return ht}finally{ht=t}}function at(e){for(var t of fo(e))bt(t,t.v)}let dt=!1;function Pi(e){dt=e}let yt=!1;function Li(e){yt=e}let j=null,Ee=!1;function Ae(e){j=e}let q=null;function Ue(e){q=e}let Ne=null;function po(e){j!==null&&(Ne===null?Ne=[e]:Ne.push(e))}let ae=null,pe=0,_e=null;function ho(e){_e=e}let Rs=1,jt=0,Ke=jt;function Ni(e){Ke=e}let Fe=!1;function Is(){return++Rs}function Ht(e){var t=e.f;if((t&me)!==0)return!0;if((t&Oe)!==0){var n=e.deps,i=(t&ve)!==0;if(n!==null){var r,s,l=(t&rn)!==0,o=i&&q!==null&&!Fe,u=n.length;if((l||o)&&(q===null||(q.f&kt)===0)){var c=e,f=c.parent;for(r=0;r<u;r++)s=n[r],(l||!s?.reactions?.includes(c))&&(s.reactions??=[]).push(c);l&&(c.f^=rn),o&&f!==null&&(f.f&ve)===0&&(c.f^=ve)}for(r=0;r<u;r++)if(s=n[r],Ht(s)&&us(s),s.wv>e.wv)return!0}(!i||q!==null&&!Fe)&&ue(e,ne)}return!1}function Cs(e,t,n=!0){var i=e.reactions;if(i!==null&&!Ne?.includes(e))for(var r=0;r<i.length;r++){var s=i[r];(s.f&he)!==0?Cs(s,t,!1):t===s&&(n?ue(s,me):(s.f&ne)!==0&&ue(s,Oe),tt(s))}}function Ps(e){var t=ae,n=pe,i=_e,r=j,s=Fe,l=Ne,o=Q,u=Ee,c=Ke,f=e.f;ae=null,pe=0,_e=null,Fe=(f&ve)!==0&&(Ee||!dt||j===null),j=(f&(qe|rt))===0?e:null,Ne=null,sn(e.ctx),Ee=!1,Ke=++jt,e.ac!==null&&(mn(()=>{e.ac.abort(tr)}),e.ac=null);try{e.f|=jn;var h=e.fn,g=h(),v=e.deps;if(ae!==null){var p;if(an(e,pe),v!==null&&pe>0)for(v.length=pe+ae.length,p=0;p<ae.length;p++)v[pe+p]=ae[p];else e.deps=v=ae;if(!Fe||(f&he)!==0&&e.reactions!==null)for(p=pe;p<v.length;p++)(v[p].reactions??=[]).push(e)}else v!==null&&pe<v.length&&(an(e,pe),v.length=pe);if(wt()&&_e!==null&&!Ee&&v!==null&&(e.f&(he|Oe|me))===0)for(p=0;p<_e.length;p++)Cs(_e[p],e);return r!==null&&r!==e&&(jt++,_e!==null&&(i===null?i=_e:i.push(..._e))),(e.f&Xe)!==0&&(e.f^=Xe),g}catch(_){return Za(_)}finally{e.f^=jn,ae=t,pe=n,_e=i,j=r,Fe=s,Ne=l,sn(o),Ee=u,Ke=c}}function go(e,t){let n=t.reactions;if(n!==null){var i=ba.call(n,e);if(i!==-1){var r=n.length-1;r===0?n=t.reactions=null:(n[i]=n[r],n.pop())}}n===null&&(t.f&he)!==0&&(ae===null||!ae.includes(t))&&(ue(t,Oe),(t.f&(ve|rn))===0&&(t.f^=rn),os(t),an(t,0))}function an(e,t){var n=e.deps;if(n!==null)for(var i=t;i<n.length;i++)go(e,n[i])}function gt(e){var t=e.f;if((t&kt)===0){ue(e,ne);var n=q,i=dt;q=e,dt=!0;try{(t&Bt)!==0?co(e):$s(e),Ss(e);var r=Ps(e);e.teardown=typeof r=="function"?r:null,e.wv=Rs;var s;Yi&&Fa&&(e.f&me)!==0&&e.deps}finally{dt=i,q=n}}}async function Ye(){await Promise.resolve(),Ka()}function a(e){var t=e.f,n=(t&he)!==0;if(ht?.add(e),j!==null&&!Ee){var i=q!==null&&(q.f&kt)!==0;if(!i&&!Ne?.includes(e)){var r=j.deps;if((j.f&jn)!==0)e.rv<jt&&(e.rv=jt,ae===null&&r!==null&&r[pe]===e?pe++:ae===null?ae=[e]:(!Fe||!ae.includes(e))&&ae.push(e));else{(j.deps??=[]).push(e);var s=e.reactions;s===null?e.reactions=[j]:s.includes(j)||s.push(j)}}}else if(n&&e.deps===null&&e.effects===null){var l=e,o=l.parent;o!==null&&(o.f&ve)===0&&(l.f^=ve)}if(yt){if(Je.has(e))return Je.get(e);if(n){l=e;var u=l.v;return((l.f&ne)===0&&l.reactions!==null||Ls(l))&&(u=sr(l)),Je.set(l,u),u}}else if(n){if(l=e,vt?.has(l))return vt.get(l);Ht(l)&&us(l)}if((e.f&Xe)!==0)throw e.v;return e.v}function Ls(e){if(e.v===te)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(Je.has(t)||(t.f&he)!==0&&Ls(t))return!0;return!1}function O(e){var t=Ee;try{return Ee=!0,e()}finally{Ee=t}}const _o=-7169;function ue(e,t){e.f=e.f&_o|t}function Ns(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(He in e)Hn(e);else if(!Array.isArray(e))for(let t in e){const n=e[t];typeof n=="object"&&n&&He in n&&Hn(n)}}}function Hn(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let i in e)try{Hn(e[i],t)}catch{}const n=Xi(e);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const i=ka(n);for(let r in i){const s=i[r].get;if(s)try{s.call(e)}catch{}}}}}const vo=["touchstart","touchmove"];function mo(e){return vo.includes(e)}const bo=new Set,Mi=new Set;function ko(e,t,n,i={}){function r(s){if(i.capture||Ct.call(t,s),!s.cancelBubble)return mn(()=>n?.call(this,s))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?rr(()=>{t.addEventListener(e,r,i)}):t.addEventListener(e,r,i),r}function W(e,t,n,i,r){var s={capture:i,passive:r},l=ko(e,t,n,s);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&ks(()=>{t.removeEventListener(e,l,s)})}let qi=null;function Ct(e){var t=this,n=t.ownerDocument,i=e.type,r=e.composedPath?.()||[],s=r[0]||e.target;qi=e;var l=0,o=qi===e&&e.__root;if(o){var u=r.indexOf(o);if(u!==-1&&(t===document||t===window)){e.__root=t;return}var c=r.indexOf(t);if(c===-1)return;u<=c&&(l=u)}if(s=r[l]||e.target,s!==t){On(e,"currentTarget",{configurable:!0,get(){return s||n}});var f=j,h=q;Ae(null),Ue(null);try{for(var g,v=[];s!==null;){var p=s.assignedSlot||s.parentNode||s.host||null;try{var _=s["__"+i];if(_!=null&&(!s.disabled||e.target===s))if(pn(_)){var[b,...S]=_;b.apply(s,[e,...S])}else _.call(s,e)}catch(E){g?v.push(E):g=E}if(e.cancelBubble||p===t||p===null)break;s=p}if(g){for(let E of v)queueMicrotask(()=>{throw E});throw g}}finally{e.__root=t,delete e.currentTarget,Ae(f),Ue(h)}}}function Ms(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function Dt(e,t){var n=q;n.nodes_start===null&&(n.nodes_start=e,n.nodes_end=t)}function it(e,t){var n=(t&qa)!==0,i=(t&Oa)!==0,r,s=!e.startsWith("<!>");return()=>{r===void 0&&(r=Ms(s?e:"<!>"+e),n||(r=Be(r)));var l=i||ds?document.importNode(r,!0):r.cloneNode(!0);if(n){var o=Be(l),u=l.lastChild;Dt(o,u)}else Dt(l,l);return l}}function ot(e=""){{var t=xt(e+"");return Dt(t,t),t}}function Oi(){var e=document.createDocumentFragment(),t=document.createComment(""),n=xt();return e.append(t,n),Dt(t,n),e}function le(e,t){e!==null&&e.before(t)}function ce(e,t){var n=t==null?"":typeof t=="object"?t+"":t;n!==(e.__t??=e.nodeValue)&&(e.__t=n,e.nodeValue=n+"")}function wo(e,t){return xo(e,t)}const ut=new Map;function xo(e,{target:t,anchor:n,props:i={},events:r,context:s,intro:l=!0}){no();var o=new Set,u=h=>{for(var g=0;g<h.length;g++){var v=h[g];if(!o.has(v)){o.add(v);var p=mo(v);t.addEventListener(v,Ct,{passive:p});var _=ut.get(v);_===void 0?(document.addEventListener(v,Ct,{passive:p}),ut.set(v,1)):ut.set(v,_+1)}}};u(Qn(bo)),Mi.add(u);var c=void 0,f=ao(()=>{var h=n??t.appendChild(xt());return Ot(()=>{if(s){rs({});var g=Q;g.c=s}r&&(i.$$events=r),c=e(h,i)||{},s&&is()}),()=>{for(var g of o){t.removeEventListener(g,Ct);var v=ut.get(g);--v===0?(document.removeEventListener(g,Ct),ut.delete(g)):ut.set(g,v)}Mi.delete(u),h!==n&&h.parentNode?.removeChild(h)}});return yo.set(c,f),c}let yo=new WeakMap;function De(e,t,n=!1){var i=e,r=null,s=null,l=te,o=n?Xn:0,u=!1;const c=(v,p=!0)=>{u=!0,g(p,v)};var f=null;function h(){f!==null&&(f.lastChild.remove(),i.before(f),f=null);var v=l?r:s,p=l?s:r;v&&or(v),p&&lr(p,()=>{l?s=null:r=null})}const g=(v,p)=>{if(l!==(l=v)){var _=vs(),b=i;if(_&&(f=document.createDocumentFragment(),f.append(b=xt())),l?r??=p&&Ot(()=>p(b)):s??=p&&Ot(()=>p(b)),_){var S=U,E=l?r:s,T=l?s:r;E&&S.skipped_effects.delete(E),T&&S.skipped_effects.add(T),S.add_callback(h)}else h()}};ys(()=>{u=!1,t(c),u||g(null,null)},o)}function Et(e,t){return t}function So(e,t,n){for(var i=e.items,r=[],s=t.length,l=0;l<s;l++)ar(t[l].e,r,!0);var o=s>0&&r.length===0&&n!==null;if(o){var u=n.parentNode;ro(u),u.append(n),i.clear(),$e(e,t[0].prev,t[s-1].next)}zs(r,()=>{for(var c=0;c<s;c++){var f=t[c];o||(i.delete(f.k),$e(e,f.prev,f.next)),Me(f.e,!o)}})}function At(e,t,n,i,r,s=null){var l=e,o={flags:t,items:new Map,first:null},u=(t&es)!==0;if(u){var c=e;l=c.appendChild(xt())}var f=null,h=!1,g=new Map,v=as(()=>{var S=n();return pn(S)?S:S==null?[]:Qn(S)}),p,_;function b(){$o(_,p,o,g,l,r,t,i,n),s!==null&&(p.length===0?f?or(f):f=Ot(()=>s(l)):f!==null&&lr(f,()=>{f=null}))}ys(()=>{_??=q,p=a(v);var S=p.length;if(!(h&&S===0)){h=S===0;var E,T,B,L;if(vs()){var $=new Set,A=U;for(T=0;T<S;T+=1){B=p[T],L=i(B,T);var P=o.items.get(L)??g.get(L);P?(t&(dn|gn))!==0&&qs(P,B,T,t):(E=Os(null,o,null,null,B,L,T,r,t,n,!0),g.set(L,E)),$.add(L)}for(const[N,X]of o.items)$.has(N)||A.skipped_effects.add(X.e);A.add_callback(b)}else b();a(v)}})}function $o(e,t,n,i,r,s,l,o,u){var c=(l&Na)!==0,f=(l&(dn|gn))!==0,h=t.length,g=n.items,v=n.first,p=v,_,b=null,S,E=[],T=[],B,L,$,A;if(c)for(A=0;A<h;A+=1)B=t[A],L=o(B,A),$=g.get(L),$!==void 0&&($.a?.measure(),(S??=new Set).add($));for(A=0;A<h;A+=1){if(B=t[A],L=o(B,A),$=g.get(L),$===void 0){var P=i.get(L);if(P!==void 0){i.delete(L),g.set(L,P);var N=b?b.next:p;$e(n,b,P),$e(n,P,N),Nn(P,N,r),b=P}else{var X=p?p.e.nodes_start:r;b=Os(X,n,b,b===null?n.first:b.next,B,L,A,s,l,u)}g.set(L,b),E=[],T=[],p=b.next;continue}if(f&&qs($,B,A,l),($.e.f&ke)!==0&&(or($.e),c&&($.a?.unfix(),(S??=new Set).delete($))),$!==p){if(_!==void 0&&_.has($)){if(E.length<T.length){var re=T[0],I;b=re.prev;var Re=E[0],fe=E[E.length-1];for(I=0;I<E.length;I+=1)Nn(E[I],re,r);for(I=0;I<T.length;I+=1)_.delete(T[I]);$e(n,Re.prev,fe.next),$e(n,b,Re),$e(n,fe,re),p=re,b=fe,A-=1,E=[],T=[]}else _.delete($),Nn($,p,r),$e(n,$.prev,$.next),$e(n,$,b===null?n.first:b.next),$e(n,b,$),b=$;continue}for(E=[],T=[];p!==null&&p.k!==L;)(p.e.f&ke)===0&&(_??=new Set).add(p),T.push(p),p=p.next;if(p===null)continue;$=p}E.push($),b=$,p=$.next}if(p!==null||_!==void 0){for(var be=_===void 0?[]:Qn(_);p!==null;)(p.e.f&ke)===0&&be.push(p),p=p.next;var de=be.length;if(de>0){var Ge=(l&es)!==0&&h===0?r:null;if(c){for(A=0;A<de;A+=1)be[A].a?.measure();for(A=0;A<de;A+=1)be[A].a?.fix()}So(n,be,Ge)}}c&&rr(()=>{if(S!==void 0)for($ of S)$.a?.apply()}),e.first=n.first&&n.first.e,e.last=b&&b.e;for(var V of i.values())Me(V.e);i.clear()}function qs(e,t,n,i){(i&dn)!==0&&bt(e.v,t),(i&gn)!==0?bt(e.i,n):e.i=n}function Os(e,t,n,i,r,s,l,o,u,c,f){var h=(u&dn)!==0,g=(u&Ma)===0,v=h?g?M(r,!1,!1):qt(r):r,p=(u&gn)===0?l:qt(l),_={i:p,v,k:s,a:null,e:null,prev:n,next:i};try{if(e===null){var b=document.createDocumentFragment();b.append(e=xt())}return _.e=Ot(()=>o(e,v,p,c),Da),_.e.prev=n&&n.e,_.e.next=i&&i.e,n===null?f||(t.first=_):(n.next=_,n.e.next=_.e),i!==null&&(i.prev=_,i.e.prev=_.e),_}finally{}}function Nn(e,t,n){for(var i=e.next?e.next.e.nodes_start:n,r=t?t.e.nodes_start:n,s=e.e.nodes_start;s!==null&&s!==i;){var l=vn(s);r.before(s),s=l}}function $e(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}function zt(e,t,n=!1,i=!1,r=!1){var s=e,l="";ee(()=>{var o=q;if(l!==(l=t()??"")&&(o.nodes_start!==null&&(Es(o.nodes_start,o.nodes_end),o.nodes_start=o.nodes_end=null),l!=="")){var u=l+"";n?u=`<svg>${u}</svg>`:i&&(u=`<math>${u}</math>`);var c=Ms(u);if((n||i)&&(c=Be(c)),Dt(Be(c),c.lastChild),n||i)for(;Be(c);)s.before(Be(c));else s.before(c)}})}const ji=[...` 	
\r\f \v\uFEFF`];function Eo(e,t,n){var i=e==null?"":""+e;if(t&&(i=i?i+" "+t:t),n){for(var r in n)if(n[r])i=i?i+" "+r:r;else if(i.length)for(var s=r.length,l=0;(l=i.indexOf(r,l))>=0;){var o=l+s;(l===0||ji.includes(i[l-1]))&&(o===i.length||ji.includes(i[o]))?i=(l===0?"":i.substring(0,l))+i.substring(o+1):l=o}}return i===""?null:i}function Ao(e,t){return e==null?null:String(e)}function ct(e,t,n,i,r,s){var l=e.__className;if(l!==n||l===void 0){var o=Eo(n,i,s);o==null?e.removeAttribute("class"):e.className=o,e.__className=n}else if(s&&r!==s)for(var u in s){var c=!!s[u];(r==null||c!==!!r[u])&&e.classList.toggle(u,c)}return s}function Ve(e,t,n,i){var r=e.__style;if(r!==t){var s=Ao(t);s==null?e.removeAttribute("style"):e.style.cssText=s,e.__style=t}return i}function js(e,t,n=!1){if(e.multiple){if(t==null)return;if(!pn(t))return ja();for(var i of e.options)i.selected=t.includes(Lt(i));return}for(i of e.options){var r=Lt(i);if(to(r,t)){i.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function zo(e){var t=new MutationObserver(()=>{js(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),ks(()=>{t.disconnect()})}function ft(e,t,n=t){var i=!0;ms(e,"change",r=>{var s=r?"[selected]":":checked",l;if(e.multiple)l=[].map.call(e.querySelectorAll(s),Lt);else{var o=e.querySelector(s)??e.querySelector("option:not([disabled])");l=o&&Lt(o)}n(l)}),xs(()=>{var r=t();if(js(e,r,i),i&&r===void 0){var s=e.querySelector(":checked");s!==null&&(r=Lt(s),n(r))}e.__value=r,i=!1}),zo(e)}function Lt(e){return"__value"in e?e.__value:e.value}function ge(e,t,n=t){var i=wt(),r=new WeakSet;ms(e,"input",s=>{var l=s?e.defaultValue:e.value;if(l=Mn(e)?qn(l):l,n(l),U!==null&&r.add(U),i&&l!==(l=t())){var o=e.selectionStart,u=e.selectionEnd;e.value=l??"",u!==null&&(e.selectionStart=o,e.selectionEnd=Math.min(u,e.value.length))}}),O(t)==null&&e.value&&(n(Mn(e)?qn(e.value):e.value),U!==null&&r.add(U)),bn(()=>{var s=t();if(e===document.activeElement){var l=Kt??U;if(r.has(l))return}Mn(e)&&s===qn(e.value)||e.type==="date"&&!s&&!e.value||s!==e.value&&(e.value=s??"")})}function Mn(e){var t=e.type;return t==="number"||t==="range"}function qn(e){return e===""?null:+e}function Di(e,t){return e===t||e?.[He]===t}function Bi(e={},t,n,i){return xs(()=>{var r,s;return bn(()=>{r=s,s=[],O(()=>{e!==n(...s)&&(t(e,...s),r&&Di(n(...r),e)&&t(null,...r))})}),()=>{rr(()=>{s&&Di(n(...s),e)&&t(null,...s)})}}),e}function To(e){return function(...t){var n=t[0];return n.preventDefault(),e?.apply(this,t)}}function Ro(e=!1){const t=Q,n=t.l.u;if(!n)return;let i=()=>Ns(t.s);if(e){let r=0,s={};const l=ir(()=>{let o=!1;const u=t.s;for(const c in u)u[c]!==s[c]&&(s[c]=u[c],o=!0);return o&&r++,r});i=()=>a(l)}n.b.length&&lo(()=>{Fi(t,i),nn(n.b)}),Fn(()=>{const r=O(()=>n.m.map(ya));return()=>{for(const s of r)typeof s=="function"&&s()}}),n.a.length&&Fn(()=>{Fi(t,i),nn(n.a)})}function Fi(e,t){if(e.l.s)for(const n of e.l.s)a(n);t()}function Ds(e){Q===null&&Ki(),Ft&&Q.l!==null?Co(Q).m.push(e):Fn(()=>{const t=O(e);if(typeof t=="function")return t})}function Io(e){Q===null&&Ki(),Ds(()=>()=>O(e))}function Co(e){var t=e.l;return t.u??={a:[],b:[],m:[]}}const Po="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Po);Ha();const Lo="zine",No=2,ze="images",Ze="images_meta";function st(){return new Promise((e,t)=>{const n=indexedDB.open(Lo,No);n.onupgradeneeded=()=>{const i=n.result;i.objectStoreNames.contains(ze)||i.createObjectStore(ze),i.objectStoreNames.contains(Ze)||i.createObjectStore(Ze)},n.onsuccess=()=>e(n.result),n.onerror=()=>t(n.error)})}async function Bs(e){const t=await st();return new Promise((n,i)=>{const l=t.transaction(ze,"readonly").objectStore(ze).get(e);l.onsuccess=()=>n(l.result),l.onerror=()=>i(l.error)})}async function Fs(e,t){const n=await st();return new Promise((i,r)=>{const o=n.transaction(ze,"readwrite").objectStore(ze).put(t,e);o.onsuccess=()=>i(!0),o.onerror=()=>r(o.error)})}async function Hs(e){const t=await st();return new Promise((n,i)=>{const l=t.transaction(ze,"readwrite").objectStore(ze).delete(e);l.onsuccess=()=>n(!0),l.onerror=()=>i(l.error)})}async function Us(){const e=await st();return new Promise((t,n)=>{const r=e.transaction(ze,"readonly").objectStore(ze),s=[],l=r.openCursor();l.onsuccess=()=>{const o=l.result;o?(s.push(o.key),o.continue()):t(s)},l.onerror=()=>n(l.error)})}async function Zs(e){const t=await st();return new Promise((n,i)=>{const l=t.transaction(Ze,"readonly").objectStore(Ze).get(e);l.onsuccess=()=>n(l.result||null),l.onerror=()=>i(l.error)})}async function ur(e,t){const n=await st();return new Promise((i,r)=>{const o=n.transaction(Ze,"readwrite").objectStore(Ze).put(t,e);o.onsuccess=()=>i(!0),o.onerror=()=>r(o.error)})}async function Gs(e){const t=await st();return new Promise((n,i)=>{const l=t.transaction(Ze,"readwrite").objectStore(Ze).delete(e);l.onsuccess=()=>n(!0),l.onerror=()=>i(l.error)})}async function Mo(){if(!navigator.storage?.estimate)return null;try{const{quota:e,usage:t}=await navigator.storage.estimate();return{quota:e,usage:t}}catch{return null}}async function qo(){if(navigator.storage?.persist)try{await navigator.storage.persist()}catch{}}const Oo=256,jo=16,Hi=12,Do=2,Ws=1600,Bo=.85;function Fo(){return`${Date.now()}-${crypto.randomUUID()}`}async function Qs(){const e=await Mo();return e?e.usage/1024/1024:0}async function Ho(e,t=Ws,n=Bo){const i=await createImageBitmap(e),r=Math.min(1,t/i.width),s=Math.round(i.width*r),l=Math.round(i.height*r);if(r>=1)return e;const o=document.createElement("canvas");o.width=s,o.height=l,o.getContext("2d").drawImage(i,0,0,s,l);const c=e.type==="image/png",f=c?"image/png":"image/jpeg",h=await new Promise(g=>o.toBlob(g,f,c?void 0:n));return new File([h],e.name.replace(/\.(\w+)$/,"")+(c?".png":".jpg"),{type:f})}async function Uo(e,t){let n=Ws,i=e;for(let r=0;r<6;r++){if(i.size/1024/1024<=t)return i;n=Math.max(640,Math.floor(n*.75)),i=await Ho(i,n)}return i}async function Zo(e){const t=await Us(),n=await Promise.all(t.map(async r=>{const s=await Zs(r);return{k:r,t:s?.last||0,s:s?.size||0}}));n.sort((r,s)=>r.t-s.t);let i=0;for(const r of n){if(i>=e*1024*1024)break;await Hs(r.k).catch(()=>{}),await Gs(r.k).catch(()=>{}),i+=r.s}}async function Go(e){await qo();let t=await Uo(e,Hi);if(t.size/1024/1024>Hi)throw new Error("file too large");const n=await Qs(),i=Oo-n,r=t.size/1024/1024+jo;i<r&&await Zo(r-i);const s=Fo();return await Fs(s,t),await ur(s,{size:t.size,last:Date.now()}),{key:s,file:t}}function Wo(e){const t=new Set,n=/!\[[^\]]*]\(appimg:\/\/([^)]+)\)/g,i=/<img[^>]+src=["']appimg:\/\/([^"']+)["'][^>]*>/g;let r;for(;r=n.exec(e);)t.add(r[1]);for(;r=i.exec(e);)t.add(r[1]);return t}async function Qo(e){const t=Wo(e),i=(await Us()).filter(r=>!t.has(r));await Promise.allSettled(i.map(async r=>{await Hs(r),await Gs(r)}))}const on=new Map;function Vo(){for(const e of on.values())URL.revokeObjectURL(e);on.clear()}async function Ui(e){if(!e.includes("appimg://"))return e;const t=document.createElement("div");t.innerHTML=e;const n=Array.from(t.querySelectorAll('img[src^="appimg://"]'));let i=0;const r=async()=>{for(;;){const l=i++;if(l>=n.length)break;const o=n[l],u=o.getAttribute("src").slice(9);try{const c=await Bs(u);if(c){let f=on.get(u);f||(f=URL.createObjectURL(c),on.set(u,f)),o.src=f;const h=await Zs(u);await ur(u,{...h||{},last:Date.now(),size:h?.size??c.size})}else o.setAttribute("alt",(o.getAttribute("alt")||"")+" (missing)")}catch{}}},s=Array.from({length:Math.min(Do,n.length)},r);return await Promise.all(s),t.innerHTML}function Yo(e=""){const t=new Set,n=/appimg:\/\/([A-Za-z0-9._\-:/]+)/g;let i;for(;i=n.exec(String(e));)t.add(i[1]);return Array.from(t)}function Xo(e){return new Promise((t,n)=>{const i=new FileReader;i.onload=()=>{const r=String(i.result||""),s=r.indexOf("base64,");t(s>=0?r.slice(s+7):r)},i.onerror=n,i.readAsDataURL(e)})}async function Jo(e){const t={},n=Yo(e);for(const i of n){const r=await Bs(i);if(!r)continue;const s=await Xo(r);t[i]={name:i,type:r.type||"image/*",base64:s}}return t}async function Ko(e={}){const t=Object.entries(e);for(const[n,i]of t){const r=i?.base64;if(!r)continue;const s=i?.type||"image/*",l=Uint8Array.from(atob(r),u=>u.charCodeAt(0)),o=new Blob([l],{type:s});await Fs(n,o),await ur(n,{size:o.size,last:Date.now()})}}const pt={A7:{id:"A7",label:"A7 (74×105mm)",w:74,h:105,margins:{top:5,right:5,bottom:5,left:5}},A6:{id:"A6",label:"A6 (105×148mm)",w:105,h:148,margins:{top:5,right:5,bottom:5,left:5}},A5:{id:"A5",label:"A5 (148×210mm)",w:148,h:210,margins:{top:5,right:5,bottom:5,left:5}},A4:{id:"A4",label:"A4 (210×297mm)",w:210,h:297,margins:{top:5,right:5,bottom:5,left:5}},Letter:{id:"Letter",label:"Letter (216×279mm)",w:216,h:279,margins:{top:5,right:5,bottom:5,left:5}}},Ce=96/25.4;function cr(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var lt=cr();function Vs(e){lt=e}var Nt={exec:()=>null};function D(e,t=""){let n=typeof e=="string"?e:e.source,i={replace:(r,s)=>{let l=typeof s=="string"?s:s.source;return l=l.replace(oe.caret,"$1"),n=n.replace(r,l),i},getRegex:()=>new RegExp(n,t)};return i}var oe={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},eu=/^(?:[ \t]*(?:\n|$))+/,tu=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,nu=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Ut=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,ru=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,fr=/(?:[*+-]|\d{1,9}[.)])/,Ys=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Xs=D(Ys).replace(/bull/g,fr).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),iu=D(Ys).replace(/bull/g,fr).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),pr=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,su=/^[^\n]+/,hr=/(?!\s*\])(?:\\.|[^\[\]\\])+/,lu=D(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",hr).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),au=D(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,fr).getRegex(),kn="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",dr=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,ou=D("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",dr).replace("tag",kn).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Js=D(pr).replace("hr",Ut).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",kn).getRegex(),uu=D(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Js).getRegex(),gr={blockquote:uu,code:tu,def:lu,fences:nu,heading:ru,hr:Ut,html:ou,lheading:Xs,list:au,newline:eu,paragraph:Js,table:Nt,text:su},Zi=D("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Ut).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",kn).getRegex(),cu={...gr,lheading:iu,table:Zi,paragraph:D(pr).replace("hr",Ut).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Zi).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",kn).getRegex()},fu={...gr,html:D(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",dr).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Nt,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:D(pr).replace("hr",Ut).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Xs).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},pu=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,hu=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Ks=/^( {2,}|\\)\n(?!\s*$)/,du=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,wn=/[\p{P}\p{S}]/u,_r=/[\s\p{P}\p{S}]/u,el=/[^\s\p{P}\p{S}]/u,gu=D(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,_r).getRegex(),tl=/(?!~)[\p{P}\p{S}]/u,_u=/(?!~)[\s\p{P}\p{S}]/u,vu=/(?:[^\s\p{P}\p{S}]|~)/u,mu=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<(?! )[^<>]*?>/g,nl=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,bu=D(nl,"u").replace(/punct/g,wn).getRegex(),ku=D(nl,"u").replace(/punct/g,tl).getRegex(),rl="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",wu=D(rl,"gu").replace(/notPunctSpace/g,el).replace(/punctSpace/g,_r).replace(/punct/g,wn).getRegex(),xu=D(rl,"gu").replace(/notPunctSpace/g,vu).replace(/punctSpace/g,_u).replace(/punct/g,tl).getRegex(),yu=D("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,el).replace(/punctSpace/g,_r).replace(/punct/g,wn).getRegex(),Su=D(/\\(punct)/,"gu").replace(/punct/g,wn).getRegex(),$u=D(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Eu=D(dr).replace("(?:-->|$)","-->").getRegex(),Au=D("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Eu).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),un=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,zu=D(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",un).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),il=D(/^!?\[(label)\]\[(ref)\]/).replace("label",un).replace("ref",hr).getRegex(),sl=D(/^!?\[(ref)\](?:\[\])?/).replace("ref",hr).getRegex(),Tu=D("reflink|nolink(?!\\()","g").replace("reflink",il).replace("nolink",sl).getRegex(),vr={_backpedal:Nt,anyPunctuation:Su,autolink:$u,blockSkip:mu,br:Ks,code:hu,del:Nt,emStrongLDelim:bu,emStrongRDelimAst:wu,emStrongRDelimUnd:yu,escape:pu,link:zu,nolink:sl,punctuation:gu,reflink:il,reflinkSearch:Tu,tag:Au,text:du,url:Nt},Ru={...vr,link:D(/^!?\[(label)\]\((.*?)\)/).replace("label",un).getRegex(),reflink:D(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",un).getRegex()},Un={...vr,emStrongRDelimAst:xu,emStrongLDelim:ku,url:D(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Iu={...Un,br:D(Ks).replace("{2,}","*").getRegex(),text:D(Un.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Jt={normal:gr,gfm:cu,pedantic:fu},Tt={normal:vr,gfm:Un,breaks:Iu,pedantic:Ru},Cu={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Gi=e=>Cu[e];function Se(e,t){if(t){if(oe.escapeTest.test(e))return e.replace(oe.escapeReplace,Gi)}else if(oe.escapeTestNoEncode.test(e))return e.replace(oe.escapeReplaceNoEncode,Gi);return e}function Wi(e){try{e=encodeURI(e).replace(oe.percentDecode,"%")}catch{return null}return e}function Qi(e,t){let n=e.replace(oe.findPipe,(s,l,o)=>{let u=!1,c=l;for(;--c>=0&&o[c]==="\\";)u=!u;return u?"|":" |"}),i=n.split(oe.splitPipe),r=0;if(i[0].trim()||i.shift(),i.length>0&&!i.at(-1)?.trim()&&i.pop(),t)if(i.length>t)i.splice(t);else for(;i.length<t;)i.push("");for(;r<i.length;r++)i[r]=i[r].trim().replace(oe.slashPipe,"|");return i}function Rt(e,t,n){let i=e.length;if(i===0)return"";let r=0;for(;r<i&&e.charAt(i-r-1)===t;)r++;return e.slice(0,i-r)}function Pu(e,t){if(e.indexOf(t[1])===-1)return-1;let n=0;for(let i=0;i<e.length;i++)if(e[i]==="\\")i++;else if(e[i]===t[0])n++;else if(e[i]===t[1]&&(n--,n<0))return i;return n>0?-2:-1}function Vi(e,t,n,i,r){let s=t.href,l=t.title||null,o=e[1].replace(r.other.outputLinkReplace,"$1");i.state.inLink=!0;let u={type:e[0].charAt(0)==="!"?"image":"link",raw:n,href:s,title:l,text:o,tokens:i.inlineTokens(o)};return i.state.inLink=!1,u}function Lu(e,t,n){let i=e.match(n.other.indentCodeCompensation);if(i===null)return t;let r=i[1];return t.split(`
`).map(s=>{let l=s.match(n.other.beginningSpace);if(l===null)return s;let[o]=l;return o.length>=r.length?s.slice(r.length):s}).join(`
`)}var cn=class{options;rules;lexer;constructor(e){this.options=e||lt}space(e){let t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){let t=this.rules.block.code.exec(e);if(t){let n=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:Rt(n,`
`)}}}fences(e){let t=this.rules.block.fences.exec(e);if(t){let n=t[0],i=Lu(n,t[3]||"",this.rules);return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:i}}}heading(e){let t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(this.rules.other.endingHash.test(n)){let i=Rt(n,"#");(this.options.pedantic||!i||this.rules.other.endingSpaceChar.test(i))&&(n=i.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){let t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:Rt(t[0],`
`)}}blockquote(e){let t=this.rules.block.blockquote.exec(e);if(t){let n=Rt(t[0],`
`).split(`
`),i="",r="",s=[];for(;n.length>0;){let l=!1,o=[],u;for(u=0;u<n.length;u++)if(this.rules.other.blockquoteStart.test(n[u]))o.push(n[u]),l=!0;else if(!l)o.push(n[u]);else break;n=n.slice(u);let c=o.join(`
`),f=c.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");i=i?`${i}
${c}`:c,r=r?`${r}
${f}`:f;let h=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(f,s,!0),this.lexer.state.top=h,n.length===0)break;let g=s.at(-1);if(g?.type==="code")break;if(g?.type==="blockquote"){let v=g,p=v.raw+`
`+n.join(`
`),_=this.blockquote(p);s[s.length-1]=_,i=i.substring(0,i.length-v.raw.length)+_.raw,r=r.substring(0,r.length-v.text.length)+_.text;break}else if(g?.type==="list"){let v=g,p=v.raw+`
`+n.join(`
`),_=this.list(p);s[s.length-1]=_,i=i.substring(0,i.length-g.raw.length)+_.raw,r=r.substring(0,r.length-v.raw.length)+_.raw,n=p.substring(s.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:i,tokens:s,text:r}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim(),i=n.length>1,r={type:"list",raw:"",ordered:i,start:i?+n.slice(0,-1):"",loose:!1,items:[]};n=i?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=i?n:"[*+-]");let s=this.rules.other.listItemRegex(n),l=!1;for(;e;){let u=!1,c="",f="";if(!(t=s.exec(e))||this.rules.block.hr.test(e))break;c=t[0],e=e.substring(c.length);let h=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,S=>" ".repeat(3*S.length)),g=e.split(`
`,1)[0],v=!h.trim(),p=0;if(this.options.pedantic?(p=2,f=h.trimStart()):v?p=t[1].length+1:(p=t[2].search(this.rules.other.nonSpaceChar),p=p>4?1:p,f=h.slice(p),p+=t[1].length),v&&this.rules.other.blankLine.test(g)&&(c+=g+`
`,e=e.substring(g.length+1),u=!0),!u){let S=this.rules.other.nextBulletRegex(p),E=this.rules.other.hrRegex(p),T=this.rules.other.fencesBeginRegex(p),B=this.rules.other.headingBeginRegex(p),L=this.rules.other.htmlBeginRegex(p);for(;e;){let $=e.split(`
`,1)[0],A;if(g=$,this.options.pedantic?(g=g.replace(this.rules.other.listReplaceNesting,"  "),A=g):A=g.replace(this.rules.other.tabCharGlobal,"    "),T.test(g)||B.test(g)||L.test(g)||S.test(g)||E.test(g))break;if(A.search(this.rules.other.nonSpaceChar)>=p||!g.trim())f+=`
`+A.slice(p);else{if(v||h.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||T.test(h)||B.test(h)||E.test(h))break;f+=`
`+g}!v&&!g.trim()&&(v=!0),c+=$+`
`,e=e.substring($.length+1),h=A.slice(p)}}r.loose||(l?r.loose=!0:this.rules.other.doubleBlankLine.test(c)&&(l=!0));let _=null,b;this.options.gfm&&(_=this.rules.other.listIsTask.exec(f),_&&(b=_[0]!=="[ ] ",f=f.replace(this.rules.other.listReplaceTask,""))),r.items.push({type:"list_item",raw:c,task:!!_,checked:b,loose:!1,text:f,tokens:[]}),r.raw+=c}let o=r.items.at(-1);if(o)o.raw=o.raw.trimEnd(),o.text=o.text.trimEnd();else return;r.raw=r.raw.trimEnd();for(let u=0;u<r.items.length;u++)if(this.lexer.state.top=!1,r.items[u].tokens=this.lexer.blockTokens(r.items[u].text,[]),!r.loose){let c=r.items[u].tokens.filter(h=>h.type==="space"),f=c.length>0&&c.some(h=>this.rules.other.anyLine.test(h.raw));r.loose=f}if(r.loose)for(let u=0;u<r.items.length;u++)r.items[u].loose=!0;return r}}html(e){let t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){let t=this.rules.block.def.exec(e);if(t){let n=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),i=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",r=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:i,title:r}}}table(e){let t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;let n=Qi(t[1]),i=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),r=t[3]?.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],s={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===i.length){for(let l of i)this.rules.other.tableAlignRight.test(l)?s.align.push("right"):this.rules.other.tableAlignCenter.test(l)?s.align.push("center"):this.rules.other.tableAlignLeft.test(l)?s.align.push("left"):s.align.push(null);for(let l=0;l<n.length;l++)s.header.push({text:n[l],tokens:this.lexer.inline(n[l]),header:!0,align:s.align[l]});for(let l of r)s.rows.push(Qi(l,s.header.length).map((o,u)=>({text:o,tokens:this.lexer.inline(o),header:!1,align:s.align[u]})));return s}}lheading(e){let t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){let t=this.rules.block.paragraph.exec(e);if(t){let n=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){let t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){let t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){let t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){let t=this.rules.inline.link.exec(e);if(t){let n=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;let s=Rt(n.slice(0,-1),"\\");if((n.length-s.length)%2===0)return}else{let s=Pu(t[2],"()");if(s===-2)return;if(s>-1){let l=(t[0].indexOf("!")===0?5:4)+t[1].length+s;t[2]=t[2].substring(0,s),t[0]=t[0].substring(0,l).trim(),t[3]=""}}let i=t[2],r="";if(this.options.pedantic){let s=this.rules.other.pedanticHrefTitle.exec(i);s&&(i=s[1],r=s[3])}else r=t[3]?t[3].slice(1,-1):"";return i=i.trim(),this.rules.other.startAngleBracket.test(i)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?i=i.slice(1):i=i.slice(1,-1)),Vi(t,{href:i&&i.replace(this.rules.inline.anyPunctuation,"$1"),title:r&&r.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let i=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),r=t[i.toLowerCase()];if(!r){let s=n[0].charAt(0);return{type:"text",raw:s,text:s}}return Vi(n,r,n[0],this.lexer,this.rules)}}emStrong(e,t,n=""){let i=this.rules.inline.emStrongLDelim.exec(e);if(!(!i||i[3]&&n.match(this.rules.other.unicodeAlphaNumeric))&&(!(i[1]||i[2])||!n||this.rules.inline.punctuation.exec(n))){let r=[...i[0]].length-1,s,l,o=r,u=0,c=i[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(c.lastIndex=0,t=t.slice(-1*e.length+r);(i=c.exec(t))!=null;){if(s=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!s)continue;if(l=[...s].length,i[3]||i[4]){o+=l;continue}else if((i[5]||i[6])&&r%3&&!((r+l)%3)){u+=l;continue}if(o-=l,o>0)continue;l=Math.min(l,l+o+u);let f=[...i[0]][0].length,h=e.slice(0,r+i.index+f+l);if(Math.min(r,l)%2){let v=h.slice(1,-1);return{type:"em",raw:h,text:v,tokens:this.lexer.inlineTokens(v)}}let g=h.slice(2,-2);return{type:"strong",raw:h,text:g,tokens:this.lexer.inlineTokens(g)}}}}codespan(e){let t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(this.rules.other.newLineCharGlobal," "),i=this.rules.other.nonSpaceChar.test(n),r=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return i&&r&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:t[0],text:n}}}br(e){let t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){let t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){let t=this.rules.inline.autolink.exec(e);if(t){let n,i;return t[2]==="@"?(n=t[1],i="mailto:"+n):(n=t[1],i=n),{type:"link",raw:t[0],text:n,href:i,tokens:[{type:"text",raw:n,text:n}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let n,i;if(t[2]==="@")n=t[0],i="mailto:"+n;else{let r;do r=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??"";while(r!==t[0]);n=t[0],t[1]==="www."?i="http://"+t[0]:i=t[0]}return{type:"link",raw:t[0],text:n,href:i,tokens:[{type:"text",raw:n,text:n}]}}}inlineText(e){let t=this.rules.inline.text.exec(e);if(t){let n=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:n}}}},Pe=class Zn{tokens;options;state;tokenizer;inlineQueue;constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||lt,this.options.tokenizer=this.options.tokenizer||new cn,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let n={other:oe,block:Jt.normal,inline:Tt.normal};this.options.pedantic?(n.block=Jt.pedantic,n.inline=Tt.pedantic):this.options.gfm&&(n.block=Jt.gfm,this.options.breaks?n.inline=Tt.breaks:n.inline=Tt.gfm),this.tokenizer.rules=n}static get rules(){return{block:Jt,inline:Tt}}static lex(t,n){return new Zn(n).lex(t)}static lexInline(t,n){return new Zn(n).inlineTokens(t)}lex(t){t=t.replace(oe.carriageReturn,`
`),this.blockTokens(t,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){let i=this.inlineQueue[n];this.inlineTokens(i.src,i.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,n=[],i=!1){for(this.options.pedantic&&(t=t.replace(oe.tabCharGlobal,"    ").replace(oe.spaceLine,""));t;){let r;if(this.options.extensions?.block?.some(l=>(r=l.call({lexer:this},t,n))?(t=t.substring(r.raw.length),n.push(r),!0):!1))continue;if(r=this.tokenizer.space(t)){t=t.substring(r.raw.length);let l=n.at(-1);r.raw.length===1&&l!==void 0?l.raw+=`
`:n.push(r);continue}if(r=this.tokenizer.code(t)){t=t.substring(r.raw.length);let l=n.at(-1);l?.type==="paragraph"||l?.type==="text"?(l.raw+=(l.raw.endsWith(`
`)?"":`
`)+r.raw,l.text+=`
`+r.text,this.inlineQueue.at(-1).src=l.text):n.push(r);continue}if(r=this.tokenizer.fences(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.heading(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.hr(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.blockquote(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.list(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.html(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.def(t)){t=t.substring(r.raw.length);let l=n.at(-1);l?.type==="paragraph"||l?.type==="text"?(l.raw+=(l.raw.endsWith(`
`)?"":`
`)+r.raw,l.text+=`
`+r.raw,this.inlineQueue.at(-1).src=l.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title},n.push(r));continue}if(r=this.tokenizer.table(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.lheading(t)){t=t.substring(r.raw.length),n.push(r);continue}let s=t;if(this.options.extensions?.startBlock){let l=1/0,o=t.slice(1),u;this.options.extensions.startBlock.forEach(c=>{u=c.call({lexer:this},o),typeof u=="number"&&u>=0&&(l=Math.min(l,u))}),l<1/0&&l>=0&&(s=t.substring(0,l+1))}if(this.state.top&&(r=this.tokenizer.paragraph(s))){let l=n.at(-1);i&&l?.type==="paragraph"?(l.raw+=(l.raw.endsWith(`
`)?"":`
`)+r.raw,l.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=l.text):n.push(r),i=s.length!==t.length,t=t.substring(r.raw.length);continue}if(r=this.tokenizer.text(t)){t=t.substring(r.raw.length);let l=n.at(-1);l?.type==="text"?(l.raw+=(l.raw.endsWith(`
`)?"":`
`)+r.raw,l.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=l.text):n.push(r);continue}if(t){let l="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(l);break}else throw new Error(l)}}return this.state.top=!0,n}inline(t,n=[]){return this.inlineQueue.push({src:t,tokens:n}),n}inlineTokens(t,n=[]){let i=t,r=null;if(this.tokens.links){let o=Object.keys(this.tokens.links);if(o.length>0)for(;(r=this.tokenizer.rules.inline.reflinkSearch.exec(i))!=null;)o.includes(r[0].slice(r[0].lastIndexOf("[")+1,-1))&&(i=i.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+i.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(r=this.tokenizer.rules.inline.anyPunctuation.exec(i))!=null;)i=i.slice(0,r.index)+"++"+i.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(r=this.tokenizer.rules.inline.blockSkip.exec(i))!=null;)i=i.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+i.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let s=!1,l="";for(;t;){s||(l=""),s=!1;let o;if(this.options.extensions?.inline?.some(c=>(o=c.call({lexer:this},t,n))?(t=t.substring(o.raw.length),n.push(o),!0):!1))continue;if(o=this.tokenizer.escape(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.tag(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.link(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(o.raw.length);let c=n.at(-1);o.type==="text"&&c?.type==="text"?(c.raw+=o.raw,c.text+=o.text):n.push(o);continue}if(o=this.tokenizer.emStrong(t,i,l)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.codespan(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.br(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.del(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.autolink(t)){t=t.substring(o.raw.length),n.push(o);continue}if(!this.state.inLink&&(o=this.tokenizer.url(t))){t=t.substring(o.raw.length),n.push(o);continue}let u=t;if(this.options.extensions?.startInline){let c=1/0,f=t.slice(1),h;this.options.extensions.startInline.forEach(g=>{h=g.call({lexer:this},f),typeof h=="number"&&h>=0&&(c=Math.min(c,h))}),c<1/0&&c>=0&&(u=t.substring(0,c+1))}if(o=this.tokenizer.inlineText(u)){t=t.substring(o.raw.length),o.raw.slice(-1)!=="_"&&(l=o.raw.slice(-1)),s=!0;let c=n.at(-1);c?.type==="text"?(c.raw+=o.raw,c.text+=o.text):n.push(o);continue}if(t){let c="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return n}},fn=class{options;parser;constructor(e){this.options=e||lt}space(e){return""}code({text:e,lang:t,escaped:n}){let i=(t||"").match(oe.notSpaceStart)?.[0],r=e.replace(oe.endingNewline,"")+`
`;return i?'<pre><code class="language-'+Se(i)+'">'+(n?r:Se(r,!0))+`</code></pre>
`:"<pre><code>"+(n?r:Se(r,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}def(e){return""}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){let t=e.ordered,n=e.start,i="";for(let l=0;l<e.items.length;l++){let o=e.items[l];i+=this.listitem(o)}let r=t?"ol":"ul",s=t&&n!==1?' start="'+n+'"':"";return"<"+r+s+`>
`+i+"</"+r+`>
`}listitem(e){let t="";if(e.task){let n=this.checkbox({checked:!!e.checked});e.loose?e.tokens[0]?.type==="paragraph"?(e.tokens[0].text=n+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=n+" "+Se(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:n+" ",text:n+" ",escaped:!0}):t+=n+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",n="";for(let r=0;r<e.header.length;r++)n+=this.tablecell(e.header[r]);t+=this.tablerow({text:n});let i="";for(let r=0;r<e.rows.length;r++){let s=e.rows[r];n="";for(let l=0;l<s.length;l++)n+=this.tablecell(s[l]);i+=this.tablerow({text:n})}return i&&(i=`<tbody>${i}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+i+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){let t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${Se(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){let i=this.parser.parseInline(n),r=Wi(e);if(r===null)return i;e=r;let s='<a href="'+e+'"';return t&&(s+=' title="'+Se(t)+'"'),s+=">"+i+"</a>",s}image({href:e,title:t,text:n,tokens:i}){i&&(n=this.parser.parseInline(i,this.parser.textRenderer));let r=Wi(e);if(r===null)return Se(n);e=r;let s=`<img src="${e}" alt="${n}"`;return t&&(s+=` title="${Se(t)}"`),s+=">",s}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:Se(e.text)}},mr=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}},Le=class Gn{options;renderer;textRenderer;constructor(t){this.options=t||lt,this.options.renderer=this.options.renderer||new fn,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new mr}static parse(t,n){return new Gn(n).parse(t)}static parseInline(t,n){return new Gn(n).parseInline(t)}parse(t,n=!0){let i="";for(let r=0;r<t.length;r++){let s=t[r];if(this.options.extensions?.renderers?.[s.type]){let o=s,u=this.options.extensions.renderers[o.type].call({parser:this},o);if(u!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(o.type)){i+=u||"";continue}}let l=s;switch(l.type){case"space":{i+=this.renderer.space(l);continue}case"hr":{i+=this.renderer.hr(l);continue}case"heading":{i+=this.renderer.heading(l);continue}case"code":{i+=this.renderer.code(l);continue}case"table":{i+=this.renderer.table(l);continue}case"blockquote":{i+=this.renderer.blockquote(l);continue}case"list":{i+=this.renderer.list(l);continue}case"html":{i+=this.renderer.html(l);continue}case"def":{i+=this.renderer.def(l);continue}case"paragraph":{i+=this.renderer.paragraph(l);continue}case"text":{let o=l,u=this.renderer.text(o);for(;r+1<t.length&&t[r+1].type==="text";)o=t[++r],u+=`
`+this.renderer.text(o);n?i+=this.renderer.paragraph({type:"paragraph",raw:u,text:u,tokens:[{type:"text",raw:u,text:u,escaped:!0}]}):i+=u;continue}default:{let o='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return i}parseInline(t,n=this.renderer){let i="";for(let r=0;r<t.length;r++){let s=t[r];if(this.options.extensions?.renderers?.[s.type]){let o=this.options.extensions.renderers[s.type].call({parser:this},s);if(o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){i+=o||"";continue}}let l=s;switch(l.type){case"escape":{i+=n.text(l);break}case"html":{i+=n.html(l);break}case"link":{i+=n.link(l);break}case"image":{i+=n.image(l);break}case"strong":{i+=n.strong(l);break}case"em":{i+=n.em(l);break}case"codespan":{i+=n.codespan(l);break}case"br":{i+=n.br(l);break}case"del":{i+=n.del(l);break}case"text":{i+=n.text(l);break}default:{let o='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return i}},tn=class{options;block;constructor(e){this.options=e||lt}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?Pe.lex:Pe.lexInline}provideParser(){return this.block?Le.parse:Le.parseInline}},Nu=class{defaults=cr();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=Le;Renderer=fn;TextRenderer=mr;Lexer=Pe;Tokenizer=cn;Hooks=tn;constructor(...e){this.use(...e)}walkTokens(e,t){let n=[];for(let i of e)switch(n=n.concat(t.call(this,i)),i.type){case"table":{let r=i;for(let s of r.header)n=n.concat(this.walkTokens(s.tokens,t));for(let s of r.rows)for(let l of s)n=n.concat(this.walkTokens(l.tokens,t));break}case"list":{let r=i;n=n.concat(this.walkTokens(r.items,t));break}default:{let r=i;this.defaults.extensions?.childTokens?.[r.type]?this.defaults.extensions.childTokens[r.type].forEach(s=>{let l=r[s].flat(1/0);n=n.concat(this.walkTokens(l,t))}):r.tokens&&(n=n.concat(this.walkTokens(r.tokens,t)))}}return n}use(...e){let t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(n=>{let i={...n};if(i.async=this.defaults.async||i.async||!1,n.extensions&&(n.extensions.forEach(r=>{if(!r.name)throw new Error("extension name required");if("renderer"in r){let s=t.renderers[r.name];s?t.renderers[r.name]=function(...l){let o=r.renderer.apply(this,l);return o===!1&&(o=s.apply(this,l)),o}:t.renderers[r.name]=r.renderer}if("tokenizer"in r){if(!r.level||r.level!=="block"&&r.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let s=t[r.level];s?s.unshift(r.tokenizer):t[r.level]=[r.tokenizer],r.start&&(r.level==="block"?t.startBlock?t.startBlock.push(r.start):t.startBlock=[r.start]:r.level==="inline"&&(t.startInline?t.startInline.push(r.start):t.startInline=[r.start]))}"childTokens"in r&&r.childTokens&&(t.childTokens[r.name]=r.childTokens)}),i.extensions=t),n.renderer){let r=this.defaults.renderer||new fn(this.defaults);for(let s in n.renderer){if(!(s in r))throw new Error(`renderer '${s}' does not exist`);if(["options","parser"].includes(s))continue;let l=s,o=n.renderer[l],u=r[l];r[l]=(...c)=>{let f=o.apply(r,c);return f===!1&&(f=u.apply(r,c)),f||""}}i.renderer=r}if(n.tokenizer){let r=this.defaults.tokenizer||new cn(this.defaults);for(let s in n.tokenizer){if(!(s in r))throw new Error(`tokenizer '${s}' does not exist`);if(["options","rules","lexer"].includes(s))continue;let l=s,o=n.tokenizer[l],u=r[l];r[l]=(...c)=>{let f=o.apply(r,c);return f===!1&&(f=u.apply(r,c)),f}}i.tokenizer=r}if(n.hooks){let r=this.defaults.hooks||new tn;for(let s in n.hooks){if(!(s in r))throw new Error(`hook '${s}' does not exist`);if(["options","block"].includes(s))continue;let l=s,o=n.hooks[l],u=r[l];tn.passThroughHooks.has(s)?r[l]=c=>{if(this.defaults.async)return Promise.resolve(o.call(r,c)).then(h=>u.call(r,h));let f=o.call(r,c);return u.call(r,f)}:r[l]=(...c)=>{let f=o.apply(r,c);return f===!1&&(f=u.apply(r,c)),f}}i.hooks=r}if(n.walkTokens){let r=this.defaults.walkTokens,s=n.walkTokens;i.walkTokens=function(l){let o=[];return o.push(s.call(this,l)),r&&(o=o.concat(r.call(this,l))),o}}this.defaults={...this.defaults,...i}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return Pe.lex(e,t??this.defaults)}parser(e,t){return Le.parse(e,t??this.defaults)}parseMarkdown(e){return(t,n)=>{let i={...n},r={...this.defaults,...i},s=this.onError(!!r.silent,!!r.async);if(this.defaults.async===!0&&i.async===!1)return s(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof t>"u"||t===null)return s(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return s(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));r.hooks&&(r.hooks.options=r,r.hooks.block=e);let l=r.hooks?r.hooks.provideLexer():e?Pe.lex:Pe.lexInline,o=r.hooks?r.hooks.provideParser():e?Le.parse:Le.parseInline;if(r.async)return Promise.resolve(r.hooks?r.hooks.preprocess(t):t).then(u=>l(u,r)).then(u=>r.hooks?r.hooks.processAllTokens(u):u).then(u=>r.walkTokens?Promise.all(this.walkTokens(u,r.walkTokens)).then(()=>u):u).then(u=>o(u,r)).then(u=>r.hooks?r.hooks.postprocess(u):u).catch(s);try{r.hooks&&(t=r.hooks.preprocess(t));let u=l(t,r);r.hooks&&(u=r.hooks.processAllTokens(u)),r.walkTokens&&this.walkTokens(u,r.walkTokens);let c=o(u,r);return r.hooks&&(c=r.hooks.postprocess(c)),c}catch(u){return s(u)}}}onError(e,t){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e){let i="<p>An error occurred:</p><pre>"+Se(n.message+"",!0)+"</pre>";return t?Promise.resolve(i):i}if(t)return Promise.reject(n);throw n}}},nt=new Nu;function F(e,t){return nt.parse(e,t)}F.options=F.setOptions=function(e){return nt.setOptions(e),F.defaults=nt.defaults,Vs(F.defaults),F};F.getDefaults=cr;F.defaults=lt;F.use=function(...e){return nt.use(...e),F.defaults=nt.defaults,Vs(F.defaults),F};F.walkTokens=function(e,t){return nt.walkTokens(e,t)};F.parseInline=nt.parseInline;F.Parser=Le;F.parser=Le.parse;F.Renderer=fn;F.TextRenderer=mr;F.Lexer=Pe;F.lexer=Pe.lex;F.Tokenizer=cn;F.Hooks=tn;F.parse=F;F.options;F.setOptions;F.use;F.walkTokens;F.parseInline;Le.parse;Pe.lex;function Mu(e=""){return F.parse(String(e))}function qu(e){const t=String(e).split(/\r?\n/),n=[];let i=[];const r=()=>{i.length&&(n.push(Mu(i.join(`
`))),i.length=0)},s=l=>/^\s*\[\[(pagebreak|colbreak|rowbreak)(:[^]]+)?\]\]\s*$/i.test(l);for(const l of t){const o=l.match(/^\s*\[\[\s*head(?:er)?:\s*(.*?)\s*\]\]\s*$/i),u=l.match(/^\s*\[\[\s*foot:\s*(.*?)\s*\]\]\s*$/i),c=l.match(/^\s*\[\[\s*rowbreak(?::\s*([^\]]+))?\s*\]\]\s*$/i);if(o){r(),n.push(`<div data-runhead="${o[1].replace(/"/g,"&quot;")}"></div>`);continue}if(u){r(),n.push(`<div data-runfoot="${u[1].replace(/"/g,"&quot;")}"></div>`);continue}if(c){r();let f=(c[1]||"").trim();f||(f="1em"),/^\d+(\.\d+)?$/.test(f)&&(f=`${f}em`),n.push(`<div data-rowbreak="1" class="force-rowbreak" style="height:${f}"></div>`);continue}if(s(l)){const f=l.trim().toLowerCase();r(),f.includes("colbreak")?n.push('<div data-colbreak="1" class="force-colbreak"></div>'):n.push('<div data-pagebreak="1" class="page-break-marker"></div>')}else i.push(l)}return r(),n.join(`
`)}let Wn=null;function _t(e,t){const n=Wn||document.body,i=document.createElement("div");i.style.position="absolute",i.style.left="-99999px",i.style.top="0",i.style.width=t+"px",i.style.boxSizing="border-box",i.style.visibility="hidden",i.style.whiteSpace="normal",i.style.wordBreak="normal",i.style.overflowWrap="anywhere",n.appendChild(i);const r=e.cloneNode(!0);r.style.whiteSpace="inherit",r.style.wordBreak="inherit",r.style.overflowWrap="inherit",i.appendChild(r);const s=getComputedStyle(r),l=parseFloat(s.marginTop)||0,o=parseFloat(s.marginBottom)||0,u=r.offsetHeight+l+o;return i.remove(),{h:u,mt:l,mb:o}}function Ou(e){const t=e.classList||{contains:()=>!1};return t.contains("span-all")||t.contains("full")||t.contains("cols")||t.contains("cols-1")||t.contains("cols-2")||t.contains("img-page")||t.contains("img-wide")||t.contains("figure-wide")}function ll(e,t,n,i=!1){const s=(e.textContent??"").toString().replace(/\s+/g," ").trim();if(!s.length)return{head:null,tail:null};if(!(e.childNodes.length===1&&e.firstChild&&e.firstChild.nodeType===3)){if(i)return{head:null,tail:null};const _=document.createElement("p");return _.textContent=s,ll(_,t,n,!0)}const o=e.cloneNode(!1);if(o.textContent=s,_t(o,t).h<=n)return{head:e.cloneNode(!0),tail:null};const u=e.cloneNode(!1),c=e.cloneNode(!1);let f=0,h=s.length;for(;f<h;){const _=f+h+1>>1;u.textContent=s.slice(0,_),_t(u,t).h<=n?f=_:h=_-1}let g=f;for(;g>0&&!/\s/.test(s[g-1]);)g--;g===0&&(g=f);const v=s.slice(0,g).replace(/\s+$/,""),p=s.slice(g).replace(/^\s+/,"");return u.textContent=v,c.textContent=p,{head:v?u:null,tail:p?c:null}}function ju(e,t,n){const i=e.tagName;if(i==="P")return ll(e,t,n);if(i==="UL"||i==="OL"){const r=e.cloneNode(!1),s=e.cloneNode(!1),l=Array.from(e.children);for(let o=0;o<l.length;o++)if(r.appendChild(l[o].cloneNode(!0)),_t(r,t).h>n){r.removeChild(r.lastChild);for(let c=o;c<l.length;c++)s.appendChild(l[c].cloneNode(!0));return{head:r.childNodes.length?r:null,tail:s.childNodes.length?s:null}}return{head:r,tail:null}}return{head:null,tail:null}}function Du(e){const t=e.measurer_el??e.measurerEl,n=e.page_px??e.pagePx,i=e.pad,r=e.columns,s=e.column_gap??e.columnGap;if(!t||!n||!i)return{pages:[],heads:[],foots:[]};Wn=t;const l=n.h-(i.top+i.bottom),o=Math.max(1,Number(r)||1),u=(Number(s)||0)*Ce,c=n.w-(i.left+i.right),f=o>1?(c-u*(o-1))/o:c,h=Array.from(t.childNodes).filter(N=>N.nodeType===1),g=[],v=[],p=[];let _=[],b=0,S=0,E=0,T="",B="";const L=()=>{g.push(_.join("")),v.push(T),p.push(B),_=[],b=0,S=0,E=0},$=()=>{b<o-1?(b+=1,S=0,E=0):L()},A=N=>{_.push(N)};let P=0;for(;P<h.length;){const N=h[P];if(N.hasAttribute&&N.hasAttribute("data-runhead")){T=N.getAttribute("data-runhead")||"",P++;continue}if(N.hasAttribute&&N.hasAttribute("data-runfoot")){B=N.getAttribute("data-runfoot")||"",P++;continue}if(N.hasAttribute&&N.hasAttribute("data-pagebreak")){L(),P++;continue}if(N.hasAttribute&&N.hasAttribute("data-colbreak")){A('<div class="force-colbreak"></div>'),$(),P++;continue}if(N.hasAttribute&&N.hasAttribute("data-rowbreak")){const V=_t(N,f),ie=S===0?V.h:V.h-Math.min(E,V.mt);ie<=l-S?(A(N.outerHTML),S+=ie,E=V.mb,P++):$();continue}if(["META","LINK","SCRIPT","STYLE"].includes(N.tagName)){P++;continue}const X=N,re=Ou(X),I=_t(X,re?c:f),Re=S===0?I.h:I.h-Math.min(E,I.mt),fe=l-S;if(Re<=fe){A(X.outerHTML),S+=Re,E=I.mb,P++;continue}if(I.h<=l){$();continue}const be=re?c:f,{head:de,tail:Ge}=ju(X,be,fe);if(de){const V=_t(de,be),ie=S===0?V.h:V.h-Math.min(E,V.mt);if(ie<=l-S){A(de.outerHTML),S+=ie,E=V.mb,Ge&&h.splice(P+1,0,Ge),P++;continue}else{$();continue}}A(X.outerHTML),L(),P++}return g.push(_.join("")),v.push(T),p.push(B),Wn=null,{pages:g,heads:v,foots:p}}function Bu(e,t,n,i,r,s,l,o,u,c,f){const h=b=>`${b}mm`,g=c==="spreads"?e.w*2+f:e.w,v=e.h,p=`
@page { size: ${h(g)} ${h(v)}; margin: 0; }
@media print {
  body { background: #fff !important; }
  .topbar, .workspace .left, .workspace .splitter, .right .spreads { display: none !important; }
  #print-root { display: block !important; }
  #print-root .print-page { width: ${h(e.w)}; height: ${h(e.h)}; background: #fff; box-shadow: none !important; page-break-after: always; }
  #print-root .print-page:last-child { page-break-after: auto; }
  #print-root .print-sheet { display: flex; align-items: stretch; width: ${h(g)}; height: ${h(v)}; page-break-after: always; background: #fff; }
  #print-root .print-sheet:last-child { page-break-after: auto; }
  #print-root .print-gutter { width: ${h(f)}; flex: 0 0 ${h(f)}; }
  #print-root .print-inner {
    box-sizing: border-box; width: 100%; height: 100%; overflow: hidden;
    padding: ${h(t.top)} ${h(t.right)} ${h(t.bottom)} ${h(t.left)};
    --pad-top:${h(t.top)}; --pad-right:${h(t.right)}; --pad-bottom:${h(t.bottom)}; --pad-left:${h(t.left)};
    column-count: ${n}; column-gap: ${h(i)};
    font-family: ${r}; font-size: ${s}pt; line-height: ${l};
    text-align: ${o==="justify"?"justify":"left"}; hyphens: ${u};
  }
}
`;let _=document.getElementById("print-rules");_||(_=document.createElement("style"),_.id="print-rules",document.head.appendChild(_)),_.textContent=p}function Fu(e=""){return String(e).toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"").slice(0,80)||"book"}function Hu(e,t){const n=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),i=URL.createObjectURL(n),r=document.createElement("a");r.href=i,r.download=e,document.body.appendChild(r),r.click(),r.remove(),URL.revokeObjectURL(i)}function Uu(e){return{__type:"zine-book",__version:2,savedAt:new Date().toISOString(),...e}}async function Zu(e){const t=await Jo(e.markdown),n=Uu({...e,assets:t});Hu(`${Fu(e.title)}.zine.json`,n)}function Gu(e,t){e&&(t.title(e.title),t.page_size(e.page_size),t.margins(e.margins),t.columns(Number(e.columns)),t.column_gap(Number(e.column_gap)),t.font_family(e.font_family),t.base_font_pt(Number(e.base_font_pt)),t.line_height(Number(e.line_height)),t.justify(e.justify),t.hyphens(e.hyphens),t.print_mode(e.print_mode),t.spread_gutter(Number(e.spread_gutter)),typeof e.left_percent=="number"&&t.left_percent(Math.max(20,Math.min(80,e.left_percent))),t.markdown(e.markdown))}async function Wu(e,t,n){try{const i=await e.text(),r=JSON.parse(i);r.assets&&await Ko(r.assets),Gu(r,t),await Ye(),await n()}catch(i){console.error(i),alert("Import failed: invalid or corrupted file.")}finally{const i=document.getElementById("import_book");i&&(i.value="")}}var Qu=it("<option> </option>"),Vu=it("<button></button>"),Yu=it('<label>Gutter <input type="number" min="0" step="1"/> mm</label> <label>Order <select><option>Editorial (1–2, 3–4…)</option><option>Booklet (printer spreads)</option></select></label>',1),Xu=it('<div class="page"><div class="page-running-header"> </div> <div><!></div> <div class="page-running-footer"> </div> <div></div></div>'),Ju=it('<div class="print-page"><div class="print-running-header"> </div> <div><!></div> <div class="print-running-footer"> </div> <div></div></div>'),Ku=it('<div class="print-sheet"><div class="print-page"><div class="print-running-header"><!></div> <div><!></div> <div class="print-running-footer"><!></div> <div class="print-page-number lef"><!></div></div> <div class="print-gutter"></div> <div class="print-page"><div class="print-running-header"><!></div> <div><!></div> <div class="print-running-footer"><!></div> <div class="print-page-number rig"><!></div></div></div>'),ec=it('<div class="topbar"><div class="group"><label>PDF Title <input type="text" placeholder="Title…"/></label> <label>Size <select></select></label> <button>Reset margins</button></div> <div class="group"><label>T <input type="number" min="0" step="1"/> mm</label> <label>R <input type="number" min="0" step="1"/> mm</label> <label>B <input type="number" min="0" step="1"/> mm</label> <label>L <input type="number" min="0" step="1"/> mm</label></div> <div class="group"><label>Cols <input type="number" min="1" step="1"/></label> <label>Gap <input type="number" min="0" step="1"/> mm</label></div> <div class="group"><label>Font <select><option>Serif</option><option>Sans</option><option>Mono</option></select></label> <label>Size <input type="number" min="3" step="0.5"/> pt</label> <label>LH <input type="number" min="0.5" step="0.1"/></label> <button>A−</button> <button>A+</button> <label><select><option>Ragged</option><option>Justify</option></select></label> <label><select><option>No hyphens</option><option>Hyphens auto</option></select></label></div> <div class="group right"><button>+ Head</button> <button>+ Foot</button> <input type="file" id="image_input" accept="image/*" multiple style="display:none"/> <input type="file" id="image_input_full" accept="image/*" multiple style="display:none"/> <button>+ Image</button> <button>+ Full Image</button> <button>Span all</button> <!> <button>+ Col Break</button> <button>+ Row Break</button> <button>+ Page Break</button></div> <div class="group right"><button>Save</button> <input id="import_book" type="file" accept="application/json" style="display:none"/> <button>Import</button> <div class="group"><label>Print <select><option>Single pages</option><option>Spreads (2-up)</option></select></label> <!></div> <button class="primary">Print / PDF</button></div> <div class="zoombar"><input type="range" min="25" max="200" step="5"/> <button type="button">100%</button> <span class="zoomval"> </span></div></div> <div class="workspace"><section class="left"><div class="editor"><div class="header"><div>Markdown</div> <div class="meta"> </div></div> <textarea spellcheck="false"></textarea> <div class="hint storage-indicator"> </div></div></section> <div class="splitter" title="Drag to resize"></div> <section class="right"><div id="measurer"><!></div> <div class="spreads-viewport"><div class="spreads-scale"><div class="spreads"></div></div></div> <div id="print-root" aria-hidden="true" style="display:none"><!></div></section></div>',1);function tc(e,t){rs(t,!1);const n=M(),i=M(),r=M(),s=M(),l=M(),o=M(),u=M(),c=M(),f=M(),h=M(),g=`## Can we write while we are typesetting a book?
[[pagebreak]]`;let v=M(localStorage.getItem("zine:title")??"Untitled Zine"),p=M(localStorage.getItem("zine:page_size")??"A7"),_=M(JSON.parse(localStorage.getItem("zine:margins")??JSON.stringify(pt.A7.margins))),b=M(localStorage.getItem("zine:markdown")??g),S=M(Number(localStorage.getItem("zine:columns")??1)),E=M(Number(localStorage.getItem("zine:column_gap")??5)),T=M(localStorage.getItem("zine:font_family")??"Courier, monospace"),B=M(Number(localStorage.getItem("zine:base_font_pt")??8)),L=M(Number(localStorage.getItem("zine:line_height")??1)),$=M(localStorage.getItem("zine:justify")??"left"),A=M(localStorage.getItem("zine:hyphens")??"auto"),P=M(localStorage.getItem("zine:print_mode")??"pages"),N=M(Number(localStorage.getItem("zine:spread_gutter")??6)),X=M(Number(localStorage.getItem("zine:zoom")??100)),re=M(localStorage.getItem("zine:arrangement")??"sequential"),I=M([]),Re=M(""),fe=M([]),be=M([]),de=M(),Ge=M(""),V=M([]),ie=M([]);const al=96/72;function ol(d){const w=d.target?.files?.[0];w&&Wu(w,{title:m=>x(v,m??a(v)),page_size:m=>x(p,m??a(p)),margins:m=>x(_,m??a(_)),markdown:m=>x(b,m??a(b)),columns:m=>x(S,m??a(S)),column_gap:m=>x(E,m??a(E)),font_family:m=>x(T,m??a(T)),base_font_pt:m=>x(B,m??a(B)),line_height:m=>x(L,m??a(L)),justify:m=>x($,m??a($)),hyphens:m=>x(A,m??a(A)),print_mode:m=>x(P,m??a(P)),spread_gutter:m=>x(N,m??a(N)),left_percent:m=>x(we,m??a(we))},yn)}function ul(d){const w=[];if(d<=0)return w;w.push([null,0]);for(let m=1;m<d;m+=2)w.push([m,m+1<d?m+1:null]);return w}function cl(d){const w=d+(4-d%4)%4,m=[];let z=0,R=w-1;for(;z<R;)m.push([R<d?R:null,z<d?z:null]),m.push([z+1<d?z+1:null,R-1<d?R-1:null]),z+=2,R-=2;return m}function fl(d,w){const m=w==="booklet"?cl(d.length):ul(d.length);return{pairs:m.map(([R,C])=>[R!=null?d[R]:"",C!=null?d[C]:""]),idxs:m}}function pl(){Zu({title:a(v),page_size:a(p),margins:a(_),markdown:a(b),columns:a(S),column_gap:a(E),font_family:a(T),base_font_pt:a(B),line_height:a(L),justify:a($),hyphens:a(A),print_mode:a(P),spread_gutter:a(N),left_percent:a(we)})}async function br(){const d=await Qs();x(Ge,`Storage ${d.toFixed(1)} MB`)}let xn;async function yn(){xn&&clearTimeout(xn),xn=setTimeout(async()=>{if(!a(de))return;await Ye(),x(Re,await Ui(a(h))),await Ye();const d=Du({measurerEl:a(de),pagePx:a(r),pad:a(s),columns:a(S),columnGap:a(E)});x(fe,d.pages),x(V,d.heads),x(ie,d.foots);const w=fl(a(fe),a(P)==="spreads"?a(re):"sequential");x(be,w.pairs),x(I,w.idxs),Bu(a(i),a(_),a(S),a(E),a(T),a(B),a(L),a($),a(A),a(P),a(N))},60)}function We(d){const w=a(Qe),m=w?.selectionStart??a(b).length,z=w?.selectionEnd??a(b).length;x(b,a(b).slice(0,m)+d+a(b).slice(z)),Ye().then(()=>{const R=m+d.length;w?.setSelectionRange(R,R),w?.focus()})}function hl(d){const w=a(Qe),m=w?.selectionStart??a(b).length,z=w?.selectionEnd??a(b).length,R=a(b).slice(m,z)||"",C=a(b).slice(0,m),Y=a(b).slice(z),G=`

<div class="${d}">
${R}
</div>

`;x(b,C+G+Y),Ye().then(()=>{const K=(C+G).length;w?.setSelectionRange(K,K),w?.focus()})}function dl(d){const w=a(Qe),m=w?.selectionStart??a(b).length,z=w?.selectionEnd??a(b).length,R=a(b).slice(m,z)||"",C=a(b).slice(0,m),Y=a(b).slice(z),G=`

<div class="cols" style="column-count:${d};">
${R}
</div>

`;x(b,C+G+Y),Ye().then(()=>{const K=(C+G).length;w?.setSelectionRange(K,K),w?.focus()})}const gl=()=>We(`

[[rowbreak:1]]

`),_l=()=>We(`

[[pagebreak]]

`),vl=()=>We(`

[[colbreak]]

`),ml=()=>We(`

[[head: Your Heading]]

`),bl=()=>We(`

[[foot: Your Footer]]

`);async function Sn(d,w=!1){const{key:m,file:z}=await Go(d);We(w?`

[[pagebreak]]
<img src="appimg://${m}" alt="${z.name}" class="img-page" />
[[pagebreak]]
`:`

![${z.name}](appimg://${m})

`),await Qo(a(b)).catch(()=>{}),await br()}let $n=0;async function En(d){for(;$n>=1;)await new Promise(w=>setTimeout(w,30));$n++;try{return await d()}finally{$n--}}function kl(d){d.preventDefault(),Array.from(d.dataTransfer.files||[]).filter(m=>m.type.startsWith("image/")).reduce((m,z)=>m.then(()=>En(()=>Sn(z,!1))),Promise.resolve())}const wl=d=>d.preventDefault();function xl(d){const m=Array.from(d.clipboardData?.items||[]).find(z=>z.type.startsWith("image/"));m&&(d.preventDefault(),En(()=>Sn(m.getAsFile(),!1)))}async function kr(d,w){const m=Array.from(d.target.files||[]);for(const z of m)await En(()=>Sn(z,w));d.target.value=""}const yl=()=>{document.title=a(v),window.print()};let Qe=M();Ds(async()=>{a(Qe)?.focus(),x(Re,await Ui(a(h))),await yn(),await br()}),Io(Vo);let we=M(Number(localStorage.getItem("zine:left_percent")??48)),An=!1,wr=0,xr=a(we);function Sl(d){An=!0,wr=d.clientX,xr=a(we),window.addEventListener("mousemove",yr),window.addEventListener("mouseup",Sr)}function yr(d){if(!An)return;const w=document.querySelector(".workspace")?.clientWidth||1,z=(d.clientX-wr)/w*100;x(we,Math.max(20,Math.min(80,Math.round((xr+z)*10)/10)))}function Sr(){An=!1,window.removeEventListener("mousemove",yr),window.removeEventListener("mouseup",Sr)}function $l(d,w){const m=d.lastIndexOf(`

`,Math.max(0,w-1)),z=d.indexOf(`

`,w),R=m>=0?m+2:0,C=z>=0?z:d.length;return[R,C]}function $r(d){const w=a(Qe),m=w?.selectionStart??a(b).length,z=w?.selectionEnd??a(b).length;let R=m,C=z;R===C&&([R,C]=$l(a(b),R));let Y=a(b).slice(0,R),G=a(b).slice(R,C),K=a(b).slice(C);const xe=/^<span style="font-size:([\d.]+)em">([\s\S]*)<\/span>$/,ye=G.match(xe);if(ye){let se=parseFloat(ye[1]);const Ie=ye[2];G=`<span style="font-size:${Math.max(.5,Math.min(4,se+d))}em">${Ie}</span>`}else G=`<span style="font-size:${1+d}em">${G}</span>`;x(b,Y+G+K),Ye().then(()=>{const se=(Y+G).length;w?.setSelectionRange(se,se),w?.focus()})}const El=()=>$r(-.1),Al=()=>$r(.1);H(()=>a(X),()=>{localStorage.setItem("zine:zoom",String(a(X)))}),H(()=>a(re),()=>{localStorage.setItem("zine:arrangement",a(re))}),H(()=>a(X),()=>{x(n,Math.max(10,Math.min(400,a(X)))/100)}),H(()=>a(v),()=>{localStorage.setItem("zine:title",a(v))}),H(()=>a(p),()=>{localStorage.setItem("zine:page_size",a(p))}),H(()=>a(_),()=>{localStorage.setItem("zine:margins",JSON.stringify(a(_)))}),H(()=>a(b),()=>{localStorage.setItem("zine:markdown",a(b))}),H(()=>a(S),()=>{localStorage.setItem("zine:columns",String(a(S)))}),H(()=>a(E),()=>{localStorage.setItem("zine:column_gap",String(a(E)))}),H(()=>a(T),()=>{localStorage.setItem("zine:font_family",a(T))}),H(()=>a(B),()=>{localStorage.setItem("zine:base_font_pt",String(a(B)))}),H(()=>a(L),()=>{localStorage.setItem("zine:line_height",String(a(L)))}),H(()=>a($),()=>{localStorage.setItem("zine:justify",a($))}),H(()=>a(A),()=>{localStorage.setItem("zine:hyphens",a(A))}),H(()=>a(P),()=>{localStorage.setItem("zine:print_mode",a(P))}),H(()=>a(N),()=>{localStorage.setItem("zine:spread_gutter",String(a(N)))}),H(()=>a(p),()=>{x(i,pt[a(p)]??pt.A7)}),H(()=>(a(i),Ce),()=>{x(r,{w:Math.round(a(i).w*Ce),h:Math.round(a(i).h*Ce)})}),H(()=>(a(_),Ce),()=>{x(s,{top:Math.round(a(_).top*Ce),right:Math.round(a(_).right*Ce),bottom:Math.round(a(_).bottom*Ce),left:Math.round(a(_).left*Ce)})}),H(()=>a(B),()=>{x(l,Math.round(a(B)*al*100)/100)}),H(()=>(a(T),a(l),a(L),a($),a(A)),()=>{x(o,`
    font-family:${a(T)};
    font-size:${a(l)}px;
    line-height:${a(L)};
    text-align:${a($)==="justify"?"justify":"left"};
    hyphens:${a(A)};
  `)}),H(()=>(a(r),a(_),a(T)),()=>{x(u,`
  width:${a(r).w}px;
  height:${a(r).h}px;
  --margin-bottom:${a(_).bottom};
  font-family:${a(T)};
  `)}),H(()=>(a(s),a(S),a(E),a(o)),()=>{x(c,`
    padding:${a(s).top}px ${a(s).right}px ${a(s).bottom}px ${a(s).left}px;
    --pad-top:${a(s).top}px; --pad-right:${a(s).right}px; --pad-bottom:${a(s).bottom}px; --pad-left:${a(s).left}px;
    column-count:${a(S)}; column-gap:${a(E)}mm;
    ${a(o)}
  `)}),H(()=>(a(r),a(s),a(o)),()=>{x(f,`
    position:absolute; left:-99999px; top:0; opacity:0; pointer-events:none;
    width:${a(r).w-(a(s).left+a(s).right)}px;
    ${a(o)}
  `)}),H(()=>a(b),()=>{x(h,qu(a(b)))}),H(()=>(a(h),a(r),a(S),a(E),a(s),a(l),a(L),a($),a(A),a(T),a(P),a(N),a(i),a(re)),()=>{a(h),a(r).h,a(r).w,a(S),a(E),a(s).top,a(s).right,a(s).bottom,a(s).left,a(l),a(L),a($),a(A),a(T),a(P),a(N),a(i).id,a(re),yn()}),H(()=>a(we),()=>{localStorage.setItem("zine:left_percent",String(a(we)))}),oo(),Ro();var Er=ec(),Ar=Xt(Er),zr=y(Ar),Tr=y(zr),zl=k(y(Tr)),Rr=k(Tr,2),Ir=k(y(Rr));ee(()=>{a(p),at(()=>{})}),At(Ir,5,()=>(Ns(pt),O(()=>Object.values(pt))),Et,(d,w)=>{var m=Qu(),z=y(m),R={};ee(()=>{ce(z,(a(w),O(()=>a(w).label))),R!==(R=(a(w),O(()=>a(w).id)))&&(m.value=(m.__value=(a(w),O(()=>a(w).id)))??"")}),le(d,m)});var Tl=k(Rr,2),Cr=k(zr,2),Pr=y(Cr),Rl=k(y(Pr)),Lr=k(Pr,2),Il=k(y(Lr)),Nr=k(Lr,2),Cl=k(y(Nr)),Pl=k(Nr,2),Ll=k(y(Pl)),Mr=k(Cr,2),qr=y(Mr),Nl=k(y(qr)),Ml=k(qr,2),ql=k(y(Ml)),Or=k(Mr,2),jr=y(Or),Dr=k(y(jr));ee(()=>{a(T),at(()=>{})});var zn=y(Dr);zn.value=zn.__value="Georgia, Times New Roman, serif";var Tn=k(zn);Tn.value=Tn.__value="Helvetica, Arial, sans-serif";var Br=k(Tn);Br.value=Br.__value="Courier, monospace";var Fr=k(jr,2),Ol=k(y(Fr)),Hr=k(Fr,2),jl=k(y(Hr)),Ur=k(Hr,2),Zr=k(Ur,2),Gr=k(Zr,2),Wr=y(Gr);ee(()=>{a($),at(()=>{})});var Rn=y(Wr);Rn.value=Rn.__value="left";var Qr=k(Rn);Qr.value=Qr.__value="justify";var Dl=k(Gr,2),Vr=y(Dl);ee(()=>{a(A),at(()=>{})});var In=y(Vr);In.value=In.__value="none";var Yr=k(In);Yr.value=Yr.__value="auto";var Xr=k(Or,2),Jr=y(Xr),Kr=k(Jr,2),ei=k(Kr,2),ti=k(ei,2),ni=k(ti,2),ri=k(ni,2),ii=k(ri,2),si=k(ii,2);At(si,1,()=>(a(S),O(()=>Array(a(S)))),Et,(d,w,m)=>{var z=Vu();z.textContent=`${m+1} col`,W("click",z,()=>dl(m+1)),le(d,z)});var li=k(si,2),ai=k(li,2),Bl=k(ai,2),oi=k(Xr,2),ui=y(oi),ci=k(ui,2),fi=k(ci,2),pi=k(fi,2),hi=y(pi),di=k(y(hi));ee(()=>{a(P),at(()=>{})});var Cn=y(di);Cn.value=Cn.__value="pages";var gi=k(Cn);gi.value=gi.__value="spreads";var Fl=k(hi,2);{var Hl=d=>{var w=Yu(),m=Xt(w),z=k(y(m)),R=k(m,2),C=k(y(R));ee(()=>{a(re),at(()=>{})});var Y=y(C);Y.value=Y.__value="sequential";var G=k(Y);G.value=G.__value="booklet",ge(z,()=>a(N),K=>x(N,K)),ft(C,()=>a(re),K=>x(re,K)),le(d,w)};De(Fl,d=>{a(P)==="spreads"&&d(Hl)})}var Ul=k(pi,2),Zl=k(oi,2),_i=y(Zl),vi=k(_i,2),Gl=k(vi,2),Wl=y(Gl),mi=k(Ar,2),Zt=y(mi),Ql=y(Zt),bi=y(Ql),Vl=k(y(bi),2),Yl=y(Vl),Gt=k(bi,2);Bi(Gt,d=>x(Qe,d),()=>a(Qe));var Xl=k(Gt,2),Jl=y(Xl),ki=k(Zt,2),Kl=k(ki,2),Wt=y(Kl),ea=y(Wt);zt(ea,()=>a(Re)),Bi(Wt,d=>x(de,d),()=>a(de));var wi=k(Wt,2),xi=y(wi),ta=y(xi);At(ta,5,()=>a(fe),Et,(d,w,m)=>{var z=Xu(),R=y(z),C=y(R),Y=k(R,2);let G;var K=y(Y);zt(K,()=>a(w));var xe=k(Y,2),ye=y(xe),se=k(xe,2);ct(se,1,`page-number ${m%2===0?"rig":"lef"}`),se.textContent=m+1,ee(Ie=>{Ve(z,a(u)),ce(C,(a(V),O(()=>a(V)[m]||""))),G=ct(Y,1,"page-inner preview",null,G,Ie),Ve(Y,a(c)),ce(ye,(a(ie),O(()=>a(ie)[m]||"")))},[()=>({fullpage:a(w).includes("img-page")})]),le(d,z)});var na=k(wi,2),ra=y(na);{var ia=d=>{var w=Oi(),m=Xt(w);At(m,1,()=>a(fe),Et,(z,R,C)=>{var Y=Ju(),G=y(Y),K=y(G),xe=k(G,2);let ye;var se=y(xe);zt(se,()=>a(R));var Ie=k(xe,2),Qt=y(Ie),St=k(Ie,2);ct(St,1,`print-page-number ${C%2===0?"rig":"lef"}`),St.textContent=C+1,ee(Pn=>{ce(K,(a(V),O(()=>a(V)[C]||""))),ye=ct(xe,1,"print-inner",null,ye,Pn),ce(Qt,(a(ie),O(()=>a(ie)[C]||"")))},[()=>({fullpage:a(R).includes("img-page")})]),le(z,Y)}),le(d,w)},sa=d=>{var w=Oi(),m=Xt(w);At(m,1,()=>a(be),Et,(z,R,C)=>{var Y=Ku(),G=y(Y),K=y(G),xe=y(K);{var ye=Z=>{var J=ot();ee(()=>ce(J,(a(V),a(I),O(()=>a(V)[a(I)[C][0]]||"")))),le(Z,J)};De(xe,Z=>{a(I),O(()=>a(I)[C][0]!=null)&&Z(ye)})}var se=k(K,2);let Ie;var Qt=y(se);zt(Qt,()=>(a(R),O(()=>a(R)[0]||"")));var St=k(se,2),Pn=y(St);{var la=Z=>{var J=ot();ee(()=>ce(J,(a(ie),a(I),O(()=>a(ie)[a(I)[C][0]]||"")))),le(Z,J)};De(Pn,Z=>{a(I),O(()=>a(I)[C][0]!=null)&&Z(la)})}var aa=k(St,2),oa=y(aa);{var ua=Z=>{var J=ot();ee(()=>ce(J,(a(I),O(()=>a(I)[C][0]+1)))),le(Z,J)};De(oa,Z=>{a(I),O(()=>a(I)[C][0]!=null)&&Z(ua)})}var ca=k(G,4),yi=y(ca),fa=y(yi);{var pa=Z=>{var J=ot();ee(()=>ce(J,(a(V),a(I),O(()=>a(V)[a(I)[C][1]]||"")))),le(Z,J)};De(fa,Z=>{a(I),O(()=>a(I)[C][1]!=null)&&Z(pa)})}var Vt=k(yi,2);let Si;var ha=y(Vt);zt(ha,()=>(a(R),O(()=>a(R)[1]||"")));var $i=k(Vt,2),da=y($i);{var ga=Z=>{var J=ot();ee(()=>ce(J,(a(ie),a(I),O(()=>a(ie)[a(I)[C][1]]||"")))),le(Z,J)};De(da,Z=>{a(I),O(()=>a(I)[C][1]!=null)&&Z(ga)})}var _a=k($i,2),va=y(_a);{var ma=Z=>{var J=ot();ee(()=>ce(J,(a(I),O(()=>a(I)[C][1]+1)))),le(Z,J)};De(va,Z=>{a(I),O(()=>a(I)[C][1]!=null)&&Z(ma)})}ee((Z,J)=>{Ie=ct(se,1,"print-inner",null,Ie,Z),Ve(se,a(c)),Si=ct(Vt,1,"print-inner",null,Si,J),Ve(Vt,a(c))},[()=>({fullpage:(a(R)[0]||"").includes("img-page")}),()=>({fullpage:(a(R)[1]||"").includes("img-page")})]),le(z,Y)}),le(d,w)};De(ra,d=>{a(P)==="pages"?d(ia):d(sa,!1)})}ee(d=>{ce(Wl,`${d??""}%`),Ve(mi,`grid-template-columns:${a(we)}% 8px ${100-a(we)}%`),ce(Yl,`${a(fe),O(()=>a(fe).length)??""} pages · ${a(S)??""} col`),ce(Jl,a(Ge)),Ve(Wt,a(f)),Ve(xi,`transform:scale(${a(n)}); transform-origin: top left;`)},[()=>(a(X),O(()=>Math.round(a(X))))]),ge(zl,()=>a(v),d=>x(v,d)),ft(Ir,()=>a(p),d=>x(p,d)),W("click",Tl,()=>{x(_,{...pt[a(p)].margins})}),ge(Rl,()=>a(_).top,d=>Yt(_,a(_).top=d)),ge(Il,()=>a(_).right,d=>Yt(_,a(_).right=d)),ge(Cl,()=>a(_).bottom,d=>Yt(_,a(_).bottom=d)),ge(Ll,()=>a(_).left,d=>Yt(_,a(_).left=d)),ge(Nl,()=>a(S),d=>x(S,d)),ge(ql,()=>a(E),d=>x(E,d)),ft(Dr,()=>a(T),d=>x(T,d)),ge(Ol,()=>a(B),d=>x(B,d)),ge(jl,()=>a(L),d=>x(L,d)),W("click",Ur,El),W("click",Zr,Al),ft(Wr,()=>a($),d=>x($,d)),ft(Vr,()=>a(A),d=>x(A,d)),W("click",Jr,ml),W("click",Kr,bl),W("change",ei,d=>kr(d,!1)),W("change",ti,d=>kr(d,!0)),W("click",ni,()=>document.getElementById("image_input").click()),W("click",ri,()=>document.getElementById("image_input_full").click()),W("click",ii,()=>hl("span-all")),W("click",li,vl),W("click",ai,gl),W("click",Bl,_l),W("click",ui,pl),W("change",ci,ol),W("click",fi,()=>document.getElementById("import_book").click()),ft(di,()=>a(P),d=>x(P,d)),W("click",Ul,yl),ge(_i,()=>a(X),d=>x(X,d)),W("click",vi,()=>x(X,100)),ge(Gt,()=>a(b),d=>x(b,d)),W("paste",Gt,xl),W("dragover",Zt,To(wl)),W("drop",Zt,kl),W("mousedown",ki,Sl),le(e,Er),is()}wo(tc,{target:document.getElementById("app")});
