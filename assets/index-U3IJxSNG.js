(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();const ii=!1;var kn=Array.isArray,As=Array.prototype.indexOf,Yn=Array.from,jn=Object.defineProperty,mt=Object.getOwnPropertyDescriptor,Ts=Object.getOwnPropertyDescriptors,Rs=Object.prototype,Is=Array.prototype,si=Object.getPrototypeOf,Nr=Object.isExtensible;function $s(e){return e()}function on(e){for(var t=0;t<e.length;t++)e[t]()}function Ps(){var e,t,n=new Promise((i,r)=>{e=i,t=r});return{promise:n,resolve:e,reject:t}}const ge=2,Xn=4,wn=8,Vt=16,Me=32,nt=64,ai=128,be=256,un=512,le=1024,ke=2048,Oe=4096,we=8192,rt=16384,Jn=32768,Kn=65536,Mr=1<<17,Cs=1<<18,er=1<<19,tr=1<<20,Bn=1<<21,nr=1<<22,Ye=1<<23,Ce=Symbol("$state"),Ls=Symbol("legacy props"),rr=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Ns(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function li(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Ms(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Os(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function qs(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Ds(e){throw new Error("https://svelte.dev/e/effect_orphan")}function js(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Bs(e){throw new Error("https://svelte.dev/e/props_invalid_value")}function Fs(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Us(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Hs(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const xn=1,yn=2,oi=4,Zs=8,Gs=16,Ws=1,Qs=2,Vs=4,Ys=8,Xs=16,Js=1,Ks=2,ae=Symbol();function ea(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}let ta=!1;function ui(e){return e===this.v}function na(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function ci(e){return!na(e,this.v)}let At=!1,ra=!1;function ia(){At=!0}let K=null;function cn(e){K=e}function Tt(e,t=!1,n){K={p:K,c:null,e:null,s:e,x:null,l:At&&!t?{s:null,u:null,$:[]}:null}}function Rt(e){var t=K,n=t.e;if(n!==null){t.e=null;for(var i of n)zi(i)}return K=t.p,{}}function It(){return!At||K!==null&&K.l===null}const sa=new WeakMap;function aa(e){var t=M;if(t===null)return O.f|=Ye,e;if((t.f&Jn)===0){if((t.f&ai)===0)throw!t.parent&&e instanceof Error&&fi(e),e;t.b.error(e)}else ir(e,t)}function ir(e,t){for(;t!==null;){if((t.f&ai)!==0)try{t.b.error(e);return}catch(n){e=n}t=t.parent}throw e instanceof Error&&fi(e),e}function fi(e){const t=sa.get(e);t&&(jn(e,"message",{value:t.message}),jn(e,"stack",{value:t.stack}))}let Ut=[],Fn=[];function pi(){var e=Ut;Ut=[],on(e)}function la(){var e=Fn;Fn=[],on(e)}function sr(e){Ut.length===0&&queueMicrotask(pi),Ut.push(e)}function oa(){Ut.length>0&&pi(),Fn.length>0&&la()}function ua(){for(var e=M.b;e!==null&&!e.has_pending_snippet();)e=e.parent;return e===null&&Ns(),e}function Sn(e){var t=ge|ke,n=O!==null&&(O.f&ge)!==0?O:null;return M===null||n!==null&&(n.f&be)!==0?t|=be:M.f|=er,{ctx:K,deps:null,effects:null,equals:ui,f:t,fn:e,reactions:null,rv:0,v:ae,wv:0,parent:n??M,ac:null}}function ca(e,t){let n=M;n===null&&Ms();var i=n.b,r=void 0,s=Ht(ae),a=null,l=!O;return Sa(()=>{try{var u=e()}catch(g){u=Promise.reject(g)}var c=()=>u;r=a?.then(c,c)??Promise.resolve(u),a=r;var f=W,h=i.pending;l&&(i.update_pending_count(1),h||f.increment());const d=(g,p=void 0)=>{a=null,h||f.activate(),p?p!==rr&&(s.f|=Ye,zt(s,p)):((s.f&Ye)!==0&&(s.f^=Ye),zt(s,g)),l&&(i.update_pending_count(-1),h||f.decrement()),gi()};if(r.then(d,g=>d(null,g||"unknown")),f)return()=>{queueMicrotask(()=>f.neuter())}}),new Promise(u=>{function c(f){function h(){f===r?u(s):c(r)}f.then(h,h)}c(r)})}function ar(e){const t=Sn(e);return t.equals=ci,t}function hi(e){var t=e.effects;if(t!==null){e.effects=null;for(var n=0;n<t.length;n+=1)Ne(t[n])}}function fa(e){for(var t=e.parent;t!==null;){if((t.f&ge)===0)return t;t=t.parent}return null}function lr(e){var t,n=M;He(fa(e));try{hi(e),t=qi(e)}finally{He(n)}return t}function di(e){var t=lr(e);if(e.equals(t)||(e.v=t,e.wv=Mi()),!it)if(St!==null)St.set(e,e.v);else{var n=(Fe||(e.f&be)!==0)&&e.deps!==null?Oe:le;fe(e,n)}}function pa(e,t,n){const i=It()?Sn:ar;if(t.length===0){n(e.map(i));return}var r=W,s=M,a=ha(),l=ua();Promise.all(t.map(u=>ca(u))).then(u=>{r?.activate(),a();try{n([...e.map(i),...u])}catch(c){(s.f&rt)===0&&ir(c,s)}r?.deactivate(),gi()}).catch(u=>{l.error(u)})}function ha(){var e=M,t=O,n=K;return function(){He(e),ze(t),cn(n)}}function gi(){He(null),ze(null),cn(null)}const Nt=new Set;let W=null,sn=null,St=null,Or=new Set,fn=[];function _i(){const e=fn.shift();fn.length>0&&queueMicrotask(_i),e()}let Ke=[],En=null,Un=!1,an=!1;class Et{current=new Map;#i=new Map;#s=new Set;#e=0;#u=null;#c=!1;#n=[];#a=[];#r=[];#t=[];#l=[];#f=[];#p=[];skipped_effects=new Set;process(t){Ke=[],sn=null;var n=null;if(Nt.size>1){n=new Map,St=new Map;for(const[s,a]of this.current)n.set(s,{v:s.v,wv:s.wv}),s.v=a;for(const s of Nt)if(s!==this)for(const[a,l]of s.#i)n.has(a)||(n.set(a,{v:a.v,wv:a.wv}),a.v=l)}for(const s of t)this.#d(s);if(this.#n.length===0&&this.#e===0){this.#h();var i=this.#r,r=this.#t;this.#r=[],this.#t=[],this.#l=[],sn=W,W=null,qr(i),qr(r),W===null?W=this:Nt.delete(this),this.#u?.resolve()}else this.#o(this.#r),this.#o(this.#t),this.#o(this.#l);if(n){for(const[s,{v:a,wv:l}]of n)s.wv<=l&&(s.v=a);St=null}for(const s of this.#n)wt(s);for(const s of this.#a)wt(s);this.#n=[],this.#a=[]}#d(t){t.f^=le;for(var n=t.first;n!==null;){var i=n.f,r=(i&(Me|nt))!==0,s=r&&(i&le)!==0,a=s||(i&we)!==0||this.skipped_effects.has(n);if(!a&&n.fn!==null){if(r)n.f^=le;else if((i&le)===0)if((i&Xn)!==0)this.#t.push(n);else if((i&nr)!==0){var l=n.b?.pending?this.#a:this.#n;l.push(n)}else Yt(n)&&((n.f&Vt)!==0&&this.#l.push(n),wt(n));var u=n.first;if(u!==null){n=u;continue}}var c=n.parent;for(n=n.next;n===null&&c!==null;)n=c.next,c=c.parent}}#o(t){for(const n of t)((n.f&ke)!==0?this.#f:this.#p).push(n),fe(n,le);t.length=0}capture(t,n){this.#i.has(t)||this.#i.set(t,n),this.current.set(t,t.v)}activate(){W=this}deactivate(){W=null,sn=null;for(const t of Or)if(Or.delete(t),t(),W!==null)break}neuter(){this.#c=!0}flush(){Ke.length>0?vi():this.#h(),W===this&&(this.#e===0&&Nt.delete(this),this.deactivate())}#h(){if(!this.#c)for(const t of this.#s)t();this.#s.clear()}increment(){this.#e+=1}decrement(){if(this.#e-=1,this.#e===0){for(const t of this.#f)fe(t,ke),et(t);for(const t of this.#p)fe(t,Oe),et(t);this.#r=[],this.#t=[],this.flush()}else this.deactivate()}add_callback(t){this.#s.add(t)}settled(){return(this.#u??=Ps()).promise}static ensure(){if(W===null){const t=W=new Et;Nt.add(W),an||Et.enqueue(()=>{W===t&&t.flush()})}return W}static enqueue(t){fn.length===0&&queueMicrotask(_i),fn.unshift(t)}}function da(e){var t=an;an=!0;try{for(var n;;){if(oa(),Ke.length===0&&(W?.flush(),Ke.length===0))return En=null,n;vi()}}finally{an=t}}function vi(){var e=kt;Un=!0;try{var t=0;for(Fr(!0);Ke.length>0;){var n=Et.ensure();if(t++>1e3){var i,r;ga()}n.process(Ke),Xe.clear()}}finally{Un=!1,Fr(e),En=null}}function ga(){try{js()}catch(e){ir(e,En)}}function qr(e){var t=e.length;if(t!==0){for(var n=0;n<t;){var i=e[n++];if((i.f&(rt|we))===0&&Yt(i)){var r=W?W.current.size:0;if(wt(i),i.deps===null&&i.first===null&&i.nodes_start===null&&(i.teardown===null&&i.ac===null?Pi(i):i.fn=null),W!==null&&W.current.size>r&&(i.f&tr)!==0)break}}for(;n<t;)et(e[n++])}}function et(e){for(var t=En=e;t.parent!==null;){t=t.parent;var n=t.f;if(Un&&t===M&&(n&Vt)!==0)return;if((n&(nt|Me))!==0){if((n&le)===0)return;t.f^=le}}Ke.push(t)}const Xe=new Map;function Ht(e,t){var n={f:0,v:e,reactions:null,equals:ui,rv:0,wv:0};return n}function De(e,t){const n=Ht(e);return Aa(n),n}function L(e,t=!1,n=!0){const i=Ht(e);return t||(i.equals=ci),At&&n&&K!==null&&K.l!==null&&(K.l.s??=[]).push(i),i}function z(e,t,n=!1){O!==null&&(!Ee||(O.f&Mr)!==0)&&It()&&(O.f&(ge|Vt|nr|Mr))!==0&&!Le?.includes(e)&&Hs();let i=n?_t(t):t;return zt(e,i)}function zt(e,t){if(!e.equals(t)){var n=e.v;it?Xe.set(e,t):Xe.set(e,n),e.v=t;var i=Et.ensure();i.capture(e,n),(e.f&ge)!==0&&((e.f&ke)!==0&&lr(e),fe(e,(e.f&be)===0?le:Oe)),e.wv=Mi(),mi(e,ke),It()&&M!==null&&(M.f&le)!==0&&(M.f&(Me|nt))===0&&(ve===null?Ta([e]):ve.push(e))}return t}function Mn(e){z(e,e.v+1)}function mi(e,t){var n=e.reactions;if(n!==null)for(var i=It(),r=n.length,s=0;s<r;s++){var a=n[s],l=a.f;if(!(!i&&a===M)){var u=(l&ke)===0;u&&fe(a,t),(l&ge)!==0?mi(a,Oe):u&&et(a)}}}function _t(e){if(typeof e!="object"||e===null||Ce in e)return e;const t=si(e);if(t!==Rs&&t!==Is)return e;var n=new Map,i=kn(e),r=De(0),s=Je,a=l=>{if(Je===s)return l();var u=O,c=Je;ze(null),Hr(s);var f=l();return ze(u),Hr(c),f};return i&&n.set("length",De(e.length)),new Proxy(e,{defineProperty(l,u,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&Fs();var f=n.get(u);return f===void 0?f=a(()=>{var h=De(c.value);return n.set(u,h),h}):z(f,c.value,!0),!0},deleteProperty(l,u){var c=n.get(u);if(c===void 0){if(u in l){const f=a(()=>De(ae));n.set(u,f),Mn(r)}}else z(c,ae),Mn(r);return!0},get(l,u,c){if(u===Ce)return e;var f=n.get(u),h=u in l;if(f===void 0&&(!h||mt(l,u)?.writable)&&(f=a(()=>{var g=_t(h?l[u]:ae),p=De(g);return p}),n.set(u,f)),f!==void 0){var d=o(f);return d===ae?void 0:d}return Reflect.get(l,u,c)},getOwnPropertyDescriptor(l,u){var c=Reflect.getOwnPropertyDescriptor(l,u);if(c&&"value"in c){var f=n.get(u);f&&(c.value=o(f))}else if(c===void 0){var h=n.get(u),d=h?.v;if(h!==void 0&&d!==ae)return{enumerable:!0,configurable:!0,value:d,writable:!0}}return c},has(l,u){if(u===Ce)return!0;var c=n.get(u),f=c!==void 0&&c.v!==ae||Reflect.has(l,u);if(c!==void 0||M!==null&&(!f||mt(l,u)?.writable)){c===void 0&&(c=a(()=>{var d=f?_t(l[u]):ae,g=De(d);return g}),n.set(u,c));var h=o(c);if(h===ae)return!1}return f},set(l,u,c,f){var h=n.get(u),d=u in l;if(i&&u==="length")for(var g=c;g<h.v;g+=1){var p=n.get(g+"");p!==void 0?z(p,ae):g in l&&(p=a(()=>De(ae)),n.set(g+"",p))}if(h===void 0)(!d||mt(l,u)?.writable)&&(h=a(()=>De(void 0)),z(h,_t(c)),n.set(u,h));else{d=h.v!==ae;var _=a(()=>_t(c));z(h,_)}var m=Reflect.getOwnPropertyDescriptor(l,u);if(m?.set&&m.set.call(f,c),!d){if(i&&typeof u=="string"){var b=n.get("length"),v=Number(u);Number.isInteger(v)&&v>=b.v&&z(b,v+1)}Mn(r)}return!0},ownKeys(l){o(r);var u=Reflect.ownKeys(l).filter(h=>{var d=n.get(h);return d===void 0||d.v!==ae});for(var[c,f]of n)f.v!==ae&&!(c in l)&&u.push(c);return u},setPrototypeOf(){Us()}})}function Dr(e){try{if(e!==null&&typeof e=="object"&&Ce in e)return e[Ce]}catch{}return e}function _a(e,t){return Object.is(Dr(e),Dr(t))}var jr,bi,ki,wi;function va(){if(jr===void 0){jr=window,bi=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;ki=mt(t,"firstChild").get,wi=mt(t,"nextSibling").get,Nr(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),Nr(n)&&(n.__t=void 0)}}function $t(e=""){return document.createTextNode(e)}function Be(e){return ki.call(e)}function zn(e){return wi.call(e)}function E(e,t){return Be(e)}function Zt(e,t){{var n=Be(e);return n instanceof Comment&&n.data===""?zn(n):n}}function w(e,t=1,n=!1){let i=e;for(;t--;)i=zn(i);return i}function ma(e){e.textContent=""}function xi(){return!1}let Br=!1;function ba(){Br||(Br=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function An(e){var t=O,n=M;ze(null),He(null);try{return e()}finally{ze(t),He(n)}}function yi(e,t,n,i=n){e.addEventListener(t,()=>An(n));const r=e.__on_r;r?e.__on_r=()=>{r(),i(!0)}:e.__on_r=()=>i(!0),ba()}function Si(e){M===null&&O===null&&Ds(),O!==null&&(O.f&be)!==0&&M===null&&qs(),it&&Os()}function ka(e,t){var n=t.last;n===null?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}function Te(e,t,n,i=!0){var r=M;r!==null&&(r.f&we)!==0&&(e|=we);var s={ctx:K,deps:null,nodes_start:null,nodes_end:null,f:e|ke,first:null,fn:t,last:null,next:null,parent:r,b:r&&r.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(n)try{wt(s),s.f|=Jn}catch(u){throw Ne(s),u}else t!==null&&et(s);var a=n&&s.deps===null&&s.first===null&&s.nodes_start===null&&s.teardown===null&&(s.f&er)===0;if(!a&&i&&(r!==null&&ka(s,r),O!==null&&(O.f&ge)!==0&&(e&nt)===0)){var l=O;(l.effects??=[]).push(s)}return s}function Ei(e){const t=Te(wn,null,!1);return fe(t,le),t.teardown=e,t}function Hn(e){Si();var t=M.f,n=!O&&(t&Me)!==0&&(t&Jn)===0;if(n){var i=K;(i.e??=[]).push(e)}else return zi(e)}function zi(e){return Te(Xn|tr,e,!1)}function wa(e){return Si(),Te(wn|tr,e,!0)}function xa(e){Et.ensure();const t=Te(nt,e,!0);return(n={})=>new Promise(i=>{n.outro?or(t,()=>{Ne(t),i(void 0)}):(Ne(t),i(void 0))})}function Ai(e){return Te(Xn,e,!1)}function G(e,t){var n=K,i={effect:null,ran:!1,deps:e};n.l.$.push(i),i.effect=Tn(()=>{e(),!i.ran&&(i.ran=!0,q(t))})}function ya(){var e=K;Tn(()=>{for(var t of e.l.$){t.deps();var n=t.effect;(n.f&le)!==0&&fe(n,Oe),Yt(n)&&wt(n),t.ran=!1}})}function Sa(e){return Te(nr|er,e,!0)}function Tn(e,t=0){return Te(wn|t,e,!0)}function re(e,t=[],n=[]){pa(t,n,i=>{Te(wn,()=>e(...i.map(o)),!0)})}function Ti(e,t=0){var n=Te(Vt|t,e,!0);return n}function Gt(e,t=!0){return Te(Me,e,!0,t)}function Ri(e){var t=e.teardown;if(t!==null){const n=it,i=O;Ur(!0),ze(null);try{t.call(null)}finally{Ur(n),ze(i)}}}function Ii(e,t=!1){var n=e.first;for(e.first=e.last=null;n!==null;){const r=n.ac;r!==null&&An(()=>{r.abort(rr)});var i=n.next;(n.f&nt)!==0?n.parent=null:Ne(n,t),n=i}}function Ea(e){for(var t=e.first;t!==null;){var n=t.next;(t.f&Me)===0&&Ne(t),t=n}}function Ne(e,t=!0){var n=!1;(t||(e.f&Cs)!==0)&&e.nodes_start!==null&&e.nodes_end!==null&&($i(e.nodes_start,e.nodes_end),n=!0),Ii(e,t&&!n),pn(e,0),fe(e,rt);var i=e.transitions;if(i!==null)for(const s of i)s.stop();Ri(e);var r=e.parent;r!==null&&r.first!==null&&Pi(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=e.ac=null}function $i(e,t){for(;e!==null;){var n=e===t?null:zn(e);e.remove(),e=n}}function Pi(e){var t=e.parent,n=e.prev,i=e.next;n!==null&&(n.next=i),i!==null&&(i.prev=n),t!==null&&(t.first===e&&(t.first=i),t.last===e&&(t.last=n))}function or(e,t){var n=[];ur(e,n,!0),Ci(n,()=>{Ne(e),t&&t()})}function Ci(e,t){var n=e.length;if(n>0){var i=()=>--n||t();for(var r of e)r.out(i)}else t()}function ur(e,t,n){if((e.f&we)===0){if(e.f^=we,e.transitions!==null)for(const a of e.transitions)(a.is_global||n)&&t.push(a);for(var i=e.first;i!==null;){var r=i.next,s=(i.f&Kn)!==0||(i.f&Me)!==0;ur(i,t,s?n:!1),i=r}}}function cr(e){Li(e,!0)}function Li(e,t){if((e.f&we)!==0){e.f^=we,(e.f&le)===0&&(fe(e,ke),et(e));for(var n=e.first;n!==null;){var i=n.next,r=(n.f&Kn)!==0||(n.f&Me)!==0;Li(n,r?t:!1),n=i}if(e.transitions!==null)for(const s of e.transitions)(s.is_global||t)&&s.in()}}let gt=null;function za(e){var t=gt;try{if(gt=new Set,q(e),t!==null)for(var n of gt)t.add(n);return gt}finally{gt=t}}function bt(e){for(var t of za(e))zt(t,t.v)}let kt=!1;function Fr(e){kt=e}let it=!1;function Ur(e){it=e}let O=null,Ee=!1;function ze(e){O=e}let M=null;function He(e){M=e}let Le=null;function Aa(e){O!==null&&(Le===null?Le=[e]:Le.push(e))}let ue=null,de=0,ve=null;function Ta(e){ve=e}let Ni=1,Wt=0,Je=Wt;function Hr(e){Je=e}let Fe=!1;function Mi(){return++Ni}function Yt(e){var t=e.f;if((t&ke)!==0)return!0;if((t&Oe)!==0){var n=e.deps,i=(t&be)!==0;if(n!==null){var r,s,a=(t&un)!==0,l=i&&M!==null&&!Fe,u=n.length;if((a||l)&&(M===null||(M.f&rt)===0)){var c=e,f=c.parent;for(r=0;r<u;r++)s=n[r],(a||!s?.reactions?.includes(c))&&(s.reactions??=[]).push(c);a&&(c.f^=un),l&&f!==null&&(f.f&be)===0&&(c.f^=be)}for(r=0;r<u;r++)if(s=n[r],Yt(s)&&di(s),s.wv>e.wv)return!0}(!i||M!==null&&!Fe)&&fe(e,le)}return!1}function Oi(e,t,n=!0){var i=e.reactions;if(i!==null&&!Le?.includes(e))for(var r=0;r<i.length;r++){var s=i[r];(s.f&ge)!==0?Oi(s,t,!1):t===s&&(n?fe(s,ke):(s.f&le)!==0&&fe(s,Oe),et(s))}}function qi(e){var t=ue,n=de,i=ve,r=O,s=Fe,a=Le,l=K,u=Ee,c=Je,f=e.f;ue=null,de=0,ve=null,Fe=(f&be)!==0&&(Ee||!kt||O===null),O=(f&(Me|nt))===0?e:null,Le=null,cn(e.ctx),Ee=!1,Je=++Wt,e.ac!==null&&(An(()=>{e.ac.abort(rr)}),e.ac=null);try{e.f|=Bn;var h=e.fn,d=h(),g=e.deps;if(ue!==null){var p;if(pn(e,de),g!==null&&de>0)for(g.length=de+ue.length,p=0;p<ue.length;p++)g[de+p]=ue[p];else e.deps=g=ue;if(!Fe||(f&ge)!==0&&e.reactions!==null)for(p=de;p<g.length;p++)(g[p].reactions??=[]).push(e)}else g!==null&&de<g.length&&(pn(e,de),g.length=de);if(It()&&ve!==null&&!Ee&&g!==null&&(e.f&(ge|Oe|ke))===0)for(p=0;p<ve.length;p++)Oi(ve[p],e);return r!==null&&r!==e&&(Wt++,ve!==null&&(i===null?i=ve:i.push(...ve))),(e.f&Ye)!==0&&(e.f^=Ye),d}catch(_){return aa(_)}finally{e.f^=Bn,ue=t,de=n,ve=i,O=r,Fe=s,Le=a,cn(l),Ee=u,Je=c}}function Ra(e,t){let n=t.reactions;if(n!==null){var i=As.call(n,e);if(i!==-1){var r=n.length-1;r===0?n=t.reactions=null:(n[i]=n[r],n.pop())}}n===null&&(t.f&ge)!==0&&(ue===null||!ue.includes(t))&&(fe(t,Oe),(t.f&(be|un))===0&&(t.f^=un),hi(t),pn(t,0))}function pn(e,t){var n=e.deps;if(n!==null)for(var i=t;i<n.length;i++)Ra(e,n[i])}function wt(e){var t=e.f;if((t&rt)===0){fe(e,le);var n=M,i=kt;M=e,kt=!0;try{(t&Vt)!==0?Ea(e):Ii(e),Ri(e);var r=qi(e);e.teardown=typeof r=="function"?r:null,e.wv=Ni;var s;ii&&ra&&(e.f&ke)!==0&&e.deps}finally{kt=i,M=n}}}async function qt(){await Promise.resolve(),da()}function o(e){var t=e.f,n=(t&ge)!==0;if(gt?.add(e),O!==null&&!Ee){var i=M!==null&&(M.f&rt)!==0;if(!i&&!Le?.includes(e)){var r=O.deps;if((O.f&Bn)!==0)e.rv<Wt&&(e.rv=Wt,ue===null&&r!==null&&r[de]===e?de++:ue===null?ue=[e]:(!Fe||!ue.includes(e))&&ue.push(e));else{(O.deps??=[]).push(e);var s=e.reactions;s===null?e.reactions=[O]:s.includes(O)||s.push(O)}}}else if(n&&e.deps===null&&e.effects===null){var a=e,l=a.parent;l!==null&&(l.f&be)===0&&(a.f^=be)}if(it){if(Xe.has(e))return Xe.get(e);if(n){a=e;var u=a.v;return((a.f&le)===0&&a.reactions!==null||Di(a))&&(u=lr(a)),Xe.set(a,u),u}}else if(n){if(a=e,St?.has(a))return St.get(a);Yt(a)&&di(a)}if((e.f&Ye)!==0)throw e.v;return e.v}function Di(e){if(e.v===ae)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(Xe.has(t)||(t.f&ge)!==0&&Di(t))return!0;return!1}function q(e){var t=Ee;try{return Ee=!0,e()}finally{Ee=t}}const Ia=-7169;function fe(e,t){e.f=e.f&Ia|t}function J(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(Ce in e)Zn(e);else if(!Array.isArray(e))for(let t in e){const n=e[t];typeof n=="object"&&n&&Ce in n&&Zn(n)}}}function Zn(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let i in e)try{Zn(e[i],t)}catch{}const n=si(e);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const i=Ts(n);for(let r in i){const s=i[r].get;if(s)try{s.call(e)}catch{}}}}}const $a=["touchstart","touchmove"];function Pa(e){return $a.includes(e)}const Ca=new Set,Zr=new Set;function La(e,t,n,i={}){function r(s){if(i.capture||Dt.call(t,s),!s.cancelBubble)return An(()=>n?.call(this,s))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?sr(()=>{t.addEventListener(e,r,i)}):t.addEventListener(e,r,i),r}function te(e,t,n,i,r){var s={capture:i,passive:r},a=La(e,t,n,s);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&Ei(()=>{t.removeEventListener(e,a,s)})}let Gr=null;function Dt(e){var t=this,n=t.ownerDocument,i=e.type,r=e.composedPath?.()||[],s=r[0]||e.target;Gr=e;var a=0,l=Gr===e&&e.__root;if(l){var u=r.indexOf(l);if(u!==-1&&(t===document||t===window)){e.__root=t;return}var c=r.indexOf(t);if(c===-1)return;u<=c&&(a=u)}if(s=r[a]||e.target,s!==t){jn(e,"currentTarget",{configurable:!0,get(){return s||n}});var f=O,h=M;ze(null),He(null);try{for(var d,g=[];s!==null;){var p=s.assignedSlot||s.parentNode||s.host||null;try{var _=s["__"+i];if(_!=null&&(!s.disabled||e.target===s))if(kn(_)){var[m,...b]=_;m.apply(s,[e,...b])}else _.call(s,e)}catch(v){d?g.push(v):d=v}if(e.cancelBubble||p===t||p===null)break;s=p}if(d){for(let v of g)queueMicrotask(()=>{throw v});throw d}}finally{e.__root=t,delete e.currentTarget,ze(f),He(h)}}}function ji(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function Qt(e,t){var n=M;n.nodes_start===null&&(n.nodes_start=e,n.nodes_end=t)}function _e(e,t){var n=(t&Js)!==0,i=(t&Ks)!==0,r,s=!e.startsWith("<!>");return()=>{r===void 0&&(r=ji(s?e:"<!>"+e),n||(r=Be(r)));var a=i||bi?document.importNode(r,!0):r.cloneNode(!0);if(n){var l=Be(a),u=a.lastChild;Qt(l,u)}else Qt(a,a);return a}}function ht(e=""){{var t=$t(e+"");return Qt(t,t),t}}function Wr(){var e=document.createDocumentFragment(),t=document.createComment(""),n=$t();return e.append(t,n),Qt(t,n),e}function ne(e,t){e!==null&&e.before(t)}function he(e,t){var n=t==null?"":typeof t=="object"?t+"":t;n!==(e.__t??=e.nodeValue)&&(e.__t=n,e.nodeValue=n+"")}function Na(e,t){return Ma(e,t)}const dt=new Map;function Ma(e,{target:t,anchor:n,props:i={},events:r,context:s,intro:a=!0}){va();var l=new Set,u=h=>{for(var d=0;d<h.length;d++){var g=h[d];if(!l.has(g)){l.add(g);var p=Pa(g);t.addEventListener(g,Dt,{passive:p});var _=dt.get(g);_===void 0?(document.addEventListener(g,Dt,{passive:p}),dt.set(g,1)):dt.set(g,_+1)}}};u(Yn(Ca)),Zr.add(u);var c=void 0,f=xa(()=>{var h=n??t.appendChild($t());return Gt(()=>{if(s){Tt({});var d=K;d.c=s}r&&(i.$$events=r),c=e(h,i)||{},s&&Rt()}),()=>{for(var d of l){t.removeEventListener(d,Dt);var g=dt.get(d);--g===0?(document.removeEventListener(d,Dt),dt.delete(d)):dt.set(d,g)}Zr.delete(u),h!==n&&h.parentNode?.removeChild(h)}});return Oa.set(c,f),c}let Oa=new WeakMap;function je(e,t,n=!1){var i=e,r=null,s=null,a=ae,l=n?Kn:0,u=!1;const c=(g,p=!0)=>{u=!0,d(p,g)};var f=null;function h(){f!==null&&(f.lastChild.remove(),i.before(f),f=null);var g=a?r:s,p=a?s:r;g&&cr(g),p&&or(p,()=>{a?s=null:r=null})}const d=(g,p)=>{if(a!==(a=g)){var _=xi(),m=i;if(_&&(f=document.createDocumentFragment(),f.append(m=$t())),a?r??=p&&Gt(()=>p(m)):s??=p&&Gt(()=>p(m)),_){var b=W,v=a?r:s,x=a?s:r;v&&b.skipped_effects.delete(v),x&&b.skipped_effects.add(x),b.add_callback(h)}else h()}};Ti(()=>{u=!1,t(c),u||d(null,null)},l)}function hn(e,t){return t}function qa(e,t,n){for(var i=e.items,r=[],s=t.length,a=0;a<s;a++)ur(t[a].e,r,!0);var l=s>0&&r.length===0&&n!==null;if(l){var u=n.parentNode;ma(u),u.append(n),i.clear(),Se(e,t[0].prev,t[s-1].next)}Ci(r,()=>{for(var c=0;c<s;c++){var f=t[c];l||(i.delete(f.k),Se(e,f.prev,f.next)),Ne(f.e,!l)}})}function dn(e,t,n,i,r,s=null){var a=e,l={flags:t,items:new Map,first:null},u=(t&oi)!==0;if(u){var c=e;a=c.appendChild($t())}var f=null,h=!1,d=new Map,g=ar(()=>{var b=n();return kn(b)?b:b==null?[]:Yn(b)}),p,_;function m(){Da(_,p,l,d,a,r,t,i,n),s!==null&&(p.length===0?f?cr(f):f=Gt(()=>s(a)):f!==null&&or(f,()=>{f=null}))}Ti(()=>{_??=M,p=o(g);var b=p.length;if(!(h&&b===0)){h=b===0;var v,x,R,T;if(xi()){var y=new Set,S=W;for(x=0;x<b;x+=1){R=p[x],T=i(R,x);var I=l.items.get(T)??d.get(T);I?(t&(xn|yn))!==0&&Bi(I,R,x,t):(v=Fi(null,l,null,null,R,T,x,r,t,n,!0),d.set(T,v)),y.add(T)}for(const[$,B]of l.items)y.has($)||S.skipped_effects.add(B.e);S.add_callback(m)}else m();o(g)}})}function Da(e,t,n,i,r,s,a,l,u){var c=(a&Zs)!==0,f=(a&(xn|yn))!==0,h=t.length,d=n.items,g=n.first,p=g,_,m=null,b,v=[],x=[],R,T,y,S;if(c)for(S=0;S<h;S+=1)R=t[S],T=l(R,S),y=d.get(T),y!==void 0&&(y.a?.measure(),(b??=new Set).add(y));for(S=0;S<h;S+=1){if(R=t[S],T=l(R,S),y=d.get(T),y===void 0){var I=i.get(T);if(I!==void 0){i.delete(T),d.set(T,I);var $=m?m.next:p;Se(n,m,I),Se(n,I,$),On(I,$,r),m=I}else{var B=p?p.e.nodes_start:r;m=Fi(B,n,m,m===null?n.first:m.next,R,T,S,s,a,u)}d.set(T,m),v=[],x=[],p=m.next;continue}if(f&&Bi(y,R,S,a),(y.e.f&we)!==0&&(cr(y.e),c&&(y.a?.unfix(),(b??=new Set).delete(y))),y!==p){if(_!==void 0&&_.has(y)){if(v.length<x.length){var F=x[0],U;m=F.prev;var ie=v[0],Z=v[v.length-1];for(U=0;U<v.length;U+=1)On(v[U],F,r);for(U=0;U<x.length;U+=1)_.delete(x[U]);Se(n,ie.prev,Z.next),Se(n,m,ie),Se(n,Z,F),p=F,m=Z,S-=1,v=[],x=[]}else _.delete(y),On(y,p,r),Se(n,y.prev,y.next),Se(n,y,m===null?n.first:m.next),Se(n,m,y),m=y;continue}for(v=[],x=[];p!==null&&p.k!==T;)(p.e.f&we)===0&&(_??=new Set).add(p),x.push(p),p=p.next;if(p===null)continue;y=p}v.push(y),m=y,p=y.next}if(p!==null||_!==void 0){for(var X=_===void 0?[]:Yn(_);p!==null;)(p.e.f&we)===0&&X.push(p),p=p.next;var ee=X.length;if(ee>0){var pe=(a&oi)!==0&&h===0?r:null;if(c){for(S=0;S<ee;S+=1)X[S].a?.measure();for(S=0;S<ee;S+=1)X[S].a?.fix()}qa(n,X,pe)}}c&&sr(()=>{if(b!==void 0)for(y of b)y.a?.apply()}),e.first=n.first&&n.first.e,e.last=m&&m.e;for(var V of i.values())Ne(V.e);i.clear()}function Bi(e,t,n,i){(i&xn)!==0&&zt(e.v,t),(i&yn)!==0?zt(e.i,n):e.i=n}function Fi(e,t,n,i,r,s,a,l,u,c,f){var h=(u&xn)!==0,d=(u&Gs)===0,g=h?d?L(r,!1,!1):Ht(r):r,p=(u&yn)===0?a:Ht(a),_={i:p,v:g,k:s,a:null,e:null,prev:n,next:i};try{if(e===null){var m=document.createDocumentFragment();m.append(e=$t())}return _.e=Gt(()=>l(e,g,p,c),ta),_.e.prev=n&&n.e,_.e.next=i&&i.e,n===null?f||(t.first=_):(n.next=_,n.e.next=_.e),i!==null&&(i.prev=_,i.e.prev=_.e),_}finally{}}function On(e,t,n){for(var i=e.next?e.next.e.nodes_start:n,r=t?t.e.nodes_start:n,s=e.e.nodes_start;s!==null&&s!==i;){var a=zn(s);r.before(s),s=a}}function Se(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}function jt(e,t,n=!1,i=!1,r=!1){var s=e,a="";re(()=>{var l=M;if(a!==(a=t()??"")&&(l.nodes_start!==null&&($i(l.nodes_start,l.nodes_end),l.nodes_start=l.nodes_end=null),a!=="")){var u=a+"";n?u=`<svg>${u}</svg>`:i&&(u=`<math>${u}</math>`);var c=ji(u);if((n||i)&&(c=Be(c)),Qt(Be(c),c.lastChild),n||i)for(;Be(c);)s.before(Be(c));else s.before(c)}})}const Qr=[...` 	
\r\f \v\uFEFF`];function ja(e,t,n){var i=e==null?"":""+e;if(t&&(i=i?i+" "+t:t),n){for(var r in n)if(n[r])i=i?i+" "+r:r;else if(i.length)for(var s=r.length,a=0;(a=i.indexOf(r,a))>=0;){var l=a+s;(a===0||Qr.includes(i[a-1]))&&(l===i.length||Qr.includes(i[l]))?i=(a===0?"":i.substring(0,a))+i.substring(l+1):a=l}}return i===""?null:i}function Ba(e,t){return e==null?null:String(e)}function vt(e,t,n,i,r,s){var a=e.__className;if(a!==n||a===void 0){var l=ja(n,i,s);l==null?e.removeAttribute("class"):e.className=l,e.__className=n}else if(s&&r!==s)for(var u in s){var c=!!s[u];(r==null||c!==!!r[u])&&e.classList.toggle(u,c)}return s}function Ue(e,t,n,i){var r=e.__style;if(r!==t){var s=Ba(t);s==null?e.removeAttribute("style"):e.style.cssText=s,e.__style=t}return i}function Ui(e,t,n=!1){if(e.multiple){if(t==null)return;if(!kn(t))return ea();for(var i of e.options)i.selected=t.includes(Bt(i));return}for(i of e.options){var r=Bt(i);if(_a(r,t)){i.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function Fa(e){var t=new MutationObserver(()=>{Ui(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Ei(()=>{t.disconnect()})}function xt(e,t,n=t){var i=!0;yi(e,"change",r=>{var s=r?"[selected]":":checked",a;if(e.multiple)a=[].map.call(e.querySelectorAll(s),Bt);else{var l=e.querySelector(s)??e.querySelector("option:not([disabled])");a=l&&Bt(l)}n(a)}),Ai(()=>{var r=t();if(Ui(e,r,i),i&&r===void 0){var s=e.querySelector(":checked");s!==null&&(r=Bt(s),n(r))}e.__value=r,i=!1}),Fa(e)}function Bt(e){return"__value"in e?e.__value:e.value}function me(e,t,n=t){var i=It(),r=new WeakSet;yi(e,"input",s=>{var a=s?e.defaultValue:e.value;if(a=qn(e)?Dn(a):a,n(a),W!==null&&r.add(W),i&&a!==(a=t())){var l=e.selectionStart,u=e.selectionEnd;e.value=a??"",u!==null&&(e.selectionStart=l,e.selectionEnd=Math.min(u,e.value.length))}}),q(t)==null&&e.value&&(n(qn(e)?Dn(e.value):e.value),W!==null&&r.add(W)),Tn(()=>{var s=t();if(e===document.activeElement){var a=sn??W;if(r.has(a))return}qn(e)&&s===Dn(e.value)||e.type==="date"&&!s&&!e.value||s!==e.value&&(e.value=s??"")})}function qn(e){var t=e.type;return t==="number"||t==="range"}function Dn(e){return e===""?null:+e}function Vr(e,t){return e===t||e?.[Ce]===t}function gn(e={},t,n,i){return Ai(()=>{var r,s;return Tn(()=>{r=s,s=[],q(()=>{e!==n(...s)&&(t(e,...s),r&&Vr(n(...r),e)&&t(null,...r))})}),()=>{sr(()=>{s&&Vr(n(...s),e)&&t(null,...s)})}}),e}function Ua(e){return function(...t){var n=t[0];return n.preventDefault(),e?.apply(this,t)}}function Xt(e=!1){const t=K,n=t.l.u;if(!n)return;let i=()=>J(t.s);if(e){let r=0,s={};const a=Sn(()=>{let l=!1;const u=t.s;for(const c in u)u[c]!==s[c]&&(s[c]=u[c],l=!0);return l&&r++,r});i=()=>o(a)}n.b.length&&wa(()=>{Yr(t,i),on(n.b)}),Hn(()=>{const r=q(()=>n.m.map($s));return()=>{for(const s of r)typeof s=="function"&&s()}}),n.a.length&&Hn(()=>{Yr(t,i),on(n.a)})}function Yr(e,t){if(e.l.s)for(const n of e.l.s)o(n);t()}let tn=!1;function Ha(e){var t=tn;try{return tn=!1,[e(),tn]}finally{tn=t}}function P(e,t,n,i){var r=!At||(n&Qs)!==0,s=(n&Ys)!==0,a=(n&Xs)!==0,l=i,u=!0,c=()=>(u&&(u=!1,l=a?q(i):i),l),f;if(s){var h=Ce in e||Ls in e;f=mt(e,t)?.set??(h&&t in e?x=>e[t]=x:void 0)}var d,g=!1;s?[d,g]=Ha(()=>e[t]):d=e[t],d===void 0&&i!==void 0&&(d=c(),f&&(r&&Bs(),f(d)));var p;if(r?p=()=>{var x=e[t];return x===void 0?c():(u=!0,x)}:p=()=>{var x=e[t];return x!==void 0&&(l=void 0),x===void 0?l:x},r&&(n&Vs)===0)return p;if(f){var _=e.$$legacy;return(function(x,R){return arguments.length>0?((!r||!R||_||g)&&f(R?p():x),x):p()})}var m=!1,b=((n&Ws)!==0?Sn:ar)(()=>(m=!1,p()));s&&o(b);var v=M;return(function(x,R){if(arguments.length>0){const T=R?o(b):r&&s?_t(x):x;return z(b,T),m=!0,l!==void 0&&(l=T),x}return it&&m||(v.f&rt)!==0?b.v:o(b)})}function Hi(e){K===null&&li(),At&&K.l!==null?Ga(K).m.push(e):Hn(()=>{const t=q(e);if(typeof t=="function")return t})}function Za(e){K===null&&li(),Hi(()=>()=>q(e))}function Ga(e){var t=e.l;return t.u??={a:[],b:[],m:[]}}const Wa="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Wa);ia();var Qa=_e("<option> </option>"),Va=_e('<div class="topbar"><div class="group"><label>PDF Title <input type="text" placeholder="Title…"/></label> <label>Size <select></select></label> <button>Reset margins</button></div> <div class="group"><label>T <input type="number" min="0" step="1"/> mm</label> <label>R <input type="number" min="0" step="1"/> mm</label> <label>B <input type="number" min="0" step="1"/> mm</label> <label>L <input type="number" min="0" step="1"/> mm</label></div> <div class="group"><label>Cols <input type="number" min="1" step="1"/></label> <label>Gap <input type="number" min="0" step="1"/> mm</label></div></div>');function Ya(e,t){Tt(t,!1);let n=P(t,"title",12),i=P(t,"page_sizes",8),r=P(t,"page_size",12),s=P(t,"margins",12),a=P(t,"columns",12),l=P(t,"column_gap",12);const u=()=>{!i()||!r()||s({...i()[r()].margins})};Xt();var c=Va(),f=E(c),h=E(f),d=w(E(h)),g=w(h,2),p=w(E(g));re(()=>{r(),bt(()=>{i()})}),dn(p,5,()=>(J(i()),q(()=>Object.values(i()))),hn,(Z,X)=>{var ee=Qa(),pe=E(ee),V={};re(()=>{he(pe,(o(X),q(()=>o(X).label))),V!==(V=(o(X),q(()=>o(X).id)))&&(ee.value=(ee.__value=(o(X),q(()=>o(X).id)))??"")}),ne(Z,ee)});var _=w(g,2),m=w(f,2),b=E(m),v=w(E(b)),x=w(b,2),R=w(E(x)),T=w(x,2),y=w(E(T)),S=w(T,2),I=w(E(S)),$=w(m,2),B=E($),F=w(E(B)),U=w(B,2),ie=w(E(U));me(d,n),xt(p,r),te("click",_,u),me(v,()=>s().top,Z=>s(s().top=Z,!0)),me(R,()=>s().right,Z=>s(s().right=Z,!0)),me(y,()=>s().bottom,Z=>s(s().bottom=Z,!0)),me(I,()=>s().left,Z=>s(s().left=Z,!0)),me(F,a),me(ie,l),ne(e,c),Rt()}var Xa=_e('<div class="group"><label>Font <select><option>Serif</option><option>Sans</option><option>Mono</option></select></label> <label>Size <input type="number" min="3" step="0.5"/> pt</label> <label>LH <input type="number" min="0.5" step="0.1"/></label> <button>A−</button> <button>A+</button> <label><select><option>Ragged</option><option>Justify</option></select></label> <label><select><option>No hyphens</option><option>Hyphens auto</option></select></label></div>');function Ja(e,t){let n=P(t,"font_family",12),i=P(t,"base_font_pt",12),r=P(t,"line_height",12),s=P(t,"justify",12),a=P(t,"hyphens",12),l=P(t,"make_smaller",8,()=>{}),u=P(t,"make_larger",8,()=>{});var c=Xa(),f=E(c),h=w(E(f));re(()=>{n(),bt(()=>{})});var d=E(h);d.value=d.__value="Georgia, Times New Roman, serif";var g=w(d);g.value=g.__value="Helvetica, Arial, sans-serif";var p=w(g);p.value=p.__value="Courier, monospace";var _=w(f,2),m=w(E(_)),b=w(_,2),v=w(E(b)),x=w(b,2),R=w(x,2),T=w(R,2),y=E(T);re(()=>{s(),bt(()=>{})});var S=E(y);S.value=S.__value="left";var I=w(S);I.value=I.__value="justify";var $=w(T,2),B=E($);re(()=>{a(),bt(()=>{})});var F=E(B);F.value=F.__value="none";var U=w(F);U.value=U.__value="auto",xt(h,n),me(m,i),me(v,r),te("click",x,function(...ie){l()?.apply(this,ie)}),te("click",R,function(...ie){u()?.apply(this,ie)}),xt(y,s),xt(B,a),ne(e,c)}var Ka=_e('<label>Gutter <input type="number" min="0" step="1"/> mm</label> <label>Order <select><option>Editorial (1–2, 3–4…)</option><option>Booklet (printer spreads)</option></select></label>',1),el=_e('<div class="group right"><button>+ Head</button> <button>+ Foot</button> <input type="file" accept="image/*" multiple style="display:none"/> <input type="file" accept="image/*" multiple style="display:none"/> <button>+ Image</button> <button>+ Full Image</button> <button>+ Col Break</button> <button>+ Row Break</button> <button>+ Page Break</button></div> <div class="group right"><input type="file" accept="application/json" style="display:none" id="import_book_input"/> <button>Import</button> <button class="primary">Save</button> <div class="group"><label>Print <select><option>Single pages</option><option>Spreads (2-up)</option></select></label> <!></div> <button class="primary">Print / PDF</button></div> <div class="zoombar"><input type="range" min="25" max="200" step="5"/> <button type="button">100%</button> <span class="zoomval"> </span></div>',1);function tl(e,t){Tt(t,!1);let n=P(t,"print_mode",12),i=P(t,"spread_gutter",12),r=P(t,"arrangement",12),s=P(t,"preview_zoom",12),a=P(t,"on_export_book",8,()=>{}),l=P(t,"on_import_book",8,()=>{}),u=P(t,"print_pdf",8,()=>{}),c=P(t,"insert_head",8,()=>{}),f=P(t,"insert_foot",8,()=>{}),h=P(t,"insert_col_break",8,()=>{}),d=P(t,"insert_row_break",8,()=>{}),g=P(t,"insert_page_break",8,()=>{}),p=P(t,"on_image_input",8,()=>{}),_=L(),m=L();Xt();var b=el(),v=Zt(b),x=E(v),R=w(x,2),T=w(R,2);gn(T,C=>z(_,C),()=>o(_));var y=w(T,2);gn(y,C=>z(m,C),()=>o(m));var S=w(y,2),I=w(S,2),$=w(I,2),B=w($,2),F=w(B,2),U=w(v,2),ie=E(U),Z=w(ie,2),X=w(Z,2),ee=w(X,2),pe=E(ee),V=w(E(pe));re(()=>{n(),bt(()=>{})});var oe=E(V);oe.value=oe.__value="pages";var lt=w(oe);lt.value=lt.__value="spreads";var qe=w(pe,2);{var ot=C=>{var D=Ka(),Y=Zt(D),$n=w(E(Y)),Pn=w(Y,2),Kt=w(E(Pn));re(()=>{r(),bt(()=>{})});var Ve=E(Kt);Ve.value=Ve.__value="sequential";var ft=w(Ve);ft.value=ft.__value="booklet",me($n,i),xt(Kt,r),ne(C,D)};je(qe,C=>{n()==="spreads"&&C(ot)})}var Pt=w(ee,2),ut=w(U,2),ct=E(ut),Ge=w(ct,2),We=w(Ge,2),Qe=E(We);re(C=>he(Qe,`${C??""}%`),[()=>(J(s()),q(()=>Math.round(s())))]),te("click",x,function(...C){c()?.apply(this,C)}),te("click",R,function(...C){f()?.apply(this,C)}),te("change",T,C=>p()(C,!1)),te("change",y,C=>p()(C,!0)),te("click",S,()=>o(_).click()),te("click",I,()=>o(m).click()),te("click",$,function(...C){h()?.apply(this,C)}),te("click",B,function(...C){d()?.apply(this,C)}),te("click",F,function(...C){g()?.apply(this,C)}),te("change",ie,function(...C){l()?.apply(this,C)}),te("click",Z,()=>document.getElementById("import_book_input").click()),te("click",X,function(...C){a()?.apply(this,C)}),xt(V,n),te("click",Pt,function(...C){u()?.apply(this,C)}),me(ct,s),te("click",Ge,()=>s(100)),ne(e,b),Rt()}var nl=_e('<section class="left"><div class="editor"><div class="header"><div>Markdown</div> <div class="meta"> </div> <div class="storage-indicator"> </div></div> <textarea spellcheck="false"></textarea></div></section>');function rl(e,t){let n=P(t,"markdown",12),i=P(t,"storage_text",8,""),r=P(t,"pages_len",8,0),s=P(t,"columns",8,1),a=P(t,"on_paste",8,()=>{}),l=P(t,"on_drop",8,()=>{}),u=P(t,"prevent",8,v=>v.preventDefault()),c=P(t,"taEl",12);var f=nl(),h=E(f),d=E(h),g=w(E(d),2),p=E(g),_=w(g,2),m=E(_),b=w(d,2);gn(b,v=>c(v),()=>c()),re(()=>{he(p,`${r()??""} pages · ${s()??""} col`),he(m,i())}),me(b,n),te("paste",b,function(...v){a()?.apply(this,v)}),te("dragover",f,Ua(function(...v){u()?.apply(this,v)})),te("drop",f,function(...v){l()?.apply(this,v)}),ne(e,f)}var il=_e('<div class="page"><div class="page-running-header"> </div> <div><!></div> <div class="page-running-footer"> </div> <div></div></div>'),sl=_e('<div class="spreads-viewport"><div class="spreads-scale"><div class="spreads"></div></div></div>');function al(e,t){Tt(t,!1);let n=P(t,"pages",24,()=>[]),i=P(t,"run_heads",24,()=>[]),r=P(t,"run_foots",24,()=>[]),s=P(t,"page_style",8,""),a=P(t,"inner_style",8,""),l=P(t,"zoom_scale",8,1);Xt();var u=sl(),c=E(u),f=E(c);dn(f,5,n,hn,(h,d,g)=>{var p=il(),_=E(p),m=E(_),b=w(_,2);let v;var x=E(b);jt(x,()=>o(d));var R=w(b,2),T=E(R),y=w(R,2);vt(y,1,`page-number ${g%2===0?"rig":"lef"}`),y.textContent=g+1,re(S=>{Ue(p,s()),he(m,(J(i()),q(()=>i()[g]||""))),v=vt(b,1,"page-inner preview",null,v,S),Ue(b,a()),he(T,(J(r()),q(()=>r()[g]||"")))},[()=>({fullpage:o(d).includes("img-page")})]),ne(h,p)}),re(()=>Ue(c,`transform:scale(${l()}); transform-origin: top left;`)),ne(e,u),Rt()}var ll=_e('<div class="print-page"><div class="print-running-header"> </div> <div><!></div> <div class="print-running-footer"> </div> <div></div></div>'),ol=_e('<div class="print-sheet"><div class="print-page"><div class="print-running-header"><!></div> <div><!></div> <div class="print-running-footer"><!></div> <div class="print-page-number lef"><!></div></div> <div class="print-gutter"></div> <div class="print-page"><div class="print-running-header"><!></div> <div><!></div> <div class="print-running-footer"><!></div> <div class="print-page-number rig"><!></div></div></div>'),ul=_e('<div id="print-root" aria-hidden="true" style="display:none"><!></div>');function cl(e,t){Tt(t,!1);let n=P(t,"print_mode",8,"pages"),i=P(t,"pages",24,()=>[]),r=P(t,"sheets",24,()=>[]),s=P(t,"sheet_idxs",24,()=>[]),a=P(t,"inner_style",8,""),l=P(t,"run_heads",24,()=>[]),u=P(t,"run_foots",24,()=>[]);Xt();var c=ul(),f=E(c);{var h=g=>{var p=Wr(),_=Zt(p);dn(_,1,i,hn,(m,b,v)=>{var x=ll(),R=E(x),T=E(R),y=w(R,2);let S;var I=E(y);jt(I,()=>o(b));var $=w(y,2),B=E($),F=w($,2);vt(F,1,`print-page-number ${v%2===0?"rig":"lef"}`),F.textContent=v+1,re(U=>{he(T,(J(l()),q(()=>l()[v]||""))),S=vt(y,1,"print-inner",null,S,U),Ue(y,a()),he(B,(J(u()),q(()=>u()[v]||"")))},[()=>({fullpage:o(b).includes("img-page")})]),ne(m,x)}),ne(g,p)},d=g=>{var p=Wr(),_=Zt(p);dn(_,1,r,hn,(m,b,v)=>{var x=ol(),R=E(x),T=E(R),y=E(T);{var S=D=>{var Y=ht();re(()=>he(Y,(J(l()),J(s()),q(()=>l()[s()[v][0]]||"")))),ne(D,Y)};je(y,D=>{J(s()),q(()=>s()[v][0]!=null)&&D(S)})}var I=w(T,2);let $;var B=E(I);jt(B,()=>(o(b),q(()=>o(b)[0]||"")));var F=w(I,2),U=E(F);{var ie=D=>{var Y=ht();re(()=>he(Y,(J(u()),J(s()),q(()=>u()[s()[v][0]]||"")))),ne(D,Y)};je(U,D=>{J(s()),q(()=>s()[v][0]!=null)&&D(ie)})}var Z=w(F,2),X=E(Z);{var ee=D=>{var Y=ht();re(()=>he(Y,(J(s()),q(()=>s()[v][0]+1)))),ne(D,Y)};je(X,D=>{J(s()),q(()=>s()[v][0]!=null)&&D(ee)})}var pe=w(R,4),V=E(pe),oe=E(V);{var lt=D=>{var Y=ht();re(()=>he(Y,(J(l()),J(s()),q(()=>l()[s()[v][1]]||"")))),ne(D,Y)};je(oe,D=>{J(s()),q(()=>s()[v][1]!=null)&&D(lt)})}var qe=w(V,2);let ot;var Pt=E(qe);jt(Pt,()=>(o(b),q(()=>o(b)[1]||"")));var ut=w(qe,2),ct=E(ut);{var Ge=D=>{var Y=ht();re(()=>he(Y,(J(u()),J(s()),q(()=>u()[s()[v][1]]||"")))),ne(D,Y)};je(ct,D=>{J(s()),q(()=>s()[v][1]!=null)&&D(Ge)})}var We=w(ut,2),Qe=E(We);{var C=D=>{var Y=ht();re(()=>he(Y,(J(s()),q(()=>s()[v][1]+1)))),ne(D,Y)};je(Qe,D=>{J(s()),q(()=>s()[v][1]!=null)&&D(C)})}re((D,Y)=>{$=vt(I,1,"print-inner",null,$,D),Ue(I,a()),ot=vt(qe,1,"print-inner",null,ot,Y),Ue(qe,a())},[()=>({fullpage:(o(b)[0]||"").includes("img-page")}),()=>({fullpage:(o(b)[1]||"").includes("img-page")})]),ne(m,x)}),ne(g,p)};je(f,g=>{n()==="pages"?g(h):g(d,!1)})}ne(e,c),Rt()}var fl=_e('<div class="splitter" title="Drag to resize"></div>');function pl(e,t){let n=P(t,"onDown",8,()=>{});var i=fl();te("mousedown",i,function(...r){n()?.apply(this,r)}),ne(e,i)}const hl="zine",dl=2,Ae="images",Ze="images_meta";function st(){return new Promise((e,t)=>{const n=indexedDB.open(hl,dl);n.onupgradeneeded=()=>{const i=n.result;i.objectStoreNames.contains(Ae)||i.createObjectStore(Ae),i.objectStoreNames.contains(Ze)||i.createObjectStore(Ze)},n.onsuccess=()=>e(n.result),n.onerror=()=>t(n.error)})}async function Zi(e){const t=await st();return new Promise((n,i)=>{const a=t.transaction(Ae,"readonly").objectStore(Ae).get(e);a.onsuccess=()=>n(a.result),a.onerror=()=>i(a.error)})}async function Gi(e,t){const n=await st();return new Promise((i,r)=>{const l=n.transaction(Ae,"readwrite").objectStore(Ae).put(t,e);l.onsuccess=()=>i(!0),l.onerror=()=>r(l.error)})}async function Wi(e){const t=await st();return new Promise((n,i)=>{const a=t.transaction(Ae,"readwrite").objectStore(Ae).delete(e);a.onsuccess=()=>n(!0),a.onerror=()=>i(a.error)})}async function Qi(){const e=await st();return new Promise((t,n)=>{const r=e.transaction(Ae,"readonly").objectStore(Ae),s=[],a=r.openCursor();a.onsuccess=()=>{const l=a.result;l?(s.push(l.key),l.continue()):t(s)},a.onerror=()=>n(a.error)})}async function Vi(e){const t=await st();return new Promise((n,i)=>{const a=t.transaction(Ze,"readonly").objectStore(Ze).get(e);a.onsuccess=()=>n(a.result||null),a.onerror=()=>i(a.error)})}async function fr(e,t){const n=await st();return new Promise((i,r)=>{const l=n.transaction(Ze,"readwrite").objectStore(Ze).put(t,e);l.onsuccess=()=>i(!0),l.onerror=()=>r(l.error)})}async function Yi(e){const t=await st();return new Promise((n,i)=>{const a=t.transaction(Ze,"readwrite").objectStore(Ze).delete(e);a.onsuccess=()=>n(!0),a.onerror=()=>i(a.error)})}async function gl(){if(!navigator.storage?.estimate)return null;try{const{quota:e,usage:t}=await navigator.storage.estimate();return{quota:e,usage:t}}catch{return null}}async function _l(){if(navigator.storage?.persist)try{await navigator.storage.persist()}catch{}}const vl=256,ml=16,Xr=12,bl=2,Xi=1600,kl=.85;function wl(){return`${Date.now()}-${crypto.randomUUID()}`}async function Ji(){const e=await gl();return e?e.usage/1024/1024:0}async function xl(e,t=Xi,n=kl){const i=await createImageBitmap(e),r=Math.min(1,t/i.width),s=Math.round(i.width*r),a=Math.round(i.height*r);if(r>=1)return e;const l=document.createElement("canvas");l.width=s,l.height=a,l.getContext("2d").drawImage(i,0,0,s,a);const c=e.type==="image/png",f=c?"image/png":"image/jpeg",h=await new Promise(d=>l.toBlob(d,f,c?void 0:n));return new File([h],e.name.replace(/\.(\w+)$/,"")+(c?".png":".jpg"),{type:f})}async function yl(e,t){let n=Xi,i=e;for(let r=0;r<6;r++){if(i.size/1024/1024<=t)return i;n=Math.max(640,Math.floor(n*.75)),i=await xl(i,n)}return i}async function Sl(e){const t=await Qi(),n=await Promise.all(t.map(async r=>{const s=await Vi(r);return{k:r,t:s?.last||0,s:s?.size||0}}));n.sort((r,s)=>r.t-s.t);let i=0;for(const r of n){if(i>=e*1024*1024)break;await Wi(r.k).catch(()=>{}),await Yi(r.k).catch(()=>{}),i+=r.s}}async function El(e){await _l();let t=await yl(e,Xr);if(t.size/1024/1024>Xr)throw new Error("file too large");const n=await Ji(),i=vl-n,r=t.size/1024/1024+ml;i<r&&await Sl(r-i);const s=wl();return await Gi(s,t),await fr(s,{size:t.size,last:Date.now()}),{key:s,file:t}}function zl(e){const t=new Set,n=/!\[[^\]]*]\(appimg:\/\/([^)]+)\)/g,i=/<img[^>]+src=["']appimg:\/\/([^"']+)["'][^>]*>/g;let r;for(;r=n.exec(e);)t.add(r[1]);for(;r=i.exec(e);)t.add(r[1]);return t}async function Al(e){const t=zl(e),i=(await Qi()).filter(r=>!t.has(r));await Promise.allSettled(i.map(async r=>{await Wi(r),await Yi(r)}))}const _n=new Map;function Tl(){for(const e of _n.values())URL.revokeObjectURL(e);_n.clear()}async function Jr(e){if(!e.includes("appimg://"))return e;const t=document.createElement("div");t.innerHTML=e;const n=Array.from(t.querySelectorAll('img[src^="appimg://"]'));let i=0;const r=async()=>{for(;;){const a=i++;if(a>=n.length)break;const l=n[a],u=l.getAttribute("src").slice(9);try{const c=await Zi(u);if(c){let f=_n.get(u);f||(f=URL.createObjectURL(c),_n.set(u,f)),l.src=f;const h=await Vi(u);await fr(u,{...h||{},last:Date.now(),size:h?.size??c.size})}else l.setAttribute("alt",(l.getAttribute("alt")||"")+" (missing)")}catch{}}},s=Array.from({length:Math.min(bl,n.length)},r);return await Promise.all(s),t.innerHTML}function Rl(e=""){const t=new Set,n=/appimg:\/\/([A-Za-z0-9._\-:/]+)/g;let i;for(;i=n.exec(String(e));)t.add(i[1]);return Array.from(t)}function Il(e){return new Promise((t,n)=>{const i=new FileReader;i.onload=()=>{const r=String(i.result||""),s=r.indexOf("base64,");t(s>=0?r.slice(s+7):r)},i.onerror=n,i.readAsDataURL(e)})}async function $l(e){const t={},n=Rl(e);for(const i of n){const r=await Zi(i);if(!r)continue;const s=await Il(r);t[i]={name:i,type:r.type||"image/*",base64:s}}return t}async function Pl(e={}){const t=Object.entries(e);for(const[n,i]of t){const r=i?.base64;if(!r)continue;const s=i?.type||"image/*",a=Uint8Array.from(atob(r),u=>u.charCodeAt(0)),l=new Blob([a],{type:s});await Gi(n,l),await fr(n,{size:l.size,last:Date.now()})}}const nn={A7:{id:"A7",label:"A7 (74×105mm)",w:74,h:105,margins:{top:5,right:5,bottom:5,left:5}},A6:{id:"A6",label:"A6 (105×148mm)",w:105,h:148,margins:{top:5,right:5,bottom:5,left:5}},A5:{id:"A5",label:"A5 (148×210mm)",w:148,h:210,margins:{top:5,right:5,bottom:5,left:5}},A4:{id:"A4",label:"A4 (210×297mm)",w:210,h:297,margins:{top:5,right:5,bottom:5,left:5}},Letter:{id:"Letter",label:"Letter (216×279mm)",w:216,h:279,margins:{top:5,right:5,bottom:5,left:5}}},Ie=96/25.4;function pr(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var at=pr();function Ki(e){at=e}var Ft={exec:()=>null};function j(e,t=""){let n=typeof e=="string"?e:e.source,i={replace:(r,s)=>{let a=typeof s=="string"?s:s.source;return a=a.replace(ce.caret,"$1"),n=n.replace(r,a),i},getRegex:()=>new RegExp(n,t)};return i}var ce={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},Cl=/^(?:[ \t]*(?:\n|$))+/,Ll=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Nl=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Jt=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Ml=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,hr=/(?:[*+-]|\d{1,9}[.)])/,es=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,ts=j(es).replace(/bull/g,hr).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Ol=j(es).replace(/bull/g,hr).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),dr=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,ql=/^[^\n]+/,gr=/(?!\s*\])(?:\\.|[^\[\]\\])+/,Dl=j(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",gr).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),jl=j(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,hr).getRegex(),Rn="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",_r=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Bl=j("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",_r).replace("tag",Rn).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),ns=j(dr).replace("hr",Jt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Rn).getRegex(),Fl=j(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",ns).getRegex(),vr={blockquote:Fl,code:Ll,def:Dl,fences:Nl,heading:Ml,hr:Jt,html:Bl,lheading:ts,list:jl,newline:Cl,paragraph:ns,table:Ft,text:ql},Kr=j("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Jt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Rn).getRegex(),Ul={...vr,lheading:Ol,table:Kr,paragraph:j(dr).replace("hr",Jt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Kr).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Rn).getRegex()},Hl={...vr,html:j(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",_r).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Ft,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:j(dr).replace("hr",Jt).replace("heading",` *#{1,6} *[^
]`).replace("lheading",ts).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Zl=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Gl=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,rs=/^( {2,}|\\)\n(?!\s*$)/,Wl=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,In=/[\p{P}\p{S}]/u,mr=/[\s\p{P}\p{S}]/u,is=/[^\s\p{P}\p{S}]/u,Ql=j(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,mr).getRegex(),ss=/(?!~)[\p{P}\p{S}]/u,Vl=/(?!~)[\s\p{P}\p{S}]/u,Yl=/(?:[^\s\p{P}\p{S}]|~)/u,Xl=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<(?! )[^<>]*?>/g,as=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Jl=j(as,"u").replace(/punct/g,In).getRegex(),Kl=j(as,"u").replace(/punct/g,ss).getRegex(),ls="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",eo=j(ls,"gu").replace(/notPunctSpace/g,is).replace(/punctSpace/g,mr).replace(/punct/g,In).getRegex(),to=j(ls,"gu").replace(/notPunctSpace/g,Yl).replace(/punctSpace/g,Vl).replace(/punct/g,ss).getRegex(),no=j("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,is).replace(/punctSpace/g,mr).replace(/punct/g,In).getRegex(),ro=j(/\\(punct)/,"gu").replace(/punct/g,In).getRegex(),io=j(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),so=j(_r).replace("(?:-->|$)","-->").getRegex(),ao=j("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",so).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),vn=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,lo=j(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",vn).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),os=j(/^!?\[(label)\]\[(ref)\]/).replace("label",vn).replace("ref",gr).getRegex(),us=j(/^!?\[(ref)\](?:\[\])?/).replace("ref",gr).getRegex(),oo=j("reflink|nolink(?!\\()","g").replace("reflink",os).replace("nolink",us).getRegex(),br={_backpedal:Ft,anyPunctuation:ro,autolink:io,blockSkip:Xl,br:rs,code:Gl,del:Ft,emStrongLDelim:Jl,emStrongRDelimAst:eo,emStrongRDelimUnd:no,escape:Zl,link:lo,nolink:us,punctuation:Ql,reflink:os,reflinkSearch:oo,tag:ao,text:Wl,url:Ft},uo={...br,link:j(/^!?\[(label)\]\((.*?)\)/).replace("label",vn).getRegex(),reflink:j(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",vn).getRegex()},Gn={...br,emStrongRDelimAst:to,emStrongLDelim:Kl,url:j(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},co={...Gn,br:j(rs).replace("{2,}","*").getRegex(),text:j(Gn.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},rn={normal:vr,gfm:Ul,pedantic:Hl},Mt={normal:br,gfm:Gn,breaks:co,pedantic:uo},fo={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ei=e=>fo[e];function ye(e,t){if(t){if(ce.escapeTest.test(e))return e.replace(ce.escapeReplace,ei)}else if(ce.escapeTestNoEncode.test(e))return e.replace(ce.escapeReplaceNoEncode,ei);return e}function ti(e){try{e=encodeURI(e).replace(ce.percentDecode,"%")}catch{return null}return e}function ni(e,t){let n=e.replace(ce.findPipe,(s,a,l)=>{let u=!1,c=a;for(;--c>=0&&l[c]==="\\";)u=!u;return u?"|":" |"}),i=n.split(ce.splitPipe),r=0;if(i[0].trim()||i.shift(),i.length>0&&!i.at(-1)?.trim()&&i.pop(),t)if(i.length>t)i.splice(t);else for(;i.length<t;)i.push("");for(;r<i.length;r++)i[r]=i[r].trim().replace(ce.slashPipe,"|");return i}function Ot(e,t,n){let i=e.length;if(i===0)return"";let r=0;for(;r<i&&e.charAt(i-r-1)===t;)r++;return e.slice(0,i-r)}function po(e,t){if(e.indexOf(t[1])===-1)return-1;let n=0;for(let i=0;i<e.length;i++)if(e[i]==="\\")i++;else if(e[i]===t[0])n++;else if(e[i]===t[1]&&(n--,n<0))return i;return n>0?-2:-1}function ri(e,t,n,i,r){let s=t.href,a=t.title||null,l=e[1].replace(r.other.outputLinkReplace,"$1");i.state.inLink=!0;let u={type:e[0].charAt(0)==="!"?"image":"link",raw:n,href:s,title:a,text:l,tokens:i.inlineTokens(l)};return i.state.inLink=!1,u}function ho(e,t,n){let i=e.match(n.other.indentCodeCompensation);if(i===null)return t;let r=i[1];return t.split(`
`).map(s=>{let a=s.match(n.other.beginningSpace);if(a===null)return s;let[l]=a;return l.length>=r.length?s.slice(r.length):s}).join(`
`)}var mn=class{options;rules;lexer;constructor(e){this.options=e||at}space(e){let t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){let t=this.rules.block.code.exec(e);if(t){let n=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:Ot(n,`
`)}}}fences(e){let t=this.rules.block.fences.exec(e);if(t){let n=t[0],i=ho(n,t[3]||"",this.rules);return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:i}}}heading(e){let t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(this.rules.other.endingHash.test(n)){let i=Ot(n,"#");(this.options.pedantic||!i||this.rules.other.endingSpaceChar.test(i))&&(n=i.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){let t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:Ot(t[0],`
`)}}blockquote(e){let t=this.rules.block.blockquote.exec(e);if(t){let n=Ot(t[0],`
`).split(`
`),i="",r="",s=[];for(;n.length>0;){let a=!1,l=[],u;for(u=0;u<n.length;u++)if(this.rules.other.blockquoteStart.test(n[u]))l.push(n[u]),a=!0;else if(!a)l.push(n[u]);else break;n=n.slice(u);let c=l.join(`
`),f=c.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");i=i?`${i}
${c}`:c,r=r?`${r}
${f}`:f;let h=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(f,s,!0),this.lexer.state.top=h,n.length===0)break;let d=s.at(-1);if(d?.type==="code")break;if(d?.type==="blockquote"){let g=d,p=g.raw+`
`+n.join(`
`),_=this.blockquote(p);s[s.length-1]=_,i=i.substring(0,i.length-g.raw.length)+_.raw,r=r.substring(0,r.length-g.text.length)+_.text;break}else if(d?.type==="list"){let g=d,p=g.raw+`
`+n.join(`
`),_=this.list(p);s[s.length-1]=_,i=i.substring(0,i.length-d.raw.length)+_.raw,r=r.substring(0,r.length-g.raw.length)+_.raw,n=p.substring(s.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:i,tokens:s,text:r}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim(),i=n.length>1,r={type:"list",raw:"",ordered:i,start:i?+n.slice(0,-1):"",loose:!1,items:[]};n=i?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=i?n:"[*+-]");let s=this.rules.other.listItemRegex(n),a=!1;for(;e;){let u=!1,c="",f="";if(!(t=s.exec(e))||this.rules.block.hr.test(e))break;c=t[0],e=e.substring(c.length);let h=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,b=>" ".repeat(3*b.length)),d=e.split(`
`,1)[0],g=!h.trim(),p=0;if(this.options.pedantic?(p=2,f=h.trimStart()):g?p=t[1].length+1:(p=t[2].search(this.rules.other.nonSpaceChar),p=p>4?1:p,f=h.slice(p),p+=t[1].length),g&&this.rules.other.blankLine.test(d)&&(c+=d+`
`,e=e.substring(d.length+1),u=!0),!u){let b=this.rules.other.nextBulletRegex(p),v=this.rules.other.hrRegex(p),x=this.rules.other.fencesBeginRegex(p),R=this.rules.other.headingBeginRegex(p),T=this.rules.other.htmlBeginRegex(p);for(;e;){let y=e.split(`
`,1)[0],S;if(d=y,this.options.pedantic?(d=d.replace(this.rules.other.listReplaceNesting,"  "),S=d):S=d.replace(this.rules.other.tabCharGlobal,"    "),x.test(d)||R.test(d)||T.test(d)||b.test(d)||v.test(d))break;if(S.search(this.rules.other.nonSpaceChar)>=p||!d.trim())f+=`
`+S.slice(p);else{if(g||h.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||x.test(h)||R.test(h)||v.test(h))break;f+=`
`+d}!g&&!d.trim()&&(g=!0),c+=y+`
`,e=e.substring(y.length+1),h=S.slice(p)}}r.loose||(a?r.loose=!0:this.rules.other.doubleBlankLine.test(c)&&(a=!0));let _=null,m;this.options.gfm&&(_=this.rules.other.listIsTask.exec(f),_&&(m=_[0]!=="[ ] ",f=f.replace(this.rules.other.listReplaceTask,""))),r.items.push({type:"list_item",raw:c,task:!!_,checked:m,loose:!1,text:f,tokens:[]}),r.raw+=c}let l=r.items.at(-1);if(l)l.raw=l.raw.trimEnd(),l.text=l.text.trimEnd();else return;r.raw=r.raw.trimEnd();for(let u=0;u<r.items.length;u++)if(this.lexer.state.top=!1,r.items[u].tokens=this.lexer.blockTokens(r.items[u].text,[]),!r.loose){let c=r.items[u].tokens.filter(h=>h.type==="space"),f=c.length>0&&c.some(h=>this.rules.other.anyLine.test(h.raw));r.loose=f}if(r.loose)for(let u=0;u<r.items.length;u++)r.items[u].loose=!0;return r}}html(e){let t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){let t=this.rules.block.def.exec(e);if(t){let n=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),i=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",r=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:i,title:r}}}table(e){let t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;let n=ni(t[1]),i=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),r=t[3]?.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],s={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===i.length){for(let a of i)this.rules.other.tableAlignRight.test(a)?s.align.push("right"):this.rules.other.tableAlignCenter.test(a)?s.align.push("center"):this.rules.other.tableAlignLeft.test(a)?s.align.push("left"):s.align.push(null);for(let a=0;a<n.length;a++)s.header.push({text:n[a],tokens:this.lexer.inline(n[a]),header:!0,align:s.align[a]});for(let a of r)s.rows.push(ni(a,s.header.length).map((l,u)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:s.align[u]})));return s}}lheading(e){let t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){let t=this.rules.block.paragraph.exec(e);if(t){let n=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){let t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){let t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){let t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){let t=this.rules.inline.link.exec(e);if(t){let n=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;let s=Ot(n.slice(0,-1),"\\");if((n.length-s.length)%2===0)return}else{let s=po(t[2],"()");if(s===-2)return;if(s>-1){let a=(t[0].indexOf("!")===0?5:4)+t[1].length+s;t[2]=t[2].substring(0,s),t[0]=t[0].substring(0,a).trim(),t[3]=""}}let i=t[2],r="";if(this.options.pedantic){let s=this.rules.other.pedanticHrefTitle.exec(i);s&&(i=s[1],r=s[3])}else r=t[3]?t[3].slice(1,-1):"";return i=i.trim(),this.rules.other.startAngleBracket.test(i)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?i=i.slice(1):i=i.slice(1,-1)),ri(t,{href:i&&i.replace(this.rules.inline.anyPunctuation,"$1"),title:r&&r.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let i=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),r=t[i.toLowerCase()];if(!r){let s=n[0].charAt(0);return{type:"text",raw:s,text:s}}return ri(n,r,n[0],this.lexer,this.rules)}}emStrong(e,t,n=""){let i=this.rules.inline.emStrongLDelim.exec(e);if(!(!i||i[3]&&n.match(this.rules.other.unicodeAlphaNumeric))&&(!(i[1]||i[2])||!n||this.rules.inline.punctuation.exec(n))){let r=[...i[0]].length-1,s,a,l=r,u=0,c=i[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(c.lastIndex=0,t=t.slice(-1*e.length+r);(i=c.exec(t))!=null;){if(s=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!s)continue;if(a=[...s].length,i[3]||i[4]){l+=a;continue}else if((i[5]||i[6])&&r%3&&!((r+a)%3)){u+=a;continue}if(l-=a,l>0)continue;a=Math.min(a,a+l+u);let f=[...i[0]][0].length,h=e.slice(0,r+i.index+f+a);if(Math.min(r,a)%2){let g=h.slice(1,-1);return{type:"em",raw:h,text:g,tokens:this.lexer.inlineTokens(g)}}let d=h.slice(2,-2);return{type:"strong",raw:h,text:d,tokens:this.lexer.inlineTokens(d)}}}}codespan(e){let t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(this.rules.other.newLineCharGlobal," "),i=this.rules.other.nonSpaceChar.test(n),r=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return i&&r&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:t[0],text:n}}}br(e){let t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){let t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){let t=this.rules.inline.autolink.exec(e);if(t){let n,i;return t[2]==="@"?(n=t[1],i="mailto:"+n):(n=t[1],i=n),{type:"link",raw:t[0],text:n,href:i,tokens:[{type:"text",raw:n,text:n}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let n,i;if(t[2]==="@")n=t[0],i="mailto:"+n;else{let r;do r=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??"";while(r!==t[0]);n=t[0],t[1]==="www."?i="http://"+t[0]:i=t[0]}return{type:"link",raw:t[0],text:n,href:i,tokens:[{type:"text",raw:n,text:n}]}}}inlineText(e){let t=this.rules.inline.text.exec(e);if(t){let n=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:n}}}},$e=class Wn{tokens;options;state;tokenizer;inlineQueue;constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||at,this.options.tokenizer=this.options.tokenizer||new mn,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let n={other:ce,block:rn.normal,inline:Mt.normal};this.options.pedantic?(n.block=rn.pedantic,n.inline=Mt.pedantic):this.options.gfm&&(n.block=rn.gfm,this.options.breaks?n.inline=Mt.breaks:n.inline=Mt.gfm),this.tokenizer.rules=n}static get rules(){return{block:rn,inline:Mt}}static lex(t,n){return new Wn(n).lex(t)}static lexInline(t,n){return new Wn(n).inlineTokens(t)}lex(t){t=t.replace(ce.carriageReturn,`
`),this.blockTokens(t,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){let i=this.inlineQueue[n];this.inlineTokens(i.src,i.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,n=[],i=!1){for(this.options.pedantic&&(t=t.replace(ce.tabCharGlobal,"    ").replace(ce.spaceLine,""));t;){let r;if(this.options.extensions?.block?.some(a=>(r=a.call({lexer:this},t,n))?(t=t.substring(r.raw.length),n.push(r),!0):!1))continue;if(r=this.tokenizer.space(t)){t=t.substring(r.raw.length);let a=n.at(-1);r.raw.length===1&&a!==void 0?a.raw+=`
`:n.push(r);continue}if(r=this.tokenizer.code(t)){t=t.substring(r.raw.length);let a=n.at(-1);a?.type==="paragraph"||a?.type==="text"?(a.raw+=(a.raw.endsWith(`
`)?"":`
`)+r.raw,a.text+=`
`+r.text,this.inlineQueue.at(-1).src=a.text):n.push(r);continue}if(r=this.tokenizer.fences(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.heading(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.hr(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.blockquote(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.list(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.html(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.def(t)){t=t.substring(r.raw.length);let a=n.at(-1);a?.type==="paragraph"||a?.type==="text"?(a.raw+=(a.raw.endsWith(`
`)?"":`
`)+r.raw,a.text+=`
`+r.raw,this.inlineQueue.at(-1).src=a.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title},n.push(r));continue}if(r=this.tokenizer.table(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.lheading(t)){t=t.substring(r.raw.length),n.push(r);continue}let s=t;if(this.options.extensions?.startBlock){let a=1/0,l=t.slice(1),u;this.options.extensions.startBlock.forEach(c=>{u=c.call({lexer:this},l),typeof u=="number"&&u>=0&&(a=Math.min(a,u))}),a<1/0&&a>=0&&(s=t.substring(0,a+1))}if(this.state.top&&(r=this.tokenizer.paragraph(s))){let a=n.at(-1);i&&a?.type==="paragraph"?(a.raw+=(a.raw.endsWith(`
`)?"":`
`)+r.raw,a.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=a.text):n.push(r),i=s.length!==t.length,t=t.substring(r.raw.length);continue}if(r=this.tokenizer.text(t)){t=t.substring(r.raw.length);let a=n.at(-1);a?.type==="text"?(a.raw+=(a.raw.endsWith(`
`)?"":`
`)+r.raw,a.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=a.text):n.push(r);continue}if(t){let a="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,n}inline(t,n=[]){return this.inlineQueue.push({src:t,tokens:n}),n}inlineTokens(t,n=[]){let i=t,r=null;if(this.tokens.links){let l=Object.keys(this.tokens.links);if(l.length>0)for(;(r=this.tokenizer.rules.inline.reflinkSearch.exec(i))!=null;)l.includes(r[0].slice(r[0].lastIndexOf("[")+1,-1))&&(i=i.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+i.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(r=this.tokenizer.rules.inline.anyPunctuation.exec(i))!=null;)i=i.slice(0,r.index)+"++"+i.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(r=this.tokenizer.rules.inline.blockSkip.exec(i))!=null;)i=i.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+i.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let s=!1,a="";for(;t;){s||(a=""),s=!1;let l;if(this.options.extensions?.inline?.some(c=>(l=c.call({lexer:this},t,n))?(t=t.substring(l.raw.length),n.push(l),!0):!1))continue;if(l=this.tokenizer.escape(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.tag(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.link(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(l.raw.length);let c=n.at(-1);l.type==="text"&&c?.type==="text"?(c.raw+=l.raw,c.text+=l.text):n.push(l);continue}if(l=this.tokenizer.emStrong(t,i,a)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.codespan(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.br(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.del(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.autolink(t)){t=t.substring(l.raw.length),n.push(l);continue}if(!this.state.inLink&&(l=this.tokenizer.url(t))){t=t.substring(l.raw.length),n.push(l);continue}let u=t;if(this.options.extensions?.startInline){let c=1/0,f=t.slice(1),h;this.options.extensions.startInline.forEach(d=>{h=d.call({lexer:this},f),typeof h=="number"&&h>=0&&(c=Math.min(c,h))}),c<1/0&&c>=0&&(u=t.substring(0,c+1))}if(l=this.tokenizer.inlineText(u)){t=t.substring(l.raw.length),l.raw.slice(-1)!=="_"&&(a=l.raw.slice(-1)),s=!0;let c=n.at(-1);c?.type==="text"?(c.raw+=l.raw,c.text+=l.text):n.push(l);continue}if(t){let c="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return n}},bn=class{options;parser;constructor(e){this.options=e||at}space(e){return""}code({text:e,lang:t,escaped:n}){let i=(t||"").match(ce.notSpaceStart)?.[0],r=e.replace(ce.endingNewline,"")+`
`;return i?'<pre><code class="language-'+ye(i)+'">'+(n?r:ye(r,!0))+`</code></pre>
`:"<pre><code>"+(n?r:ye(r,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}def(e){return""}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){let t=e.ordered,n=e.start,i="";for(let a=0;a<e.items.length;a++){let l=e.items[a];i+=this.listitem(l)}let r=t?"ol":"ul",s=t&&n!==1?' start="'+n+'"':"";return"<"+r+s+`>
`+i+"</"+r+`>
`}listitem(e){let t="";if(e.task){let n=this.checkbox({checked:!!e.checked});e.loose?e.tokens[0]?.type==="paragraph"?(e.tokens[0].text=n+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=n+" "+ye(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:n+" ",text:n+" ",escaped:!0}):t+=n+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",n="";for(let r=0;r<e.header.length;r++)n+=this.tablecell(e.header[r]);t+=this.tablerow({text:n});let i="";for(let r=0;r<e.rows.length;r++){let s=e.rows[r];n="";for(let a=0;a<s.length;a++)n+=this.tablecell(s[a]);i+=this.tablerow({text:n})}return i&&(i=`<tbody>${i}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+i+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){let t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${ye(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){let i=this.parser.parseInline(n),r=ti(e);if(r===null)return i;e=r;let s='<a href="'+e+'"';return t&&(s+=' title="'+ye(t)+'"'),s+=">"+i+"</a>",s}image({href:e,title:t,text:n,tokens:i}){i&&(n=this.parser.parseInline(i,this.parser.textRenderer));let r=ti(e);if(r===null)return ye(n);e=r;let s=`<img src="${e}" alt="${n}"`;return t&&(s+=` title="${ye(t)}"`),s+=">",s}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:ye(e.text)}},kr=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}},Pe=class Qn{options;renderer;textRenderer;constructor(t){this.options=t||at,this.options.renderer=this.options.renderer||new bn,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new kr}static parse(t,n){return new Qn(n).parse(t)}static parseInline(t,n){return new Qn(n).parseInline(t)}parse(t,n=!0){let i="";for(let r=0;r<t.length;r++){let s=t[r];if(this.options.extensions?.renderers?.[s.type]){let l=s,u=this.options.extensions.renderers[l.type].call({parser:this},l);if(u!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(l.type)){i+=u||"";continue}}let a=s;switch(a.type){case"space":{i+=this.renderer.space(a);continue}case"hr":{i+=this.renderer.hr(a);continue}case"heading":{i+=this.renderer.heading(a);continue}case"code":{i+=this.renderer.code(a);continue}case"table":{i+=this.renderer.table(a);continue}case"blockquote":{i+=this.renderer.blockquote(a);continue}case"list":{i+=this.renderer.list(a);continue}case"html":{i+=this.renderer.html(a);continue}case"def":{i+=this.renderer.def(a);continue}case"paragraph":{i+=this.renderer.paragraph(a);continue}case"text":{let l=a,u=this.renderer.text(l);for(;r+1<t.length&&t[r+1].type==="text";)l=t[++r],u+=`
`+this.renderer.text(l);n?i+=this.renderer.paragraph({type:"paragraph",raw:u,text:u,tokens:[{type:"text",raw:u,text:u,escaped:!0}]}):i+=u;continue}default:{let l='Token with "'+a.type+'" type was not found.';if(this.options.silent)return console.error(l),"";throw new Error(l)}}}return i}parseInline(t,n=this.renderer){let i="";for(let r=0;r<t.length;r++){let s=t[r];if(this.options.extensions?.renderers?.[s.type]){let l=this.options.extensions.renderers[s.type].call({parser:this},s);if(l!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){i+=l||"";continue}}let a=s;switch(a.type){case"escape":{i+=n.text(a);break}case"html":{i+=n.html(a);break}case"link":{i+=n.link(a);break}case"image":{i+=n.image(a);break}case"strong":{i+=n.strong(a);break}case"em":{i+=n.em(a);break}case"codespan":{i+=n.codespan(a);break}case"br":{i+=n.br(a);break}case"del":{i+=n.del(a);break}case"text":{i+=n.text(a);break}default:{let l='Token with "'+a.type+'" type was not found.';if(this.options.silent)return console.error(l),"";throw new Error(l)}}}return i}},ln=class{options;block;constructor(e){this.options=e||at}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?$e.lex:$e.lexInline}provideParser(){return this.block?Pe.parse:Pe.parseInline}},go=class{defaults=pr();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=Pe;Renderer=bn;TextRenderer=kr;Lexer=$e;Tokenizer=mn;Hooks=ln;constructor(...e){this.use(...e)}walkTokens(e,t){let n=[];for(let i of e)switch(n=n.concat(t.call(this,i)),i.type){case"table":{let r=i;for(let s of r.header)n=n.concat(this.walkTokens(s.tokens,t));for(let s of r.rows)for(let a of s)n=n.concat(this.walkTokens(a.tokens,t));break}case"list":{let r=i;n=n.concat(this.walkTokens(r.items,t));break}default:{let r=i;this.defaults.extensions?.childTokens?.[r.type]?this.defaults.extensions.childTokens[r.type].forEach(s=>{let a=r[s].flat(1/0);n=n.concat(this.walkTokens(a,t))}):r.tokens&&(n=n.concat(this.walkTokens(r.tokens,t)))}}return n}use(...e){let t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(n=>{let i={...n};if(i.async=this.defaults.async||i.async||!1,n.extensions&&(n.extensions.forEach(r=>{if(!r.name)throw new Error("extension name required");if("renderer"in r){let s=t.renderers[r.name];s?t.renderers[r.name]=function(...a){let l=r.renderer.apply(this,a);return l===!1&&(l=s.apply(this,a)),l}:t.renderers[r.name]=r.renderer}if("tokenizer"in r){if(!r.level||r.level!=="block"&&r.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let s=t[r.level];s?s.unshift(r.tokenizer):t[r.level]=[r.tokenizer],r.start&&(r.level==="block"?t.startBlock?t.startBlock.push(r.start):t.startBlock=[r.start]:r.level==="inline"&&(t.startInline?t.startInline.push(r.start):t.startInline=[r.start]))}"childTokens"in r&&r.childTokens&&(t.childTokens[r.name]=r.childTokens)}),i.extensions=t),n.renderer){let r=this.defaults.renderer||new bn(this.defaults);for(let s in n.renderer){if(!(s in r))throw new Error(`renderer '${s}' does not exist`);if(["options","parser"].includes(s))continue;let a=s,l=n.renderer[a],u=r[a];r[a]=(...c)=>{let f=l.apply(r,c);return f===!1&&(f=u.apply(r,c)),f||""}}i.renderer=r}if(n.tokenizer){let r=this.defaults.tokenizer||new mn(this.defaults);for(let s in n.tokenizer){if(!(s in r))throw new Error(`tokenizer '${s}' does not exist`);if(["options","rules","lexer"].includes(s))continue;let a=s,l=n.tokenizer[a],u=r[a];r[a]=(...c)=>{let f=l.apply(r,c);return f===!1&&(f=u.apply(r,c)),f}}i.tokenizer=r}if(n.hooks){let r=this.defaults.hooks||new ln;for(let s in n.hooks){if(!(s in r))throw new Error(`hook '${s}' does not exist`);if(["options","block"].includes(s))continue;let a=s,l=n.hooks[a],u=r[a];ln.passThroughHooks.has(s)?r[a]=c=>{if(this.defaults.async)return Promise.resolve(l.call(r,c)).then(h=>u.call(r,h));let f=l.call(r,c);return u.call(r,f)}:r[a]=(...c)=>{let f=l.apply(r,c);return f===!1&&(f=u.apply(r,c)),f}}i.hooks=r}if(n.walkTokens){let r=this.defaults.walkTokens,s=n.walkTokens;i.walkTokens=function(a){let l=[];return l.push(s.call(this,a)),r&&(l=l.concat(r.call(this,a))),l}}this.defaults={...this.defaults,...i}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return $e.lex(e,t??this.defaults)}parser(e,t){return Pe.parse(e,t??this.defaults)}parseMarkdown(e){return(t,n)=>{let i={...n},r={...this.defaults,...i},s=this.onError(!!r.silent,!!r.async);if(this.defaults.async===!0&&i.async===!1)return s(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof t>"u"||t===null)return s(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return s(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));r.hooks&&(r.hooks.options=r,r.hooks.block=e);let a=r.hooks?r.hooks.provideLexer():e?$e.lex:$e.lexInline,l=r.hooks?r.hooks.provideParser():e?Pe.parse:Pe.parseInline;if(r.async)return Promise.resolve(r.hooks?r.hooks.preprocess(t):t).then(u=>a(u,r)).then(u=>r.hooks?r.hooks.processAllTokens(u):u).then(u=>r.walkTokens?Promise.all(this.walkTokens(u,r.walkTokens)).then(()=>u):u).then(u=>l(u,r)).then(u=>r.hooks?r.hooks.postprocess(u):u).catch(s);try{r.hooks&&(t=r.hooks.preprocess(t));let u=a(t,r);r.hooks&&(u=r.hooks.processAllTokens(u)),r.walkTokens&&this.walkTokens(u,r.walkTokens);let c=l(u,r);return r.hooks&&(c=r.hooks.postprocess(c)),c}catch(u){return s(u)}}}onError(e,t){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e){let i="<p>An error occurred:</p><pre>"+ye(n.message+"",!0)+"</pre>";return t?Promise.resolve(i):i}if(t)return Promise.reject(n);throw n}}},tt=new go;function H(e,t){return tt.parse(e,t)}H.options=H.setOptions=function(e){return tt.setOptions(e),H.defaults=tt.defaults,Ki(H.defaults),H};H.getDefaults=pr;H.defaults=at;H.use=function(...e){return tt.use(...e),H.defaults=tt.defaults,Ki(H.defaults),H};H.walkTokens=function(e,t){return tt.walkTokens(e,t)};H.parseInline=tt.parseInline;H.Parser=Pe;H.parser=Pe.parse;H.Renderer=bn;H.TextRenderer=kr;H.Lexer=$e;H.lexer=$e.lex;H.Tokenizer=mn;H.Hooks=ln;H.parse=H;H.options;H.setOptions;H.use;H.walkTokens;H.parseInline;Pe.parse;$e.lex;function _o(e=""){return H.parse(String(e))}function vo(e){const t=String(e).split(/\r?\n/),n=[];let i=[];const r=()=>{i.length&&(n.push(_o(i.join(`
`))),i.length=0)},s=a=>/^\s*\[\[(pagebreak|colbreak|rowbreak)(:[^]]+)?\]\]\s*$/i.test(a);for(const a of t){const l=a.match(/^\s*\[\[\s*head(?:er)?:\s*(.*?)\s*\]\]\s*$/i),u=a.match(/^\s*\[\[\s*foot:\s*(.*?)\s*\]\]\s*$/i),c=a.match(/^\s*\[\[\s*rowbreak(?::\s*([^\]]+))?\s*\]\]\s*$/i);if(l){r(),n.push(`<div data-runhead="${l[1].replace(/"/g,"&quot;")}"></div>`);continue}if(u){r(),n.push(`<div data-runfoot="${u[1].replace(/"/g,"&quot;")}"></div>`);continue}if(c){r();let f=(c[1]||"").trim();f||(f="1em"),/^\d+(\.\d+)?$/.test(f)&&(f=`${f}em`),n.push(`<div data-rowbreak="1" class="force-rowbreak" style="height:${f}"></div>`);continue}if(s(a)){const f=a.trim().toLowerCase();r(),f.includes("colbreak")?n.push('<div data-colbreak="1" class="force-colbreak"></div>'):n.push('<div data-pagebreak="1" class="page-break-marker"></div>')}else i.push(a)}return r(),n.join(`
`)}let Vn=null;function yt(e,t){const n=Vn||document.body,i=document.createElement("div");i.style.position="absolute",i.style.left="-99999px",i.style.top="0",i.style.width=t+"px",i.style.boxSizing="border-box",i.style.visibility="hidden",i.style.whiteSpace="normal",i.style.wordBreak="normal",i.style.overflowWrap="anywhere",n.appendChild(i);const r=e.cloneNode(!0);r.style.whiteSpace="inherit",r.style.wordBreak="inherit",r.style.overflowWrap="inherit",i.appendChild(r);const s=getComputedStyle(r),a=parseFloat(s.marginTop)||0,l=parseFloat(s.marginBottom)||0,u=r.offsetHeight+a+l;return i.remove(),{h:u,mt:a,mb:l}}function mo(e){const t=e.classList||{contains:()=>!1};return t.contains("span-all")||t.contains("full")||t.contains("cols")||t.contains("cols-1")||t.contains("cols-2")||t.contains("img-page")||t.contains("img-wide")||t.contains("figure-wide")}function cs(e,t,n,i=!1){const s=(e.textContent??"").toString().replace(/\s+/g," ").trim();if(!s.length)return{head:null,tail:null};if(!(e.childNodes.length===1&&e.firstChild&&e.firstChild.nodeType===3)){if(i)return{head:null,tail:null};const _=document.createElement("p");return _.textContent=s,cs(_,t,n,!0)}const l=e.cloneNode(!1);if(l.textContent=s,yt(l,t).h<=n)return{head:e.cloneNode(!0),tail:null};const u=e.cloneNode(!1),c=e.cloneNode(!1);let f=0,h=s.length;for(;f<h;){const _=f+h+1>>1;u.textContent=s.slice(0,_),yt(u,t).h<=n?f=_:h=_-1}let d=f;for(;d>0&&!/\s/.test(s[d-1]);)d--;d===0&&(d=f);const g=s.slice(0,d).replace(/\s+$/,""),p=s.slice(d).replace(/^\s+/,"");return u.textContent=g,c.textContent=p,{head:g?u:null,tail:p?c:null}}function bo(e,t,n){const i=e.tagName;if(i==="P")return cs(e,t,n);if(i==="UL"||i==="OL"){const r=e.cloneNode(!1),s=e.cloneNode(!1),a=Array.from(e.children);for(let l=0;l<a.length;l++)if(r.appendChild(a[l].cloneNode(!0)),yt(r,t).h>n){r.removeChild(r.lastChild);for(let c=l;c<a.length;c++)s.appendChild(a[c].cloneNode(!0));return{head:r.childNodes.length?r:null,tail:s.childNodes.length?s:null}}return{head:r,tail:null}}return{head:null,tail:null}}function ko(e){const t=e.measurer_el??e.measurerEl,n=e.page_px??e.pagePx,i=e.pad,r=e.columns,s=e.column_gap??e.columnGap;if(!t||!n||!i)return{pages:[],heads:[],foots:[]};Vn=t;const a=n.h-(i.top+i.bottom),l=Math.max(1,Number(r)||1),u=(Number(s)||0)*Ie,c=n.w-(i.left+i.right),f=l>1?(c-u*(l-1))/l:c,h=Array.from(t.childNodes).filter($=>$.nodeType===1),d=[],g=[],p=[];let _=[],m=0,b=0,v=0,x="",R="";const T=()=>{d.push(_.join("")),g.push(x),p.push(R),_=[],m=0,b=0,v=0},y=()=>{m<l-1?(m+=1,b=0,v=0):T()},S=$=>{_.push($)};let I=0;for(;I<h.length;){const $=h[I];if($.hasAttribute&&$.hasAttribute("data-runhead")){x=$.getAttribute("data-runhead")||"",I++;continue}if($.hasAttribute&&$.hasAttribute("data-runfoot")){R=$.getAttribute("data-runfoot")||"",I++;continue}if($.hasAttribute&&$.hasAttribute("data-pagebreak")){T(),I++;continue}if($.hasAttribute&&$.hasAttribute("data-colbreak")){S('<div class="force-colbreak"></div>'),y(),I++;continue}if($.hasAttribute&&$.hasAttribute("data-rowbreak")){const V=yt($,f),oe=b===0?V.h:V.h-Math.min(v,V.mt);oe<=a-b?(S($.outerHTML),b+=oe,v=V.mb,I++):y();continue}if(["META","LINK","SCRIPT","STYLE"].includes($.tagName)){I++;continue}const B=$,F=mo(B),U=yt(B,F?c:f),ie=b===0?U.h:U.h-Math.min(v,U.mt),Z=a-b;if(ie<=Z){S(B.outerHTML),b+=ie,v=U.mb,I++;continue}if(U.h<=a){y();continue}const X=F?c:f,{head:ee,tail:pe}=bo(B,X,Z);if(ee){const V=yt(ee,X),oe=b===0?V.h:V.h-Math.min(v,V.mt);if(oe<=a-b){S(ee.outerHTML),b+=oe,v=V.mb,pe&&h.splice(I+1,0,pe),I++;continue}else{y();continue}}S(B.outerHTML),T(),I++}return d.push(_.join("")),g.push(x),p.push(R),Vn=null,{pages:d,heads:g,foots:p}}function wo(e,t,n,i,r,s,a,l,u,c,f){const h=m=>`${m}mm`,d=c==="spreads"?e.w*2+f:e.w,g=e.h,p=`
@page { size: ${h(d)} ${h(g)}; margin: 0; }
@media print {
  body { background: #fff !important; }
  .topbar, .workspace .left, .workspace .splitter, .right .spreads { display: none !important; }
  #print-root { display: block !important; }
  #print-root .print-page { width: ${h(e.w)}; height: ${h(e.h)}; background: #fff; box-shadow: none !important; page-break-after: always; }
  #print-root .print-page:last-child { page-break-after: auto; }
  #print-root .print-sheet { display: flex; align-items: stretch; width: ${h(d)}; height: ${h(g)}; page-break-after: always; background: #fff; }
  #print-root .print-sheet:last-child { page-break-after: auto; }
  #print-root .print-gutter { width: ${h(f)}; flex: 0 0 ${h(f)}; }
  #print-root .print-inner {
    box-sizing: border-box; width: 100%; height: 100%; overflow: hidden;
    padding: ${h(t.top)} ${h(t.right)} ${h(t.bottom)} ${h(t.left)};
    --pad-top:${h(t.top)}; --pad-right:${h(t.right)}; --pad-bottom:${h(t.bottom)}; --pad-left:${h(t.left)};
    column-count: ${n}; column-gap: ${h(i)};
    font-family: ${r}; font-size: ${s}pt; line-height: ${a};
    text-align: ${l==="justify"?"justify":"left"}; hyphens: ${u};
  }
}
`;let _=document.getElementById("print-rules");_||(_=document.createElement("style"),_.id="print-rules",document.head.appendChild(_)),_.textContent=p}function xo(e=""){return String(e).toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"").slice(0,80)||"book"}function yo(e,t){const n=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),i=URL.createObjectURL(n),r=document.createElement("a");r.href=i,r.download=e,document.body.appendChild(r),r.click(),r.remove(),URL.revokeObjectURL(i)}function So(e){return{__type:"zine-book",__version:2,savedAt:new Date().toISOString(),...e}}async function Eo(e){const t=await $l(e.markdown),n=So({...e,assets:t});yo(`${xo(e.title)}.zine.json`,n)}function zo(e,t){e&&(t.title(e.title),t.page_size(e.page_size),t.margins(e.margins),t.columns(Number(e.columns)),t.column_gap(Number(e.column_gap)),t.font_family(e.font_family),t.base_font_pt(Number(e.base_font_pt)),t.line_height(Number(e.line_height)),t.justify(e.justify),t.hyphens(e.hyphens),t.print_mode(e.print_mode),t.spread_gutter(Number(e.spread_gutter)),typeof e.left_percent=="number"&&t.left_percent(Math.max(20,Math.min(80,e.left_percent))),t.markdown(e.markdown))}async function Ao(e,t,n){try{const i=await e.text(),r=JSON.parse(i);r.assets&&await Pl(r.assets),zo(r,t),await qt(),await n()}catch(i){console.error(i),alert("Import failed: invalid or corrupted file.")}finally{const i=document.getElementById("import_book");i&&(i.value="")}}var To=_e('<!> <div class="topbar"><!> <!></div> <div class="workspace"><!> <!> <section class="right"><div id="measurer"><!></div> <!> <!></section></div>',1);function Ro(e,t){Tt(t,!1);const n=L(),i=L(),r=L(),s=L(),a=L(),l=L(),u=L(),c=L(),f=L(),h=L(),d=`## Can we write while we are typesetting a book?
[[pagebreak]]`;let g=L(localStorage.getItem("zine:title")??"Untitled Zine"),p=L(localStorage.getItem("zine:page_size")??"A7"),_=L(JSON.parse(localStorage.getItem("zine:margins")??JSON.stringify(nn.A7.margins))),m=L(localStorage.getItem("zine:markdown")??d),b=L(Number(localStorage.getItem("zine:columns")??1)),v=L(Number(localStorage.getItem("zine:column_gap")??5)),x=L(localStorage.getItem("zine:font_family")??"Courier, monospace"),R=L(Number(localStorage.getItem("zine:base_font_pt")??8)),T=L(Number(localStorage.getItem("zine:line_height")??1)),y=L(localStorage.getItem("zine:justify")??"left"),S=L(localStorage.getItem("zine:hyphens")??"auto"),I=L(localStorage.getItem("zine:print_mode")??"pages"),$=L(Number(localStorage.getItem("zine:spread_gutter")??6)),B=L(Number(localStorage.getItem("zine:zoom")??100)),F=L(localStorage.getItem("zine:arrangement")??"booklet"),U=L([]),ie=L(""),Z=L([]),X=L([]),ee=L(),pe=L(""),V=L([]),oe=L([]);const lt=96/72;function qe(k){const N=k.target?.files?.[0];N&&Ao(N,{title:A=>z(g,A??o(g)),page_size:A=>z(p,A??o(p)),margins:A=>z(_,A??o(_)),markdown:A=>z(m,A??o(m)),columns:A=>z(b,A??o(b)),column_gap:A=>z(v,A??o(v)),font_family:A=>z(x,A??o(x)),base_font_pt:A=>z(R,A??o(R)),line_height:A=>z(T,A??o(T)),justify:A=>z(y,A??o(y)),hyphens:A=>z(S,A??o(S)),print_mode:A=>z(I,A??o(I)),spread_gutter:A=>z($,A??o($)),left_percent:A=>z(xe,A??o(xe))},Qe)}function ot(k){const N=[];if(k<=0)return N;N.push([null,0]);for(let A=1;A<k;A+=2)N.push([A,A+1<k?A+1:null]);return N}function Pt(k){const N=k+(4-k%4)%4,A=[];let Q=0,se=N-1;for(;Q<se;)A.push([se<k?se:null,Q<k?Q:null]),A.push([Q+1<k?Q+1:null,se-1<k?se-1:null]),Q+=2,se-=2;return A}function ut(k,N){const A=N==="booklet"?Pt(k.length):ot(k.length);return{pairs:A.map(([se,Re])=>[se!=null?k[se]:"",Re!=null?k[Re]:""]),idxs:A}}function ct(){Eo({title:o(g),page_size:o(p),margins:o(_),markdown:o(m),columns:o(b),column_gap:o(v),font_family:o(x),base_font_pt:o(R),line_height:o(T),justify:o(y),hyphens:o(S),print_mode:o(I),spread_gutter:o($),left_percent:o(xe)})}async function Ge(){const k=await Ji();z(pe,`Storage ${k.toFixed(1)} MB`)}let We;async function Qe(){We&&clearTimeout(We),We=setTimeout(async()=>{if(!o(ee))return;await qt(),z(ie,await Jr(o(h))),await qt();const k=ko({measurerEl:o(ee),pagePx:o(r),pad:o(s),columns:o(b),columnGap:o(v)});z(Z,k.pages),z(V,k.heads),z(oe,k.foots);const N=ut(o(Z),o(I)==="spreads"?o(F):"sequential");z(X,N.pairs),z(U,N.idxs),wo(o(i),o(_),o(b),o(v),o(x),o(R),o(T),o(y),o(S),o(I),o($))},60)}function C(k){const N=o(Ct),A=N?.selectionStart??o(m).length,Q=N?.selectionEnd??o(m).length;z(m,o(m).slice(0,A)+k+o(m).slice(Q)),qt().then(()=>{const se=A+k.length;N?.setSelectionRange(se,se),N?.focus()})}const D=()=>C(`

[[rowbreak:1]]

`),Y=()=>C(`

[[pagebreak]]

`),$n=()=>C(`

[[colbreak]]

`),Pn=()=>C(`

[[head: Your Heading]]

`),Kt=()=>C(`

[[foot: Your Footer]]

`);async function Ve(k,N=!1){const{key:A,file:Q}=await El(k);C(N?`

[[pagebreak]]
<img src="appimg://${A}" alt="${Q.name}" class="img-page" />
[[pagebreak]]
`:`

![${Q.name}](appimg://${A})

`),await Al(o(m)).catch(()=>{}),await Ge()}let ft=0;async function Cn(k){for(;ft>=1;)await new Promise(N=>setTimeout(N,30));ft++;try{return await k()}finally{ft--}}function fs(k){k.preventDefault(),Array.from(k.dataTransfer.files||[]).filter(A=>A.type.startsWith("image/")).reduce((A,Q)=>A.then(()=>Cn(()=>Ve(Q,!1))),Promise.resolve())}const ps=k=>k.preventDefault();function hs(k){const A=Array.from(k.clipboardData?.items||[]).find(Q=>Q.type.startsWith("image/"));A&&(k.preventDefault(),Cn(()=>Ve(A.getAsFile(),!1)))}async function ds(k,N){const A=Array.from(k.target.files||[]);for(const Q of A)await Cn(()=>Ve(Q,N));k.target.value=""}const gs=()=>{document.title=o(g),window.print()};let Ct=L();Hi(async()=>{o(Ct)?.focus(),z(ie,await Jr(o(h))),await Qe(),await Ge()}),Za(Tl);let xe=L(Number(localStorage.getItem("zine:left_percent")??48)),Ln=!1,wr=0,xr=o(xe);function _s(k){Ln=!0,wr=k.clientX,xr=o(xe),window.addEventListener("mousemove",yr),window.addEventListener("mouseup",Sr)}function yr(k){if(!Ln)return;const N=document.querySelector(".workspace")?.clientWidth||1,Q=(k.clientX-wr)/N*100;z(xe,Math.max(20,Math.min(80,Math.round((xr+Q)*10)/10)))}function Sr(){Ln=!1,window.removeEventListener("mousemove",yr),window.removeEventListener("mouseup",Sr)}function vs(k,N){const A=k.lastIndexOf(`

`,Math.max(0,N-1)),Q=k.indexOf(`

`,N),se=A>=0?A+2:0,Re=Q>=0?Q:k.length;return[se,Re]}function Er(k){const N=o(Ct),A=N?.selectionStart??o(m).length,Q=N?.selectionEnd??o(m).length;let se=A,Re=Q;se===Re&&([se,Re]=vs(o(m),se));let Lr=o(m).slice(0,se),pt=o(m).slice(se,Re),Ss=o(m).slice(Re);const Es=/^<span style="font-size:([\d.]+)em">([\s\S]*)<\/span>$/,Nn=pt.match(Es);if(Nn){let Lt=parseFloat(Nn[1]);const zs=Nn[2];pt=`<span style="font-size:${Math.max(.5,Math.min(4,Lt+k))}em">${zs}</span>`}else pt=`<span style="font-size:${1+k}em">${pt}</span>`;z(m,Lr+pt+Ss),qt().then(()=>{const Lt=(Lr+pt).length;N?.setSelectionRange(Lt,Lt),N?.focus()})}const ms=()=>Er(-.1),bs=()=>Er(.1);G(()=>o(g),()=>{localStorage.setItem("zine:title",o(g))}),G(()=>o(p),()=>{localStorage.setItem("zine:page_size",o(p))}),G(()=>o(_),()=>{localStorage.setItem("zine:margins",JSON.stringify(o(_)))}),G(()=>o(m),()=>{localStorage.setItem("zine:markdown",o(m))}),G(()=>o(b),()=>{localStorage.setItem("zine:columns",String(o(b)))}),G(()=>o(v),()=>{localStorage.setItem("zine:column_gap",String(o(v)))}),G(()=>o(x),()=>{localStorage.setItem("zine:font_family",o(x))}),G(()=>o(R),()=>{localStorage.setItem("zine:base_font_pt",String(o(R)))}),G(()=>o(T),()=>{localStorage.setItem("zine:line_height",String(o(T)))}),G(()=>o(y),()=>{localStorage.setItem("zine:justify",o(y))}),G(()=>o(S),()=>{localStorage.setItem("zine:hyphens",o(S))}),G(()=>o(I),()=>{localStorage.setItem("zine:print_mode",o(I))}),G(()=>o($),()=>{localStorage.setItem("zine:spread_gutter",String(o($)))}),G(()=>o(B),()=>{localStorage.setItem("zine:zoom",String(o(B)))}),G(()=>o(F),()=>{localStorage.setItem("zine:arrangement",o(F))}),G(()=>o(B),()=>{z(n,Math.max(10,Math.min(400,o(B)))/100)}),G(()=>o(p),()=>{z(i,nn[o(p)]??nn.A7)}),G(()=>(o(i),Ie),()=>{z(r,{w:Math.round(o(i).w*Ie),h:Math.round(o(i).h*Ie)})}),G(()=>(o(_),Ie),()=>{z(s,{top:Math.round(o(_).top*Ie),right:Math.round(o(_).right*Ie),bottom:Math.round(o(_).bottom*Ie),left:Math.round(o(_).left*Ie)})}),G(()=>o(R),()=>{z(a,Math.round(o(R)*lt*100)/100)}),G(()=>(o(x),o(a),o(T),o(y),o(S)),()=>{z(l,`
    font-family:${o(x)};
    font-size:${o(a)}px;
    line-height:${o(T)};
    text-align:${o(y)==="justify"?"justify":"left"};
    hyphens:${o(S)};
  `)}),G(()=>(o(r),o(_),o(x)),()=>{z(u,`
    width:${o(r).w}px;
    height:${o(r).h}px;
    --margin-bottom:${o(_).bottom};
    font-family:${o(x)};
  `)}),G(()=>(o(s),o(b),o(v),o(l)),()=>{z(c,`
    padding:${o(s).top}px ${o(s).right}px ${o(s).bottom}px ${o(s).left}px;
    --pad-top:${o(s).top}px; --pad-right:${o(s).right}px; --pad-bottom:${o(s).bottom}px; --pad-left:${o(s).left}px;
    column-count:${o(b)}; column-gap:${o(v)}mm;
    ${o(l)}
  `)}),G(()=>(o(r),o(s),o(l)),()=>{z(f,`
    position:absolute; left:-99999px; top:0; opacity:0; pointer-events:none;
    width:${o(r).w-(o(s).left+o(s).right)}px;
    ${o(l)}
  `)}),G(()=>o(m),()=>{z(h,vo(o(m)))}),G(()=>(o(h),o(r),o(b),o(v),o(s),o(a),o(T),o(y),o(S),o(x),o(I),o($),o(i),o(F)),()=>{o(h),o(r).h,o(r).w,o(b),o(v),o(s).top,o(s).right,o(s).bottom,o(s).left,o(a),o(T),o(y),o(S),o(x),o(I),o($),o(i).id,o(F),Qe()}),G(()=>o(xe),()=>{localStorage.setItem("zine:left_percent",String(o(xe)))}),ya(),Xt();var zr=To(),Ar=Zt(zr);Ya(Ar,{get page_sizes(){return nn},get title(){return o(g)},set title(k){z(g,k)},get page_size(){return o(p)},set page_size(k){z(p,k)},get margins(){return o(_)},set margins(k){z(_,k)},get columns(){return o(b)},set columns(k){z(b,k)},get column_gap(){return o(v)},set column_gap(k){z(v,k)},$$legacy:!0});var Tr=w(Ar,2),Rr=E(Tr);Ja(Rr,{make_smaller:ms,make_larger:bs,get font_family(){return o(x)},set font_family(k){z(x,k)},get base_font_pt(){return o(R)},set base_font_pt(k){z(R,k)},get line_height(){return o(T)},set line_height(k){z(T,k)},get justify(){return o(y)},set justify(k){z(y,k)},get hyphens(){return o(S)},set hyphens(k){z(S,k)},$$legacy:!0});var ks=w(Rr,2);tl(ks,{on_export_book:ct,on_import_book:qe,print_pdf:gs,insert_head:Pn,insert_foot:Kt,insert_col_break:$n,insert_row_break:D,insert_page_break:Y,on_image_input:ds,get print_mode(){return o(I)},set print_mode(k){z(I,k)},get spread_gutter(){return o($)},set spread_gutter(k){z($,k)},get arrangement(){return o(F)},set arrangement(k){z(F,k)},get preview_zoom(){return o(B)},set preview_zoom(k){z(B,k)},$$legacy:!0});var Ir=w(Tr,2),$r=E(Ir);rl($r,{get storage_text(){return o(pe)},get pages_len(){return o(Z),q(()=>o(Z).length)},get columns(){return o(b)},on_paste:hs,on_drop:fs,prevent:ps,get markdown(){return o(m)},set markdown(k){z(m,k)},get taEl(){return o(Ct)},set taEl(k){z(Ct,k)},$$legacy:!0});var Pr=w($r,2);pl(Pr,{onDown:_s});var ws=w(Pr,2),en=E(ws),xs=E(en);jt(xs,()=>o(ie)),gn(en,k=>z(ee,k),()=>o(ee));var Cr=w(en,2);al(Cr,{get pages(){return o(Z)},get run_heads(){return o(V)},get run_foots(){return o(oe)},get page_style(){return o(u)},get inner_style(){return o(c)},get zoom_scale(){return o(n)}});var ys=w(Cr,2);cl(ys,{get print_mode(){return o(I)},get pages(){return o(Z)},get sheets(){return o(X)},get sheet_idxs(){return o(U)},get inner_style(){return o(c)},get run_heads(){return o(V)},get run_foots(){return o(oe)}}),re(()=>{Ue(Ir,`grid-template-columns:${o(xe)}% 8px ${100-o(xe)}%`),Ue(en,o(f))}),ne(e,zr),Rt()}Na(Ro,{target:document.getElementById("app")});
