(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();const Wi=!1;var an=Array.isArray,sl=Array.prototype.indexOf,Un=Array.from,Ln=Object.defineProperty,zt=Object.getOwnPropertyDescriptor,al=Object.getOwnPropertyDescriptors,ll=Object.prototype,ol=Array.prototype,Qi=Object.getPrototypeOf,xi=Object.isExtensible;function cl(e){return e()}function Vt(e){for(var t=0;t<e.length;t++)e[t]()}function ul(){var e,t,n=new Promise((i,r)=>{e=i,t=r});return{promise:n,resolve:e,reject:t}}const le=2,Zn=4,ln=8,Nt=16,Pe=32,Ke=64,Vi=128,pe=256,Yt=512,J=1024,he=2048,Le=4096,me=8192,ht=16384,Gn=32768,Wn=65536,yi=1<<17,fl=1<<18,Qn=1<<19,Vn=1<<20,Nn=1<<21,Yn=1<<22,We=1<<23,De=Symbol("$state"),Xn=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function pl(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function Yi(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function hl(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function dl(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function gl(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function vl(e){throw new Error("https://svelte.dev/e/effect_orphan")}function _l(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function ml(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function bl(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function kl(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const on=1,cn=2,Xi=4,wl=8,xl=16,yl=1,Sl=2,X=Symbol();function $l(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}let El=!1;function Ji(e){return e===this.v}function Al(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function Ki(e){return!Al(e,this.v)}let Mt=!1,zl=!1;function Tl(){Mt=!0}let G=null;function Xt(e){G=e}function es(e,t=!1,n){G={p:G,c:null,e:null,s:e,x:null,l:Mt&&!t?{s:null,u:null,$:[]}:null}}function ts(e){var t=G,n=t.e;if(n!==null){t.e=null;for(var i of n)ms(i)}return G=t.p,{}}function dt(){return!Mt||G!==null&&G.l===null}const Rl=new WeakMap;function Il(e){var t=L;if(t===null)return N.f|=We,e;if((t.f&Gn)===0){if((t.f&Vi)===0)throw!t.parent&&e instanceof Error&&ns(e),e;t.b.error(e)}else Jn(e,t)}function Jn(e,t){for(;t!==null;){if((t.f&Vi)!==0)try{t.b.error(e);return}catch(n){e=n}t=t.parent}throw e instanceof Error&&ns(e),e}function ns(e){const t=Rl.get(e);t&&(Ln(e,"message",{value:t.message}),Ln(e,"stack",{value:t.stack}))}let It=[],Mn=[];function rs(){var e=It;It=[],Vt(e)}function Cl(){var e=Mn;Mn=[],Vt(e)}function Kn(e){It.length===0&&queueMicrotask(rs),It.push(e)}function Pl(){It.length>0&&rs(),Mn.length>0&&Cl()}function Ll(){for(var e=L.b;e!==null&&!e.has_pending_snippet();)e=e.parent;return e===null&&pl(),e}function er(e){var t=le|he,n=N!==null&&(N.f&le)!==0?N:null;return L===null||n!==null&&(n.f&pe)!==0?t|=pe:L.f|=Qn,{ctx:G,deps:null,effects:null,equals:Ji,f:t,fn:e,reactions:null,rv:0,v:X,wv:0,parent:n??L,ac:null}}function Nl(e,t){let n=L;n===null&&hl();var i=n.b,r=void 0,s=Ct(X),a=null,o=!N;return Vl(()=>{try{var c=e()}catch(_){c=Promise.reject(_)}var u=()=>c;r=a?.then(u,u)??Promise.resolve(c),a=r;var f=B,p=i.pending;o&&(i.update_pending_count(1),p||f.increment());const d=(_,h=void 0)=>{a=null,p||f.activate(),h?h!==Xn&&(s.f|=We,pt(s,h)):((s.f&We)!==0&&(s.f^=We),pt(s,_)),o&&(i.update_pending_count(-1),p||f.decrement()),ls()};if(r.then(d,_=>d(null,_||"unknown")),f)return()=>{queueMicrotask(()=>f.neuter())}}),new Promise(c=>{function u(f){function p(){f===r?c(s):u(r)}f.then(p,p)}u(r)})}function is(e){const t=er(e);return t.equals=Ki,t}function ss(e){var t=e.effects;if(t!==null){e.effects=null;for(var n=0;n<t.length;n+=1)Ce(t[n])}}function Ml(e){for(var t=e.parent;t!==null;){if((t.f&le)===0)return t;t=t.parent}return null}function tr(e){var t,n=L;Be(Ml(e));try{ss(e),t=Rs(e)}finally{Be(n)}return t}function as(e){var t=tr(e);if(e.equals(t)||(e.v=t,e.wv=zs()),!gt)if(ut!==null)ut.set(e,e.v);else{var n=(je||(e.f&pe)!==0)&&e.deps!==null?Le:J;ne(e,n)}}function ql(e,t,n){const i=dt()?er:is;if(t.length===0){n(e.map(i));return}var r=B,s=L,a=Ol(),o=Ll();Promise.all(t.map(c=>Nl(c))).then(c=>{r?.activate(),a();try{n([...e.map(i),...c])}catch(u){(s.f&ht)===0&&Jn(u,s)}r?.deactivate(),ls()}).catch(c=>{o.error(c)})}function Ol(){var e=L,t=N,n=G;return function(){Be(e),Se(t),Xt(n)}}function ls(){Be(null),Se(null),Xt(null)}const _t=new Set;let B=null,Gt=null,ut=null,Si=new Set,Jt=[];function os(){const e=Jt.shift();Jt.length>0&&queueMicrotask(os),e()}let Ye=[],un=null,qn=!1,Wt=!1;class ft{current=new Map;#i=new Map;#s=new Set;#e=0;#c=null;#u=!1;#n=[];#a=[];#r=[];#t=[];#l=[];#f=[];#p=[];skipped_effects=new Set;process(t){Ye=[],Gt=null;var n=null;if(_t.size>1){n=new Map,ut=new Map;for(const[s,a]of this.current)n.set(s,{v:s.v,wv:s.wv}),s.v=a;for(const s of _t)if(s!==this)for(const[a,o]of s.#i)n.has(a)||(n.set(a,{v:a.v,wv:a.wv}),a.v=o)}for(const s of t)this.#d(s);if(this.#n.length===0&&this.#e===0){this.#h();var i=this.#r,r=this.#t;this.#r=[],this.#t=[],this.#l=[],Gt=B,B=null,$i(i),$i(r),B===null?B=this:_t.delete(this),this.#c?.resolve()}else this.#o(this.#r),this.#o(this.#t),this.#o(this.#l);if(n){for(const[s,{v:a,wv:o}]of n)s.wv<=o&&(s.v=a);ut=null}for(const s of this.#n)ot(s);for(const s of this.#a)ot(s);this.#n=[],this.#a=[]}#d(t){t.f^=J;for(var n=t.first;n!==null;){var i=n.f,r=(i&(Pe|Ke))!==0,s=r&&(i&J)!==0,a=s||(i&me)!==0||this.skipped_effects.has(n);if(!a&&n.fn!==null){if(r)n.f^=J;else if((i&J)===0)if((i&Zn)!==0)this.#t.push(n);else if((i&Yn)!==0){var o=n.b?.pending?this.#a:this.#n;o.push(n)}else Ot(n)&&((n.f&Nt)!==0&&this.#l.push(n),ot(n));var c=n.first;if(c!==null){n=c;continue}}var u=n.parent;for(n=n.next;n===null&&u!==null;)n=u.next,u=u.parent}}#o(t){for(const n of t)((n.f&he)!==0?this.#f:this.#p).push(n),ne(n,J);t.length=0}capture(t,n){this.#i.has(t)||this.#i.set(t,n),this.current.set(t,t.v)}activate(){B=this}deactivate(){B=null,Gt=null;for(const t of Si)if(Si.delete(t),t(),B!==null)break}neuter(){this.#u=!0}flush(){Ye.length>0?cs():this.#h(),B===this&&(this.#e===0&&_t.delete(this),this.deactivate())}#h(){if(!this.#u)for(const t of this.#s)t();this.#s.clear()}increment(){this.#e+=1}decrement(){if(this.#e-=1,this.#e===0){for(const t of this.#f)ne(t,he),Xe(t);for(const t of this.#p)ne(t,Le),Xe(t);this.#r=[],this.#t=[],this.flush()}else this.deactivate()}add_callback(t){this.#s.add(t)}settled(){return(this.#c??=ul()).promise}static ensure(){if(B===null){const t=B=new ft;_t.add(B),Wt||ft.enqueue(()=>{B===t&&t.flush()})}return B}static enqueue(t){Jt.length===0&&queueMicrotask(os),Jt.unshift(t)}}function jl(e){var t=Wt;Wt=!0;try{for(var n;;){if(Pl(),Ye.length===0&&(B?.flush(),Ye.length===0))return un=null,n;cs()}}finally{Wt=t}}function cs(){var e=lt;qn=!0;try{var t=0;for(Ti(!0);Ye.length>0;){var n=ft.ensure();if(t++>1e3){var i,r;Dl()}n.process(Ye),Qe.clear()}}finally{qn=!1,Ti(e),un=null}}function Dl(){try{_l()}catch(e){Jn(e,un)}}function $i(e){var t=e.length;if(t!==0){for(var n=0;n<t;){var i=e[n++];if((i.f&(ht|me))===0&&Ot(i)){var r=B?B.current.size:0;if(ot(i),i.deps===null&&i.first===null&&i.nodes_start===null&&(i.teardown===null&&i.ac===null?Ss(i):i.fn=null),B!==null&&B.current.size>r&&(i.f&Vn)!==0)break}}for(;n<t;)Xe(e[n++])}}function Xe(e){for(var t=un=e;t.parent!==null;){t=t.parent;var n=t.f;if(qn&&t===L&&(n&Nt)!==0)return;if((n&(Ke|Pe))!==0){if((n&J)===0)return;t.f^=J}}Ye.push(t)}const Qe=new Map;function Ct(e,t){var n={f:0,v:e,reactions:null,equals:Ji,rv:0,wv:0};return n}function qe(e,t){const n=Ct(e);return Jl(n),n}function P(e,t=!1,n=!0){const i=Ct(e);return t||(i.equals=Ki),Mt&&n&&G!==null&&G.l!==null&&(G.l.s??=[]).push(i),i}function Ut(e,t){return w(e,U(()=>l(e))),t}function w(e,t,n=!1){N!==null&&(!ye||(N.f&yi)!==0)&&dt()&&(N.f&(le|Nt|Yn|yi))!==0&&!Ie?.includes(e)&&kl();let i=n?Et(t):t;return pt(e,i)}function pt(e,t){if(!e.equals(t)){var n=e.v;gt?Qe.set(e,t):Qe.set(e,n),e.v=t;var i=ft.ensure();i.capture(e,n),(e.f&le)!==0&&((e.f&he)!==0&&tr(e),ne(e,(e.f&pe)===0?J:Le)),e.wv=zs(),us(e,he),dt()&&L!==null&&(L.f&J)!==0&&(L.f&(Pe|Ke))===0&&(fe===null?Kl([e]):fe.push(e))}return t}function Tn(e){w(e,e.v+1)}function us(e,t){var n=e.reactions;if(n!==null)for(var i=dt(),r=n.length,s=0;s<r;s++){var a=n[s],o=a.f;if(!(!i&&a===L)){var c=(o&he)===0;c&&ne(a,t),(o&le)!==0?us(a,Le):c&&Xe(a)}}}function Et(e){if(typeof e!="object"||e===null||De in e)return e;const t=Qi(e);if(t!==ll&&t!==ol)return e;var n=new Map,i=an(e),r=qe(0),s=Ve,a=o=>{if(Ve===s)return o();var c=N,u=Ve;Se(null),Ii(s);var f=o();return Se(c),Ii(u),f};return i&&n.set("length",qe(e.length)),new Proxy(e,{defineProperty(o,c,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&ml();var f=n.get(c);return f===void 0?f=a(()=>{var p=qe(u.value);return n.set(c,p),p}):w(f,u.value,!0),!0},deleteProperty(o,c){var u=n.get(c);if(u===void 0){if(c in o){const f=a(()=>qe(X));n.set(c,f),Tn(r)}}else w(u,X),Tn(r);return!0},get(o,c,u){if(c===De)return e;var f=n.get(c),p=c in o;if(f===void 0&&(!p||zt(o,c)?.writable)&&(f=a(()=>{var _=Et(p?o[c]:X),h=qe(_);return h}),n.set(c,f)),f!==void 0){var d=l(f);return d===X?void 0:d}return Reflect.get(o,c,u)},getOwnPropertyDescriptor(o,c){var u=Reflect.getOwnPropertyDescriptor(o,c);if(u&&"value"in u){var f=n.get(c);f&&(u.value=l(f))}else if(u===void 0){var p=n.get(c),d=p?.v;if(p!==void 0&&d!==X)return{enumerable:!0,configurable:!0,value:d,writable:!0}}return u},has(o,c){if(c===De)return!0;var u=n.get(c),f=u!==void 0&&u.v!==X||Reflect.has(o,c);if(u!==void 0||L!==null&&(!f||zt(o,c)?.writable)){u===void 0&&(u=a(()=>{var d=f?Et(o[c]):X,_=qe(d);return _}),n.set(c,u));var p=l(u);if(p===X)return!1}return f},set(o,c,u,f){var p=n.get(c),d=c in o;if(i&&c==="length")for(var _=u;_<p.v;_+=1){var h=n.get(_+"");h!==void 0?w(h,X):_ in o&&(h=a(()=>qe(X)),n.set(_+"",h))}if(p===void 0)(!d||zt(o,c)?.writable)&&(p=a(()=>qe(void 0)),w(p,Et(u)),n.set(c,p));else{d=p.v!==X;var v=a(()=>Et(u));w(p,v)}var m=Reflect.getOwnPropertyDescriptor(o,c);if(m?.set&&m.set.call(f,u),!d){if(i&&typeof c=="string"){var S=n.get("length"),E=Number(c);Number.isInteger(E)&&E>=S.v&&w(S,E+1)}Tn(r)}return!0},ownKeys(o){l(r);var c=Reflect.ownKeys(o).filter(p=>{var d=n.get(p);return d===void 0||d.v!==X});for(var[u,f]of n)f.v!==X&&!(u in o)&&c.push(u);return c},setPrototypeOf(){bl()}})}function Ei(e){try{if(e!==null&&typeof e=="object"&&De in e)return e[De]}catch{}return e}function Bl(e,t){return Object.is(Ei(e),Ei(t))}var Ai,fs,ps,hs;function Fl(){if(Ai===void 0){Ai=window,fs=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;ps=zt(t,"firstChild").get,hs=zt(t,"nextSibling").get,xi(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),xi(n)&&(n.__t=void 0)}}function qt(e=""){return document.createTextNode(e)}function Oe(e){return ps.call(e)}function fn(e){return hs.call(e)}function y(e,t){return Oe(e)}function Rn(e,t){{var n=Oe(e);return n instanceof Comment&&n.data===""?fn(n):n}}function k(e,t=1,n=!1){let i=e;for(;t--;)i=fn(i);return i}function Hl(e){e.textContent=""}function ds(){return!1}let zi=!1;function Ul(){zi||(zi=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function pn(e){var t=N,n=L;Se(null),Be(null);try{return e()}finally{Se(t),Be(n)}}function gs(e,t,n,i=n){e.addEventListener(t,()=>pn(n));const r=e.__on_r;r?e.__on_r=()=>{r(),i(!0)}:e.__on_r=()=>i(!0),Ul()}function vs(e){L===null&&N===null&&vl(),N!==null&&(N.f&pe)!==0&&L===null&&gl(),gt&&dl()}function Zl(e,t){var n=t.last;n===null?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}function Ee(e,t,n,i=!0){var r=L;r!==null&&(r.f&me)!==0&&(e|=me);var s={ctx:G,deps:null,nodes_start:null,nodes_end:null,f:e|he,first:null,fn:t,last:null,next:null,parent:r,b:r&&r.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(n)try{ot(s),s.f|=Gn}catch(c){throw Ce(s),c}else t!==null&&Xe(s);var a=n&&s.deps===null&&s.first===null&&s.nodes_start===null&&s.teardown===null&&(s.f&Qn)===0;if(!a&&i&&(r!==null&&Zl(s,r),N!==null&&(N.f&le)!==0&&(e&Ke)===0)){var o=N;(o.effects??=[]).push(s)}return s}function _s(e){const t=Ee(ln,null,!1);return ne(t,J),t.teardown=e,t}function On(e){vs();var t=L.f,n=!N&&(t&Pe)!==0&&(t&Gn)===0;if(n){var i=G;(i.e??=[]).push(e)}else return ms(e)}function ms(e){return Ee(Zn|Vn,e,!1)}function Gl(e){return vs(),Ee(ln|Vn,e,!0)}function Wl(e){ft.ensure();const t=Ee(Ke,e,!0);return(n={})=>new Promise(i=>{n.outro?nr(t,()=>{Ce(t),i(void 0)}):(Ce(t),i(void 0))})}function bs(e){return Ee(Zn,e,!1)}function F(e,t){var n=G,i={effect:null,ran:!1,deps:e};n.l.$.push(i),i.effect=hn(()=>{e(),!i.ran&&(i.ran=!0,U(t))})}function Ql(){var e=G;hn(()=>{for(var t of e.l.$){t.deps();var n=t.effect;(n.f&J)!==0&&ne(n,Le),Ot(n)&&ot(n),t.ran=!1}})}function Vl(e){return Ee(Yn|Qn,e,!0)}function hn(e,t=0){return Ee(ln|t,e,!0)}function _e(e,t=[],n=[]){ql(t,n,i=>{Ee(ln,()=>e(...i.map(l)),!0)})}function ks(e,t=0){var n=Ee(Nt|t,e,!0);return n}function Pt(e,t=!0){return Ee(Pe,e,!0,t)}function ws(e){var t=e.teardown;if(t!==null){const n=gt,i=N;Ri(!0),Se(null);try{t.call(null)}finally{Ri(n),Se(i)}}}function xs(e,t=!1){var n=e.first;for(e.first=e.last=null;n!==null;){const r=n.ac;r!==null&&pn(()=>{r.abort(Xn)});var i=n.next;(n.f&Ke)!==0?n.parent=null:Ce(n,t),n=i}}function Yl(e){for(var t=e.first;t!==null;){var n=t.next;(t.f&Pe)===0&&Ce(t),t=n}}function Ce(e,t=!0){var n=!1;(t||(e.f&fl)!==0)&&e.nodes_start!==null&&e.nodes_end!==null&&(ys(e.nodes_start,e.nodes_end),n=!0),xs(e,t&&!n),Kt(e,0),ne(e,ht);var i=e.transitions;if(i!==null)for(const s of i)s.stop();ws(e);var r=e.parent;r!==null&&r.first!==null&&Ss(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=e.ac=null}function ys(e,t){for(;e!==null;){var n=e===t?null:fn(e);e.remove(),e=n}}function Ss(e){var t=e.parent,n=e.prev,i=e.next;n!==null&&(n.next=i),i!==null&&(i.prev=n),t!==null&&(t.first===e&&(t.first=i),t.last===e&&(t.last=n))}function nr(e,t){var n=[];rr(e,n,!0),$s(n,()=>{Ce(e),t&&t()})}function $s(e,t){var n=e.length;if(n>0){var i=()=>--n||t();for(var r of e)r.out(i)}else t()}function rr(e,t,n){if((e.f&me)===0){if(e.f^=me,e.transitions!==null)for(const a of e.transitions)(a.is_global||n)&&t.push(a);for(var i=e.first;i!==null;){var r=i.next,s=(i.f&Wn)!==0||(i.f&Pe)!==0;rr(i,t,s?n:!1),i=r}}}function ir(e){Es(e,!0)}function Es(e,t){if((e.f&me)!==0){e.f^=me,(e.f&J)===0&&(ne(e,he),Xe(e));for(var n=e.first;n!==null;){var i=n.next,r=(n.f&Wn)!==0||(n.f&Pe)!==0;Es(n,r?t:!1),n=i}if(e.transitions!==null)for(const s of e.transitions)(s.is_global||t)&&s.in()}}let at=null;function Xl(e){var t=at;try{if(at=new Set,U(e),t!==null)for(var n of at)t.add(n);return at}finally{at=t}}function mt(e){for(var t of Xl(e))pt(t,t.v)}let lt=!1;function Ti(e){lt=e}let gt=!1;function Ri(e){gt=e}let N=null,ye=!1;function Se(e){N=e}let L=null;function Be(e){L=e}let Ie=null;function Jl(e){N!==null&&(Ie===null?Ie=[e]:Ie.push(e))}let ee=null,ae=0,fe=null;function Kl(e){fe=e}let As=1,Lt=0,Ve=Lt;function Ii(e){Ve=e}let je=!1;function zs(){return++As}function Ot(e){var t=e.f;if((t&he)!==0)return!0;if((t&Le)!==0){var n=e.deps,i=(t&pe)!==0;if(n!==null){var r,s,a=(t&Yt)!==0,o=i&&L!==null&&!je,c=n.length;if((a||o)&&(L===null||(L.f&ht)===0)){var u=e,f=u.parent;for(r=0;r<c;r++)s=n[r],(a||!s?.reactions?.includes(u))&&(s.reactions??=[]).push(u);a&&(u.f^=Yt),o&&f!==null&&(f.f&pe)===0&&(u.f^=pe)}for(r=0;r<c;r++)if(s=n[r],Ot(s)&&as(s),s.wv>e.wv)return!0}(!i||L!==null&&!je)&&ne(e,J)}return!1}function Ts(e,t,n=!0){var i=e.reactions;if(i!==null&&!Ie?.includes(e))for(var r=0;r<i.length;r++){var s=i[r];(s.f&le)!==0?Ts(s,t,!1):t===s&&(n?ne(s,he):(s.f&J)!==0&&ne(s,Le),Xe(s))}}function Rs(e){var t=ee,n=ae,i=fe,r=N,s=je,a=Ie,o=G,c=ye,u=Ve,f=e.f;ee=null,ae=0,fe=null,je=(f&pe)!==0&&(ye||!lt||N===null),N=(f&(Pe|Ke))===0?e:null,Ie=null,Xt(e.ctx),ye=!1,Ve=++Lt,e.ac!==null&&(pn(()=>{e.ac.abort(Xn)}),e.ac=null);try{e.f|=Nn;var p=e.fn,d=p(),_=e.deps;if(ee!==null){var h;if(Kt(e,ae),_!==null&&ae>0)for(_.length=ae+ee.length,h=0;h<ee.length;h++)_[ae+h]=ee[h];else e.deps=_=ee;if(!je||(f&le)!==0&&e.reactions!==null)for(h=ae;h<_.length;h++)(_[h].reactions??=[]).push(e)}else _!==null&&ae<_.length&&(Kt(e,ae),_.length=ae);if(dt()&&fe!==null&&!ye&&_!==null&&(e.f&(le|Le|he))===0)for(h=0;h<fe.length;h++)Ts(fe[h],e);return r!==null&&r!==e&&(Lt++,fe!==null&&(i===null?i=fe:i.push(...fe))),(e.f&We)!==0&&(e.f^=We),d}catch(v){return Il(v)}finally{e.f^=Nn,ee=t,ae=n,fe=i,N=r,je=s,Ie=a,Xt(o),ye=c,Ve=u}}function eo(e,t){let n=t.reactions;if(n!==null){var i=sl.call(n,e);if(i!==-1){var r=n.length-1;r===0?n=t.reactions=null:(n[i]=n[r],n.pop())}}n===null&&(t.f&le)!==0&&(ee===null||!ee.includes(t))&&(ne(t,Le),(t.f&(pe|Yt))===0&&(t.f^=Yt),ss(t),Kt(t,0))}function Kt(e,t){var n=e.deps;if(n!==null)for(var i=t;i<n.length;i++)eo(e,n[i])}function ot(e){var t=e.f;if((t&ht)===0){ne(e,J);var n=L,i=lt;L=e,lt=!0;try{(t&Nt)!==0?Yl(e):xs(e),ws(e);var r=Rs(e);e.teardown=typeof r=="function"?r:null,e.wv=As;var s;Wi&&zl&&(e.f&he)!==0&&e.deps}finally{lt=i,L=n}}}async function Ge(){await Promise.resolve(),jl()}function l(e){var t=e.f,n=(t&le)!==0;if(at?.add(e),N!==null&&!ye){var i=L!==null&&(L.f&ht)!==0;if(!i&&!Ie?.includes(e)){var r=N.deps;if((N.f&Nn)!==0)e.rv<Lt&&(e.rv=Lt,ee===null&&r!==null&&r[ae]===e?ae++:ee===null?ee=[e]:(!je||!ee.includes(e))&&ee.push(e));else{(N.deps??=[]).push(e);var s=e.reactions;s===null?e.reactions=[N]:s.includes(N)||s.push(N)}}}else if(n&&e.deps===null&&e.effects===null){var a=e,o=a.parent;o!==null&&(o.f&pe)===0&&(a.f^=pe)}if(gt){if(Qe.has(e))return Qe.get(e);if(n){a=e;var c=a.v;return((a.f&J)===0&&a.reactions!==null||Is(a))&&(c=tr(a)),Qe.set(a,c),c}}else if(n){if(a=e,ut?.has(a))return ut.get(a);Ot(a)&&as(a)}if((e.f&We)!==0)throw e.v;return e.v}function Is(e){if(e.v===X)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(Qe.has(t)||(t.f&le)!==0&&Is(t))return!0;return!1}function U(e){var t=ye;try{return ye=!0,e()}finally{ye=t}}const to=-7169;function ne(e,t){e.f=e.f&to|t}function Cs(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(De in e)jn(e);else if(!Array.isArray(e))for(let t in e){const n=e[t];typeof n=="object"&&n&&De in n&&jn(n)}}}function jn(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let i in e)try{jn(e[i],t)}catch{}const n=Qi(e);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const i=al(n);for(let r in i){const s=i[r].get;if(s)try{s.call(e)}catch{}}}}}const no=["touchstart","touchmove"];function ro(e){return no.includes(e)}const io=new Set,Ci=new Set;function so(e,t,n,i={}){function r(s){if(i.capture||At.call(t,s),!s.cancelBubble)return pn(()=>n?.call(this,s))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?Kn(()=>{t.addEventListener(e,r,i)}):t.addEventListener(e,r,i),r}function Z(e,t,n,i,r){var s={capture:i,passive:r},a=so(e,t,n,s);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&_s(()=>{t.removeEventListener(e,a,s)})}let Pi=null;function At(e){var t=this,n=t.ownerDocument,i=e.type,r=e.composedPath?.()||[],s=r[0]||e.target;Pi=e;var a=0,o=Pi===e&&e.__root;if(o){var c=r.indexOf(o);if(c!==-1&&(t===document||t===window)){e.__root=t;return}var u=r.indexOf(t);if(u===-1)return;c<=u&&(a=c)}if(s=r[a]||e.target,s!==t){Ln(e,"currentTarget",{configurable:!0,get(){return s||n}});var f=N,p=L;Se(null),Be(null);try{for(var d,_=[];s!==null;){var h=s.assignedSlot||s.parentNode||s.host||null;try{var v=s["__"+i];if(v!=null&&(!s.disabled||e.target===s))if(an(v)){var[m,...S]=v;m.apply(s,[e,...S])}else v.call(s,e)}catch(E){d?_.push(E):d=E}if(e.cancelBubble||h===t||h===null)break;s=h}if(d){for(let E of _)queueMicrotask(()=>{throw E});throw d}}finally{e.__root=t,delete e.currentTarget,Se(f),Be(p)}}}function Ps(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function en(e,t){var n=L;n.nodes_start===null&&(n.nodes_start=e,n.nodes_end=t)}function et(e,t){var n=(t&yl)!==0,i=(t&Sl)!==0,r,s=!e.startsWith("<!>");return()=>{r===void 0&&(r=Ps(s?e:"<!>"+e),n||(r=Oe(r)));var a=i||fs?document.importNode(r,!0):r.cloneNode(!0);if(n){var o=Oe(a),c=a.lastChild;en(o,c)}else en(a,a);return a}}function Li(){var e=document.createDocumentFragment(),t=document.createComment(""),n=qt();return e.append(t,n),en(t,n),e}function Ae(e,t){e!==null&&e.before(t)}function ce(e,t){var n=t==null?"":typeof t=="object"?t+"":t;n!==(e.__t??=e.nodeValue)&&(e.__t=n,e.nodeValue=n+"")}function ao(e,t){return lo(e,t)}const rt=new Map;function lo(e,{target:t,anchor:n,props:i={},events:r,context:s,intro:a=!0}){Fl();var o=new Set,c=p=>{for(var d=0;d<p.length;d++){var _=p[d];if(!o.has(_)){o.add(_);var h=ro(_);t.addEventListener(_,At,{passive:h});var v=rt.get(_);v===void 0?(document.addEventListener(_,At,{passive:h}),rt.set(_,1)):rt.set(_,v+1)}}};c(Un(io)),Ci.add(c);var u=void 0,f=Wl(()=>{var p=n??t.appendChild(qt());return Pt(()=>{if(s){es({});var d=G;d.c=s}r&&(i.$$events=r),u=e(p,i)||{},s&&ts()}),()=>{for(var d of o){t.removeEventListener(d,At);var _=rt.get(d);--_===0?(document.removeEventListener(d,At),rt.delete(d)):rt.set(d,_)}Ci.delete(c),p!==n&&p.parentNode?.removeChild(p)}});return oo.set(u,f),u}let oo=new WeakMap;function Ni(e,t,n=!1){var i=e,r=null,s=null,a=X,o=n?Wn:0,c=!1;const u=(_,h=!0)=>{c=!0,d(h,_)};var f=null;function p(){f!==null&&(f.lastChild.remove(),i.before(f),f=null);var _=a?r:s,h=a?s:r;_&&ir(_),h&&nr(h,()=>{a?s=null:r=null})}const d=(_,h)=>{if(a!==(a=_)){var v=ds(),m=i;if(v&&(f=document.createDocumentFragment(),f.append(m=qt())),a?r??=h&&Pt(()=>h(m)):s??=h&&Pt(()=>h(m)),v){var S=B,E=a?r:s,z=a?s:r;E&&S.skipped_effects.delete(E),z&&S.skipped_effects.add(z),S.add_callback(p)}else p()}};ks(()=>{c=!1,t(u),c||d(null,null)},o)}function bt(e,t){return t}function co(e,t,n){for(var i=e.items,r=[],s=t.length,a=0;a<s;a++)rr(t[a].e,r,!0);var o=s>0&&r.length===0&&n!==null;if(o){var c=n.parentNode;Hl(c),c.append(n),i.clear(),xe(e,t[0].prev,t[s-1].next)}$s(r,()=>{for(var u=0;u<s;u++){var f=t[u];o||(i.delete(f.k),xe(e,f.prev,f.next)),Ce(f.e,!o)}})}function kt(e,t,n,i,r,s=null){var a=e,o={flags:t,items:new Map,first:null},c=(t&Xi)!==0;if(c){var u=e;a=u.appendChild(qt())}var f=null,p=!1,d=new Map,_=is(()=>{var S=n();return an(S)?S:S==null?[]:Un(S)}),h,v;function m(){uo(v,h,o,d,a,r,t,i,n),s!==null&&(h.length===0?f?ir(f):f=Pt(()=>s(a)):f!==null&&nr(f,()=>{f=null}))}ks(()=>{v??=L,h=l(_);var S=h.length;if(!(p&&S===0)){p=S===0;var E,z,j,R;if(ds()){var $=new Set,A=B;for(z=0;z<S;z+=1){j=h[z],R=i(j,z);var I=o.items.get(R)??d.get(R);I?(t&(on|cn))!==0&&Ls(I,j,z,t):(E=Ns(null,o,null,null,j,R,z,r,t,n,!0),d.set(R,E)),$.add(R)}for(const[C,Q]of o.items)$.has(C)||A.skipped_effects.add(Q.e);A.add_callback(m)}else m();l(_)}})}function uo(e,t,n,i,r,s,a,o,c){var u=(a&wl)!==0,f=(a&(on|cn))!==0,p=t.length,d=n.items,_=n.first,h=_,v,m=null,S,E=[],z=[],j,R,$,A;if(u)for(A=0;A<p;A+=1)j=t[A],R=o(j,A),$=d.get(R),$!==void 0&&($.a?.measure(),(S??=new Set).add($));for(A=0;A<p;A+=1){if(j=t[A],R=o(j,A),$=d.get(R),$===void 0){var I=i.get(R);if(I!==void 0){i.delete(R),d.set(R,I);var C=m?m.next:h;xe(n,m,I),xe(n,I,C),In(I,C,r),m=I}else{var Q=h?h.e.nodes_start:r;m=Ns(Q,n,m,m===null?n.first:m.next,j,R,A,s,a,c)}d.set(R,m),E=[],z=[],h=m.next;continue}if(f&&Ls($,j,A,a),($.e.f&me)!==0&&(ir($.e),u&&($.a?.unfix(),(S??=new Set).delete($))),$!==h){if(v!==void 0&&v.has($)){if(E.length<z.length){var de=z[0],H;m=de.prev;var Ne=E[0],ge=E[E.length-1];for(H=0;H<E.length;H+=1)In(E[H],de,r);for(H=0;H<z.length;H+=1)v.delete(z[H]);xe(n,Ne.prev,ge.next),xe(n,m,Ne),xe(n,ge,de),h=de,m=ge,A-=1,E=[],z=[]}else v.delete($),In($,h,r),xe(n,$.prev,$.next),xe(n,$,m===null?n.first:m.next),xe(n,m,$),m=$;continue}for(E=[],z=[];h!==null&&h.k!==R;)(h.e.f&me)===0&&(v??=new Set).add(h),z.push(h),h=h.next;if(h===null)continue;$=h}E.push($),m=$,h=$.next}if(h!==null||v!==void 0){for(var ve=v===void 0?[]:Un(v);h!==null;)(h.e.f&me)===0&&ve.push(h),h=h.next;var V=ve.length;if(V>0){var K=(a&Xi)!==0&&p===0?r:null;if(u){for(A=0;A<V;A+=1)ve[A].a?.measure();for(A=0;A<V;A+=1)ve[A].a?.fix()}co(n,ve,K)}}u&&Kn(()=>{if(S!==void 0)for($ of S)$.a?.apply()}),e.first=n.first&&n.first.e,e.last=m&&m.e;for(var ie of i.values())Ce(ie.e);i.clear()}function Ls(e,t,n,i){(i&on)!==0&&pt(e.v,t),(i&cn)!==0?pt(e.i,n):e.i=n}function Ns(e,t,n,i,r,s,a,o,c,u,f){var p=(c&on)!==0,d=(c&xl)===0,_=p?d?P(r,!1,!1):Ct(r):r,h=(c&cn)===0?a:Ct(a),v={i:h,v:_,k:s,a:null,e:null,prev:n,next:i};try{if(e===null){var m=document.createDocumentFragment();m.append(e=qt())}return v.e=Pt(()=>o(e,_,h,u),El),v.e.prev=n&&n.e,v.e.next=i&&i.e,n===null?f||(t.first=v):(n.next=v,n.e.next=v.e),i!==null&&(i.prev=v,i.e.prev=v.e),v}finally{}}function In(e,t,n){for(var i=e.next?e.next.e.nodes_start:n,r=t?t.e.nodes_start:n,s=e.e.nodes_start;s!==null&&s!==i;){var a=fn(s);r.before(s),s=a}}function xe(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}function wt(e,t,n=!1,i=!1,r=!1){var s=e,a="";_e(()=>{var o=L;if(a!==(a=t()??"")&&(o.nodes_start!==null&&(ys(o.nodes_start,o.nodes_end),o.nodes_start=o.nodes_end=null),a!=="")){var c=a+"";n?c=`<svg>${c}</svg>`:i&&(c=`<math>${c}</math>`);var u=Ps(c);if((n||i)&&(u=Oe(u)),en(Oe(u),u.lastChild),n||i)for(;Oe(u);)s.before(Oe(u));else s.before(u)}})}const Mi=[...` 	
\r\f \v\uFEFF`];function fo(e,t,n){var i=e==null?"":""+e;if(t&&(i=i?i+" "+t:t),n){for(var r in n)if(n[r])i=i?i+" "+r:r;else if(i.length)for(var s=r.length,a=0;(a=i.indexOf(r,a))>=0;){var o=a+s;(a===0||Mi.includes(i[a-1]))&&(o===i.length||Mi.includes(i[o]))?i=(a===0?"":i.substring(0,a))+i.substring(o+1):a=o}}return i===""?null:i}function po(e,t){return e==null?null:String(e)}function it(e,t,n,i,r,s){var a=e.__className;if(a!==n||a===void 0){var o=fo(n,i,s);o==null?e.removeAttribute("class"):e.className=o,e.__className=n}else if(s&&r!==s)for(var c in s){var u=!!s[c];(r==null||u!==!!r[c])&&e.classList.toggle(c,u)}return s}function xt(e,t,n,i){var r=e.__style;if(r!==t){var s=po(t);s==null?e.removeAttribute("style"):e.style.cssText=s,e.__style=t}return i}function Ms(e,t,n=!1){if(e.multiple){if(t==null)return;if(!an(t))return $l();for(var i of e.options)i.selected=t.includes(Tt(i));return}for(i of e.options){var r=Tt(i);if(Bl(r,t)){i.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function ho(e){var t=new MutationObserver(()=>{Ms(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),_s(()=>{t.disconnect()})}function yt(e,t,n=t){var i=!0;gs(e,"change",r=>{var s=r?"[selected]":":checked",a;if(e.multiple)a=[].map.call(e.querySelectorAll(s),Tt);else{var o=e.querySelector(s)??e.querySelector("option:not([disabled])");a=o&&Tt(o)}n(a)}),bs(()=>{var r=t();if(Ms(e,r,i),i&&r===void 0){var s=e.querySelector(":checked");s!==null&&(r=Tt(s),n(r))}e.__value=r,i=!1}),ho(e)}function Tt(e){return"__value"in e?e.__value:e.value}function ue(e,t,n=t){var i=dt(),r=new WeakSet;gs(e,"input",s=>{var a=s?e.defaultValue:e.value;if(a=Cn(e)?Pn(a):a,n(a),B!==null&&r.add(B),i&&a!==(a=t())){var o=e.selectionStart,c=e.selectionEnd;e.value=a??"",c!==null&&(e.selectionStart=o,e.selectionEnd=Math.min(c,e.value.length))}}),U(t)==null&&e.value&&(n(Cn(e)?Pn(e.value):e.value),B!==null&&r.add(B)),hn(()=>{var s=t();if(e===document.activeElement){var a=Gt??B;if(r.has(a))return}Cn(e)&&s===Pn(e.value)||e.type==="date"&&!s&&!e.value||s!==e.value&&(e.value=s??"")})}function Cn(e){var t=e.type;return t==="number"||t==="range"}function Pn(e){return e===""?null:+e}function qi(e,t){return e===t||e?.[De]===t}function Oi(e={},t,n,i){return bs(()=>{var r,s;return hn(()=>{r=s,s=[],U(()=>{e!==n(...s)&&(t(e,...s),r&&qi(n(...r),e)&&t(null,...r))})}),()=>{Kn(()=>{s&&qi(n(...s),e)&&t(null,...s)})}}),e}function go(e){return function(...t){var n=t[0];return n.preventDefault(),e?.apply(this,t)}}function vo(e=!1){const t=G,n=t.l.u;if(!n)return;let i=()=>Cs(t.s);if(e){let r=0,s={};const a=er(()=>{let o=!1;const c=t.s;for(const u in c)c[u]!==s[u]&&(s[u]=c[u],o=!0);return o&&r++,r});i=()=>l(a)}n.b.length&&Gl(()=>{ji(t,i),Vt(n.b)}),On(()=>{const r=U(()=>n.m.map(cl));return()=>{for(const s of r)typeof s=="function"&&s()}}),n.a.length&&On(()=>{ji(t,i),Vt(n.a)})}function ji(e,t){if(e.l.s)for(const n of e.l.s)l(n);t()}function qs(e){G===null&&Yi(),Mt&&G.l!==null?mo(G).m.push(e):On(()=>{const t=U(e);if(typeof t=="function")return t})}function _o(e){G===null&&Yi(),qs(()=>()=>U(e))}function mo(e){var t=e.l;return t.u??={a:[],b:[],m:[]}}const bo="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(bo);Tl();const ko="zine",wo=2,$e="images",Fe="images_meta";function tt(){return new Promise((e,t)=>{const n=indexedDB.open(ko,wo);n.onupgradeneeded=()=>{const i=n.result;i.objectStoreNames.contains($e)||i.createObjectStore($e),i.objectStoreNames.contains(Fe)||i.createObjectStore(Fe)},n.onsuccess=()=>e(n.result),n.onerror=()=>t(n.error)})}async function Os(e){const t=await tt();return new Promise((n,i)=>{const a=t.transaction($e,"readonly").objectStore($e).get(e);a.onsuccess=()=>n(a.result),a.onerror=()=>i(a.error)})}async function js(e,t){const n=await tt();return new Promise((i,r)=>{const o=n.transaction($e,"readwrite").objectStore($e).put(t,e);o.onsuccess=()=>i(!0),o.onerror=()=>r(o.error)})}async function Ds(e){const t=await tt();return new Promise((n,i)=>{const a=t.transaction($e,"readwrite").objectStore($e).delete(e);a.onsuccess=()=>n(!0),a.onerror=()=>i(a.error)})}async function Bs(){const e=await tt();return new Promise((t,n)=>{const r=e.transaction($e,"readonly").objectStore($e),s=[],a=r.openCursor();a.onsuccess=()=>{const o=a.result;o?(s.push(o.key),o.continue()):t(s)},a.onerror=()=>n(a.error)})}async function Fs(e){const t=await tt();return new Promise((n,i)=>{const a=t.transaction(Fe,"readonly").objectStore(Fe).get(e);a.onsuccess=()=>n(a.result||null),a.onerror=()=>i(a.error)})}async function sr(e,t){const n=await tt();return new Promise((i,r)=>{const o=n.transaction(Fe,"readwrite").objectStore(Fe).put(t,e);o.onsuccess=()=>i(!0),o.onerror=()=>r(o.error)})}async function Hs(e){const t=await tt();return new Promise((n,i)=>{const a=t.transaction(Fe,"readwrite").objectStore(Fe).delete(e);a.onsuccess=()=>n(!0),a.onerror=()=>i(a.error)})}async function xo(){if(!navigator.storage?.estimate)return null;try{const{quota:e,usage:t}=await navigator.storage.estimate();return{quota:e,usage:t}}catch{return null}}async function yo(){if(navigator.storage?.persist)try{await navigator.storage.persist()}catch{}}const So=256,$o=16,Di=12,Eo=2,Us=1600,Ao=.85;function zo(){return`${Date.now()}-${crypto.randomUUID()}`}async function Zs(){const e=await xo();return e?e.usage/1024/1024:0}async function To(e,t=Us,n=Ao){const i=await createImageBitmap(e),r=Math.min(1,t/i.width),s=Math.round(i.width*r),a=Math.round(i.height*r);if(r>=1)return e;const o=document.createElement("canvas");o.width=s,o.height=a,o.getContext("2d").drawImage(i,0,0,s,a);const u=e.type==="image/png",f=u?"image/png":"image/jpeg",p=await new Promise(d=>o.toBlob(d,f,u?void 0:n));return new File([p],e.name.replace(/\.(\w+)$/,"")+(u?".png":".jpg"),{type:f})}async function Ro(e,t){let n=Us,i=e;for(let r=0;r<6;r++){if(i.size/1024/1024<=t)return i;n=Math.max(640,Math.floor(n*.75)),i=await To(i,n)}return i}async function Io(e){const t=await Bs(),n=await Promise.all(t.map(async r=>{const s=await Fs(r);return{k:r,t:s?.last||0,s:s?.size||0}}));n.sort((r,s)=>r.t-s.t);let i=0;for(const r of n){if(i>=e*1024*1024)break;await Ds(r.k).catch(()=>{}),await Hs(r.k).catch(()=>{}),i+=r.s}}async function Co(e){await yo();let t=await Ro(e,Di);if(t.size/1024/1024>Di)throw new Error("file too large");const n=await Zs(),i=So-n,r=t.size/1024/1024+$o;i<r&&await Io(r-i);const s=zo();return await js(s,t),await sr(s,{size:t.size,last:Date.now()}),{key:s,file:t}}function Po(e){const t=new Set,n=/!\[[^\]]*]\(appimg:\/\/([^)]+)\)/g,i=/<img[^>]+src=["']appimg:\/\/([^"']+)["'][^>]*>/g;let r;for(;r=n.exec(e);)t.add(r[1]);for(;r=i.exec(e);)t.add(r[1]);return t}async function Lo(e){const t=Po(e),i=(await Bs()).filter(r=>!t.has(r));await Promise.allSettled(i.map(async r=>{await Ds(r),await Hs(r)}))}const tn=new Map;function No(){for(const e of tn.values())URL.revokeObjectURL(e);tn.clear()}async function Bi(e){if(!e.includes("appimg://"))return e;const t=document.createElement("div");t.innerHTML=e;const n=Array.from(t.querySelectorAll('img[src^="appimg://"]'));let i=0;const r=async()=>{for(;;){const a=i++;if(a>=n.length)break;const o=n[a],c=o.getAttribute("src").slice(9);try{const u=await Os(c);if(u){let f=tn.get(c);f||(f=URL.createObjectURL(u),tn.set(c,f)),o.src=f;const p=await Fs(c);await sr(c,{...p||{},last:Date.now(),size:p?.size??u.size})}else o.setAttribute("alt",(o.getAttribute("alt")||"")+" (missing)")}catch{}}},s=Array.from({length:Math.min(Eo,n.length)},r);return await Promise.all(s),t.innerHTML}function Mo(e=""){const t=new Set,n=/appimg:\/\/([A-Za-z0-9._\-:/]+)/g;let i;for(;i=n.exec(String(e));)t.add(i[1]);return Array.from(t)}function qo(e){return new Promise((t,n)=>{const i=new FileReader;i.onload=()=>{const r=String(i.result||""),s=r.indexOf("base64,");t(s>=0?r.slice(s+7):r)},i.onerror=n,i.readAsDataURL(e)})}async function Oo(e){const t={},n=Mo(e);for(const i of n){const r=await Os(i);if(!r)continue;const s=await qo(r);t[i]={name:i,type:r.type||"image/*",base64:s}}return t}async function jo(e={}){const t=Object.entries(e);for(const[n,i]of t){const r=i?.base64;if(!r)continue;const s=i?.type||"image/*",a=Uint8Array.from(atob(r),c=>c.charCodeAt(0)),o=new Blob([a],{type:s});await js(n,o),await sr(n,{size:o.size,last:Date.now()})}}const st={A7:{id:"A7",label:"A7 (74×105mm)",w:74,h:105,margins:{top:5,right:5,bottom:5,left:5}},A6:{id:"A6",label:"A6 (105×148mm)",w:105,h:148,margins:{top:5,right:5,bottom:5,left:5}},A5:{id:"A5",label:"A5 (148×210mm)",w:148,h:210,margins:{top:5,right:5,bottom:5,left:5}},A4:{id:"A4",label:"A4 (210×297mm)",w:210,h:297,margins:{top:5,right:5,bottom:5,left:5}},Letter:{id:"Letter",label:"Letter (216×279mm)",w:216,h:279,margins:{top:5,right:5,bottom:5,left:5}}},ze=96/25.4;function ar(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var nt=ar();function Gs(e){nt=e}var Rt={exec:()=>null};function O(e,t=""){let n=typeof e=="string"?e:e.source,i={replace:(r,s)=>{let a=typeof s=="string"?s:s.source;return a=a.replace(te.caret,"$1"),n=n.replace(r,a),i},getRegex:()=>new RegExp(n,t)};return i}var te={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},Do=/^(?:[ \t]*(?:\n|$))+/,Bo=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Fo=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,jt=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Ho=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,lr=/(?:[*+-]|\d{1,9}[.)])/,Ws=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Qs=O(Ws).replace(/bull/g,lr).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Uo=O(Ws).replace(/bull/g,lr).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),or=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Zo=/^[^\n]+/,cr=/(?!\s*\])(?:\\.|[^\[\]\\])+/,Go=O(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",cr).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Wo=O(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,lr).getRegex(),dn="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",ur=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Qo=O("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",ur).replace("tag",dn).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Vs=O(or).replace("hr",jt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",dn).getRegex(),Vo=O(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Vs).getRegex(),fr={blockquote:Vo,code:Bo,def:Go,fences:Fo,heading:Ho,hr:jt,html:Qo,lheading:Qs,list:Wo,newline:Do,paragraph:Vs,table:Rt,text:Zo},Fi=O("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",jt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",dn).getRegex(),Yo={...fr,lheading:Uo,table:Fi,paragraph:O(or).replace("hr",jt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Fi).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",dn).getRegex()},Xo={...fr,html:O(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",ur).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Rt,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:O(or).replace("hr",jt).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Qs).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Jo=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Ko=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Ys=/^( {2,}|\\)\n(?!\s*$)/,ec=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,gn=/[\p{P}\p{S}]/u,pr=/[\s\p{P}\p{S}]/u,Xs=/[^\s\p{P}\p{S}]/u,tc=O(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,pr).getRegex(),Js=/(?!~)[\p{P}\p{S}]/u,nc=/(?!~)[\s\p{P}\p{S}]/u,rc=/(?:[^\s\p{P}\p{S}]|~)/u,ic=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<(?! )[^<>]*?>/g,Ks=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,sc=O(Ks,"u").replace(/punct/g,gn).getRegex(),ac=O(Ks,"u").replace(/punct/g,Js).getRegex(),ea="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",lc=O(ea,"gu").replace(/notPunctSpace/g,Xs).replace(/punctSpace/g,pr).replace(/punct/g,gn).getRegex(),oc=O(ea,"gu").replace(/notPunctSpace/g,rc).replace(/punctSpace/g,nc).replace(/punct/g,Js).getRegex(),cc=O("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Xs).replace(/punctSpace/g,pr).replace(/punct/g,gn).getRegex(),uc=O(/\\(punct)/,"gu").replace(/punct/g,gn).getRegex(),fc=O(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),pc=O(ur).replace("(?:-->|$)","-->").getRegex(),hc=O("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",pc).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),nn=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,dc=O(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",nn).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),ta=O(/^!?\[(label)\]\[(ref)\]/).replace("label",nn).replace("ref",cr).getRegex(),na=O(/^!?\[(ref)\](?:\[\])?/).replace("ref",cr).getRegex(),gc=O("reflink|nolink(?!\\()","g").replace("reflink",ta).replace("nolink",na).getRegex(),hr={_backpedal:Rt,anyPunctuation:uc,autolink:fc,blockSkip:ic,br:Ys,code:Ko,del:Rt,emStrongLDelim:sc,emStrongRDelimAst:lc,emStrongRDelimUnd:cc,escape:Jo,link:dc,nolink:na,punctuation:tc,reflink:ta,reflinkSearch:gc,tag:hc,text:ec,url:Rt},vc={...hr,link:O(/^!?\[(label)\]\((.*?)\)/).replace("label",nn).getRegex(),reflink:O(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",nn).getRegex()},Dn={...hr,emStrongRDelimAst:oc,emStrongLDelim:ac,url:O(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},_c={...Dn,br:O(Ys).replace("{2,}","*").getRegex(),text:O(Dn.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Zt={normal:fr,gfm:Yo,pedantic:Xo},St={normal:hr,gfm:Dn,breaks:_c,pedantic:vc},mc={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Hi=e=>mc[e];function we(e,t){if(t){if(te.escapeTest.test(e))return e.replace(te.escapeReplace,Hi)}else if(te.escapeTestNoEncode.test(e))return e.replace(te.escapeReplaceNoEncode,Hi);return e}function Ui(e){try{e=encodeURI(e).replace(te.percentDecode,"%")}catch{return null}return e}function Zi(e,t){let n=e.replace(te.findPipe,(s,a,o)=>{let c=!1,u=a;for(;--u>=0&&o[u]==="\\";)c=!c;return c?"|":" |"}),i=n.split(te.splitPipe),r=0;if(i[0].trim()||i.shift(),i.length>0&&!i.at(-1)?.trim()&&i.pop(),t)if(i.length>t)i.splice(t);else for(;i.length<t;)i.push("");for(;r<i.length;r++)i[r]=i[r].trim().replace(te.slashPipe,"|");return i}function $t(e,t,n){let i=e.length;if(i===0)return"";let r=0;for(;r<i&&e.charAt(i-r-1)===t;)r++;return e.slice(0,i-r)}function bc(e,t){if(e.indexOf(t[1])===-1)return-1;let n=0;for(let i=0;i<e.length;i++)if(e[i]==="\\")i++;else if(e[i]===t[0])n++;else if(e[i]===t[1]&&(n--,n<0))return i;return n>0?-2:-1}function Gi(e,t,n,i,r){let s=t.href,a=t.title||null,o=e[1].replace(r.other.outputLinkReplace,"$1");i.state.inLink=!0;let c={type:e[0].charAt(0)==="!"?"image":"link",raw:n,href:s,title:a,text:o,tokens:i.inlineTokens(o)};return i.state.inLink=!1,c}function kc(e,t,n){let i=e.match(n.other.indentCodeCompensation);if(i===null)return t;let r=i[1];return t.split(`
`).map(s=>{let a=s.match(n.other.beginningSpace);if(a===null)return s;let[o]=a;return o.length>=r.length?s.slice(r.length):s}).join(`
`)}var rn=class{options;rules;lexer;constructor(e){this.options=e||nt}space(e){let t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){let t=this.rules.block.code.exec(e);if(t){let n=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:$t(n,`
`)}}}fences(e){let t=this.rules.block.fences.exec(e);if(t){let n=t[0],i=kc(n,t[3]||"",this.rules);return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:i}}}heading(e){let t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(this.rules.other.endingHash.test(n)){let i=$t(n,"#");(this.options.pedantic||!i||this.rules.other.endingSpaceChar.test(i))&&(n=i.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){let t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:$t(t[0],`
`)}}blockquote(e){let t=this.rules.block.blockquote.exec(e);if(t){let n=$t(t[0],`
`).split(`
`),i="",r="",s=[];for(;n.length>0;){let a=!1,o=[],c;for(c=0;c<n.length;c++)if(this.rules.other.blockquoteStart.test(n[c]))o.push(n[c]),a=!0;else if(!a)o.push(n[c]);else break;n=n.slice(c);let u=o.join(`
`),f=u.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");i=i?`${i}
${u}`:u,r=r?`${r}
${f}`:f;let p=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(f,s,!0),this.lexer.state.top=p,n.length===0)break;let d=s.at(-1);if(d?.type==="code")break;if(d?.type==="blockquote"){let _=d,h=_.raw+`
`+n.join(`
`),v=this.blockquote(h);s[s.length-1]=v,i=i.substring(0,i.length-_.raw.length)+v.raw,r=r.substring(0,r.length-_.text.length)+v.text;break}else if(d?.type==="list"){let _=d,h=_.raw+`
`+n.join(`
`),v=this.list(h);s[s.length-1]=v,i=i.substring(0,i.length-d.raw.length)+v.raw,r=r.substring(0,r.length-_.raw.length)+v.raw,n=h.substring(s.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:i,tokens:s,text:r}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim(),i=n.length>1,r={type:"list",raw:"",ordered:i,start:i?+n.slice(0,-1):"",loose:!1,items:[]};n=i?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=i?n:"[*+-]");let s=this.rules.other.listItemRegex(n),a=!1;for(;e;){let c=!1,u="",f="";if(!(t=s.exec(e))||this.rules.block.hr.test(e))break;u=t[0],e=e.substring(u.length);let p=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,S=>" ".repeat(3*S.length)),d=e.split(`
`,1)[0],_=!p.trim(),h=0;if(this.options.pedantic?(h=2,f=p.trimStart()):_?h=t[1].length+1:(h=t[2].search(this.rules.other.nonSpaceChar),h=h>4?1:h,f=p.slice(h),h+=t[1].length),_&&this.rules.other.blankLine.test(d)&&(u+=d+`
`,e=e.substring(d.length+1),c=!0),!c){let S=this.rules.other.nextBulletRegex(h),E=this.rules.other.hrRegex(h),z=this.rules.other.fencesBeginRegex(h),j=this.rules.other.headingBeginRegex(h),R=this.rules.other.htmlBeginRegex(h);for(;e;){let $=e.split(`
`,1)[0],A;if(d=$,this.options.pedantic?(d=d.replace(this.rules.other.listReplaceNesting,"  "),A=d):A=d.replace(this.rules.other.tabCharGlobal,"    "),z.test(d)||j.test(d)||R.test(d)||S.test(d)||E.test(d))break;if(A.search(this.rules.other.nonSpaceChar)>=h||!d.trim())f+=`
`+A.slice(h);else{if(_||p.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||z.test(p)||j.test(p)||E.test(p))break;f+=`
`+d}!_&&!d.trim()&&(_=!0),u+=$+`
`,e=e.substring($.length+1),p=A.slice(h)}}r.loose||(a?r.loose=!0:this.rules.other.doubleBlankLine.test(u)&&(a=!0));let v=null,m;this.options.gfm&&(v=this.rules.other.listIsTask.exec(f),v&&(m=v[0]!=="[ ] ",f=f.replace(this.rules.other.listReplaceTask,""))),r.items.push({type:"list_item",raw:u,task:!!v,checked:m,loose:!1,text:f,tokens:[]}),r.raw+=u}let o=r.items.at(-1);if(o)o.raw=o.raw.trimEnd(),o.text=o.text.trimEnd();else return;r.raw=r.raw.trimEnd();for(let c=0;c<r.items.length;c++)if(this.lexer.state.top=!1,r.items[c].tokens=this.lexer.blockTokens(r.items[c].text,[]),!r.loose){let u=r.items[c].tokens.filter(p=>p.type==="space"),f=u.length>0&&u.some(p=>this.rules.other.anyLine.test(p.raw));r.loose=f}if(r.loose)for(let c=0;c<r.items.length;c++)r.items[c].loose=!0;return r}}html(e){let t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){let t=this.rules.block.def.exec(e);if(t){let n=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),i=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",r=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:i,title:r}}}table(e){let t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;let n=Zi(t[1]),i=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),r=t[3]?.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],s={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===i.length){for(let a of i)this.rules.other.tableAlignRight.test(a)?s.align.push("right"):this.rules.other.tableAlignCenter.test(a)?s.align.push("center"):this.rules.other.tableAlignLeft.test(a)?s.align.push("left"):s.align.push(null);for(let a=0;a<n.length;a++)s.header.push({text:n[a],tokens:this.lexer.inline(n[a]),header:!0,align:s.align[a]});for(let a of r)s.rows.push(Zi(a,s.header.length).map((o,c)=>({text:o,tokens:this.lexer.inline(o),header:!1,align:s.align[c]})));return s}}lheading(e){let t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){let t=this.rules.block.paragraph.exec(e);if(t){let n=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){let t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){let t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){let t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){let t=this.rules.inline.link.exec(e);if(t){let n=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;let s=$t(n.slice(0,-1),"\\");if((n.length-s.length)%2===0)return}else{let s=bc(t[2],"()");if(s===-2)return;if(s>-1){let a=(t[0].indexOf("!")===0?5:4)+t[1].length+s;t[2]=t[2].substring(0,s),t[0]=t[0].substring(0,a).trim(),t[3]=""}}let i=t[2],r="";if(this.options.pedantic){let s=this.rules.other.pedanticHrefTitle.exec(i);s&&(i=s[1],r=s[3])}else r=t[3]?t[3].slice(1,-1):"";return i=i.trim(),this.rules.other.startAngleBracket.test(i)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?i=i.slice(1):i=i.slice(1,-1)),Gi(t,{href:i&&i.replace(this.rules.inline.anyPunctuation,"$1"),title:r&&r.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let i=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),r=t[i.toLowerCase()];if(!r){let s=n[0].charAt(0);return{type:"text",raw:s,text:s}}return Gi(n,r,n[0],this.lexer,this.rules)}}emStrong(e,t,n=""){let i=this.rules.inline.emStrongLDelim.exec(e);if(!(!i||i[3]&&n.match(this.rules.other.unicodeAlphaNumeric))&&(!(i[1]||i[2])||!n||this.rules.inline.punctuation.exec(n))){let r=[...i[0]].length-1,s,a,o=r,c=0,u=i[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(u.lastIndex=0,t=t.slice(-1*e.length+r);(i=u.exec(t))!=null;){if(s=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!s)continue;if(a=[...s].length,i[3]||i[4]){o+=a;continue}else if((i[5]||i[6])&&r%3&&!((r+a)%3)){c+=a;continue}if(o-=a,o>0)continue;a=Math.min(a,a+o+c);let f=[...i[0]][0].length,p=e.slice(0,r+i.index+f+a);if(Math.min(r,a)%2){let _=p.slice(1,-1);return{type:"em",raw:p,text:_,tokens:this.lexer.inlineTokens(_)}}let d=p.slice(2,-2);return{type:"strong",raw:p,text:d,tokens:this.lexer.inlineTokens(d)}}}}codespan(e){let t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(this.rules.other.newLineCharGlobal," "),i=this.rules.other.nonSpaceChar.test(n),r=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return i&&r&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:t[0],text:n}}}br(e){let t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){let t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){let t=this.rules.inline.autolink.exec(e);if(t){let n,i;return t[2]==="@"?(n=t[1],i="mailto:"+n):(n=t[1],i=n),{type:"link",raw:t[0],text:n,href:i,tokens:[{type:"text",raw:n,text:n}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let n,i;if(t[2]==="@")n=t[0],i="mailto:"+n;else{let r;do r=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??"";while(r!==t[0]);n=t[0],t[1]==="www."?i="http://"+t[0]:i=t[0]}return{type:"link",raw:t[0],text:n,href:i,tokens:[{type:"text",raw:n,text:n}]}}}inlineText(e){let t=this.rules.inline.text.exec(e);if(t){let n=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:n}}}},Te=class Bn{tokens;options;state;tokenizer;inlineQueue;constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||nt,this.options.tokenizer=this.options.tokenizer||new rn,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let n={other:te,block:Zt.normal,inline:St.normal};this.options.pedantic?(n.block=Zt.pedantic,n.inline=St.pedantic):this.options.gfm&&(n.block=Zt.gfm,this.options.breaks?n.inline=St.breaks:n.inline=St.gfm),this.tokenizer.rules=n}static get rules(){return{block:Zt,inline:St}}static lex(t,n){return new Bn(n).lex(t)}static lexInline(t,n){return new Bn(n).inlineTokens(t)}lex(t){t=t.replace(te.carriageReturn,`
`),this.blockTokens(t,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){let i=this.inlineQueue[n];this.inlineTokens(i.src,i.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,n=[],i=!1){for(this.options.pedantic&&(t=t.replace(te.tabCharGlobal,"    ").replace(te.spaceLine,""));t;){let r;if(this.options.extensions?.block?.some(a=>(r=a.call({lexer:this},t,n))?(t=t.substring(r.raw.length),n.push(r),!0):!1))continue;if(r=this.tokenizer.space(t)){t=t.substring(r.raw.length);let a=n.at(-1);r.raw.length===1&&a!==void 0?a.raw+=`
`:n.push(r);continue}if(r=this.tokenizer.code(t)){t=t.substring(r.raw.length);let a=n.at(-1);a?.type==="paragraph"||a?.type==="text"?(a.raw+=(a.raw.endsWith(`
`)?"":`
`)+r.raw,a.text+=`
`+r.text,this.inlineQueue.at(-1).src=a.text):n.push(r);continue}if(r=this.tokenizer.fences(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.heading(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.hr(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.blockquote(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.list(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.html(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.def(t)){t=t.substring(r.raw.length);let a=n.at(-1);a?.type==="paragraph"||a?.type==="text"?(a.raw+=(a.raw.endsWith(`
`)?"":`
`)+r.raw,a.text+=`
`+r.raw,this.inlineQueue.at(-1).src=a.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title},n.push(r));continue}if(r=this.tokenizer.table(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.lheading(t)){t=t.substring(r.raw.length),n.push(r);continue}let s=t;if(this.options.extensions?.startBlock){let a=1/0,o=t.slice(1),c;this.options.extensions.startBlock.forEach(u=>{c=u.call({lexer:this},o),typeof c=="number"&&c>=0&&(a=Math.min(a,c))}),a<1/0&&a>=0&&(s=t.substring(0,a+1))}if(this.state.top&&(r=this.tokenizer.paragraph(s))){let a=n.at(-1);i&&a?.type==="paragraph"?(a.raw+=(a.raw.endsWith(`
`)?"":`
`)+r.raw,a.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=a.text):n.push(r),i=s.length!==t.length,t=t.substring(r.raw.length);continue}if(r=this.tokenizer.text(t)){t=t.substring(r.raw.length);let a=n.at(-1);a?.type==="text"?(a.raw+=(a.raw.endsWith(`
`)?"":`
`)+r.raw,a.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=a.text):n.push(r);continue}if(t){let a="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,n}inline(t,n=[]){return this.inlineQueue.push({src:t,tokens:n}),n}inlineTokens(t,n=[]){let i=t,r=null;if(this.tokens.links){let o=Object.keys(this.tokens.links);if(o.length>0)for(;(r=this.tokenizer.rules.inline.reflinkSearch.exec(i))!=null;)o.includes(r[0].slice(r[0].lastIndexOf("[")+1,-1))&&(i=i.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+i.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(r=this.tokenizer.rules.inline.anyPunctuation.exec(i))!=null;)i=i.slice(0,r.index)+"++"+i.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(r=this.tokenizer.rules.inline.blockSkip.exec(i))!=null;)i=i.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+i.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let s=!1,a="";for(;t;){s||(a=""),s=!1;let o;if(this.options.extensions?.inline?.some(u=>(o=u.call({lexer:this},t,n))?(t=t.substring(o.raw.length),n.push(o),!0):!1))continue;if(o=this.tokenizer.escape(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.tag(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.link(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(o.raw.length);let u=n.at(-1);o.type==="text"&&u?.type==="text"?(u.raw+=o.raw,u.text+=o.text):n.push(o);continue}if(o=this.tokenizer.emStrong(t,i,a)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.codespan(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.br(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.del(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.autolink(t)){t=t.substring(o.raw.length),n.push(o);continue}if(!this.state.inLink&&(o=this.tokenizer.url(t))){t=t.substring(o.raw.length),n.push(o);continue}let c=t;if(this.options.extensions?.startInline){let u=1/0,f=t.slice(1),p;this.options.extensions.startInline.forEach(d=>{p=d.call({lexer:this},f),typeof p=="number"&&p>=0&&(u=Math.min(u,p))}),u<1/0&&u>=0&&(c=t.substring(0,u+1))}if(o=this.tokenizer.inlineText(c)){t=t.substring(o.raw.length),o.raw.slice(-1)!=="_"&&(a=o.raw.slice(-1)),s=!0;let u=n.at(-1);u?.type==="text"?(u.raw+=o.raw,u.text+=o.text):n.push(o);continue}if(t){let u="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return n}},sn=class{options;parser;constructor(e){this.options=e||nt}space(e){return""}code({text:e,lang:t,escaped:n}){let i=(t||"").match(te.notSpaceStart)?.[0],r=e.replace(te.endingNewline,"")+`
`;return i?'<pre><code class="language-'+we(i)+'">'+(n?r:we(r,!0))+`</code></pre>
`:"<pre><code>"+(n?r:we(r,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}def(e){return""}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){let t=e.ordered,n=e.start,i="";for(let a=0;a<e.items.length;a++){let o=e.items[a];i+=this.listitem(o)}let r=t?"ol":"ul",s=t&&n!==1?' start="'+n+'"':"";return"<"+r+s+`>
`+i+"</"+r+`>
`}listitem(e){let t="";if(e.task){let n=this.checkbox({checked:!!e.checked});e.loose?e.tokens[0]?.type==="paragraph"?(e.tokens[0].text=n+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=n+" "+we(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:n+" ",text:n+" ",escaped:!0}):t+=n+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",n="";for(let r=0;r<e.header.length;r++)n+=this.tablecell(e.header[r]);t+=this.tablerow({text:n});let i="";for(let r=0;r<e.rows.length;r++){let s=e.rows[r];n="";for(let a=0;a<s.length;a++)n+=this.tablecell(s[a]);i+=this.tablerow({text:n})}return i&&(i=`<tbody>${i}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+i+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){let t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${we(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){let i=this.parser.parseInline(n),r=Ui(e);if(r===null)return i;e=r;let s='<a href="'+e+'"';return t&&(s+=' title="'+we(t)+'"'),s+=">"+i+"</a>",s}image({href:e,title:t,text:n,tokens:i}){i&&(n=this.parser.parseInline(i,this.parser.textRenderer));let r=Ui(e);if(r===null)return we(n);e=r;let s=`<img src="${e}" alt="${n}"`;return t&&(s+=` title="${we(t)}"`),s+=">",s}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:we(e.text)}},dr=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}},Re=class Fn{options;renderer;textRenderer;constructor(t){this.options=t||nt,this.options.renderer=this.options.renderer||new sn,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new dr}static parse(t,n){return new Fn(n).parse(t)}static parseInline(t,n){return new Fn(n).parseInline(t)}parse(t,n=!0){let i="";for(let r=0;r<t.length;r++){let s=t[r];if(this.options.extensions?.renderers?.[s.type]){let o=s,c=this.options.extensions.renderers[o.type].call({parser:this},o);if(c!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(o.type)){i+=c||"";continue}}let a=s;switch(a.type){case"space":{i+=this.renderer.space(a);continue}case"hr":{i+=this.renderer.hr(a);continue}case"heading":{i+=this.renderer.heading(a);continue}case"code":{i+=this.renderer.code(a);continue}case"table":{i+=this.renderer.table(a);continue}case"blockquote":{i+=this.renderer.blockquote(a);continue}case"list":{i+=this.renderer.list(a);continue}case"html":{i+=this.renderer.html(a);continue}case"def":{i+=this.renderer.def(a);continue}case"paragraph":{i+=this.renderer.paragraph(a);continue}case"text":{let o=a,c=this.renderer.text(o);for(;r+1<t.length&&t[r+1].type==="text";)o=t[++r],c+=`
`+this.renderer.text(o);n?i+=this.renderer.paragraph({type:"paragraph",raw:c,text:c,tokens:[{type:"text",raw:c,text:c,escaped:!0}]}):i+=c;continue}default:{let o='Token with "'+a.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return i}parseInline(t,n=this.renderer){let i="";for(let r=0;r<t.length;r++){let s=t[r];if(this.options.extensions?.renderers?.[s.type]){let o=this.options.extensions.renderers[s.type].call({parser:this},s);if(o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){i+=o||"";continue}}let a=s;switch(a.type){case"escape":{i+=n.text(a);break}case"html":{i+=n.html(a);break}case"link":{i+=n.link(a);break}case"image":{i+=n.image(a);break}case"strong":{i+=n.strong(a);break}case"em":{i+=n.em(a);break}case"codespan":{i+=n.codespan(a);break}case"br":{i+=n.br(a);break}case"del":{i+=n.del(a);break}case"text":{i+=n.text(a);break}default:{let o='Token with "'+a.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return i}},Qt=class{options;block;constructor(e){this.options=e||nt}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?Te.lex:Te.lexInline}provideParser(){return this.block?Re.parse:Re.parseInline}},wc=class{defaults=ar();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=Re;Renderer=sn;TextRenderer=dr;Lexer=Te;Tokenizer=rn;Hooks=Qt;constructor(...e){this.use(...e)}walkTokens(e,t){let n=[];for(let i of e)switch(n=n.concat(t.call(this,i)),i.type){case"table":{let r=i;for(let s of r.header)n=n.concat(this.walkTokens(s.tokens,t));for(let s of r.rows)for(let a of s)n=n.concat(this.walkTokens(a.tokens,t));break}case"list":{let r=i;n=n.concat(this.walkTokens(r.items,t));break}default:{let r=i;this.defaults.extensions?.childTokens?.[r.type]?this.defaults.extensions.childTokens[r.type].forEach(s=>{let a=r[s].flat(1/0);n=n.concat(this.walkTokens(a,t))}):r.tokens&&(n=n.concat(this.walkTokens(r.tokens,t)))}}return n}use(...e){let t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(n=>{let i={...n};if(i.async=this.defaults.async||i.async||!1,n.extensions&&(n.extensions.forEach(r=>{if(!r.name)throw new Error("extension name required");if("renderer"in r){let s=t.renderers[r.name];s?t.renderers[r.name]=function(...a){let o=r.renderer.apply(this,a);return o===!1&&(o=s.apply(this,a)),o}:t.renderers[r.name]=r.renderer}if("tokenizer"in r){if(!r.level||r.level!=="block"&&r.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let s=t[r.level];s?s.unshift(r.tokenizer):t[r.level]=[r.tokenizer],r.start&&(r.level==="block"?t.startBlock?t.startBlock.push(r.start):t.startBlock=[r.start]:r.level==="inline"&&(t.startInline?t.startInline.push(r.start):t.startInline=[r.start]))}"childTokens"in r&&r.childTokens&&(t.childTokens[r.name]=r.childTokens)}),i.extensions=t),n.renderer){let r=this.defaults.renderer||new sn(this.defaults);for(let s in n.renderer){if(!(s in r))throw new Error(`renderer '${s}' does not exist`);if(["options","parser"].includes(s))continue;let a=s,o=n.renderer[a],c=r[a];r[a]=(...u)=>{let f=o.apply(r,u);return f===!1&&(f=c.apply(r,u)),f||""}}i.renderer=r}if(n.tokenizer){let r=this.defaults.tokenizer||new rn(this.defaults);for(let s in n.tokenizer){if(!(s in r))throw new Error(`tokenizer '${s}' does not exist`);if(["options","rules","lexer"].includes(s))continue;let a=s,o=n.tokenizer[a],c=r[a];r[a]=(...u)=>{let f=o.apply(r,u);return f===!1&&(f=c.apply(r,u)),f}}i.tokenizer=r}if(n.hooks){let r=this.defaults.hooks||new Qt;for(let s in n.hooks){if(!(s in r))throw new Error(`hook '${s}' does not exist`);if(["options","block"].includes(s))continue;let a=s,o=n.hooks[a],c=r[a];Qt.passThroughHooks.has(s)?r[a]=u=>{if(this.defaults.async)return Promise.resolve(o.call(r,u)).then(p=>c.call(r,p));let f=o.call(r,u);return c.call(r,f)}:r[a]=(...u)=>{let f=o.apply(r,u);return f===!1&&(f=c.apply(r,u)),f}}i.hooks=r}if(n.walkTokens){let r=this.defaults.walkTokens,s=n.walkTokens;i.walkTokens=function(a){let o=[];return o.push(s.call(this,a)),r&&(o=o.concat(r.call(this,a))),o}}this.defaults={...this.defaults,...i}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return Te.lex(e,t??this.defaults)}parser(e,t){return Re.parse(e,t??this.defaults)}parseMarkdown(e){return(t,n)=>{let i={...n},r={...this.defaults,...i},s=this.onError(!!r.silent,!!r.async);if(this.defaults.async===!0&&i.async===!1)return s(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof t>"u"||t===null)return s(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return s(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));r.hooks&&(r.hooks.options=r,r.hooks.block=e);let a=r.hooks?r.hooks.provideLexer():e?Te.lex:Te.lexInline,o=r.hooks?r.hooks.provideParser():e?Re.parse:Re.parseInline;if(r.async)return Promise.resolve(r.hooks?r.hooks.preprocess(t):t).then(c=>a(c,r)).then(c=>r.hooks?r.hooks.processAllTokens(c):c).then(c=>r.walkTokens?Promise.all(this.walkTokens(c,r.walkTokens)).then(()=>c):c).then(c=>o(c,r)).then(c=>r.hooks?r.hooks.postprocess(c):c).catch(s);try{r.hooks&&(t=r.hooks.preprocess(t));let c=a(t,r);r.hooks&&(c=r.hooks.processAllTokens(c)),r.walkTokens&&this.walkTokens(c,r.walkTokens);let u=o(c,r);return r.hooks&&(u=r.hooks.postprocess(u)),u}catch(c){return s(c)}}}onError(e,t){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e){let i="<p>An error occurred:</p><pre>"+we(n.message+"",!0)+"</pre>";return t?Promise.resolve(i):i}if(t)return Promise.reject(n);throw n}}},Je=new wc;function D(e,t){return Je.parse(e,t)}D.options=D.setOptions=function(e){return Je.setOptions(e),D.defaults=Je.defaults,Gs(D.defaults),D};D.getDefaults=ar;D.defaults=nt;D.use=function(...e){return Je.use(...e),D.defaults=Je.defaults,Gs(D.defaults),D};D.walkTokens=function(e,t){return Je.walkTokens(e,t)};D.parseInline=Je.parseInline;D.Parser=Re;D.parser=Re.parse;D.Renderer=sn;D.TextRenderer=dr;D.Lexer=Te;D.lexer=Te.lex;D.Tokenizer=rn;D.Hooks=Qt;D.parse=D;D.options;D.setOptions;D.use;D.walkTokens;D.parseInline;Re.parse;Te.lex;function xc(e=""){return D.parse(String(e))}function yc(e){const t=String(e).split(/\r?\n/),n=[];let i=[];const r=()=>{i.length&&(n.push(xc(i.join(`
`))),i.length=0)},s=a=>/^\s*\[\[(pagebreak|colbreak|rowbreak)(:[^]]+)?\]\]\s*$/i.test(a);for(const a of t){const o=a.match(/^\s*\[\[\s*head(?:er)?:\s*(.*?)\s*\]\]\s*$/i),c=a.match(/^\s*\[\[\s*foot:\s*(.*?)\s*\]\]\s*$/i),u=a.match(/^\s*\[\[\s*rowbreak(?::\s*([^\]]+))?\s*\]\]\s*$/i);if(o){r(),n.push(`<div data-runhead="${o[1].replace(/"/g,"&quot;")}"></div>`);continue}if(c){r(),n.push(`<div data-runfoot="${c[1].replace(/"/g,"&quot;")}"></div>`);continue}if(u){r();let f=(u[1]||"").trim();f||(f="1em"),/^\d+(\.\d+)?$/.test(f)&&(f=`${f}em`),n.push(`<div data-rowbreak="1" class="force-rowbreak" style="height:${f}"></div>`);continue}if(s(a)){const f=a.trim().toLowerCase();if(r(),f.includes("colbreak"))n.push('<div data-colbreak="1" class="col-break-marker"></div>');else if(f.includes("rowbreak")){const p=a.match(/\[\[\s*rowbreak\s*:?(\d+)?\s*\]\]/i);let d=parseInt(p?.[1]??"1",10);isNaN(d)&&(d=1),d=Math.max(1,Math.min(d,20)),n.push(`<div data-rowbreak="${d}" class="force-rowbreak" style="height:${d}em"></div>`)}else n.push('<div data-pagebreak="1" class="page-break-marker"></div>');continue}}return r(),n.join(`
`)}let Hn=null;function ct(e,t){const n=Hn||document.body,i=document.createElement("div");i.style.position="absolute",i.style.left="-99999px",i.style.top="0",i.style.width=t+"px",i.style.boxSizing="border-box",i.style.visibility="hidden",i.style.whiteSpace="normal",i.style.wordBreak="normal",i.style.overflowWrap="anywhere",n.appendChild(i);const r=e.cloneNode(!0);r.style.whiteSpace="inherit",r.style.wordBreak="inherit",r.style.overflowWrap="inherit",i.appendChild(r);const s=getComputedStyle(r),a=parseFloat(s.marginTop)||0,o=parseFloat(s.marginBottom)||0,c=r.offsetHeight+a+o;return i.remove(),{h:c,mt:a,mb:o}}function Sc(e){const t=e.classList||{contains:()=>!1};return t.contains("span-all")||t.contains("full")||t.contains("cols")||t.contains("cols-1")||t.contains("cols-2")||t.contains("img-page")||t.contains("img-wide")||t.contains("figure-wide")}function ra(e,t,n,i=!1){const s=(e.textContent??"").toString().replace(/\s+/g," ").trim();if(!s.length)return{head:null,tail:null};if(!(e.childNodes.length===1&&e.firstChild&&e.firstChild.nodeType===3)){if(i)return{head:null,tail:null};const v=document.createElement("p");return v.textContent=s,ra(v,t,n,!0)}const o=e.cloneNode(!1);if(o.textContent=s,ct(o,t).h<=n)return{head:e.cloneNode(!0),tail:null};const c=e.cloneNode(!1),u=e.cloneNode(!1);let f=0,p=s.length;for(;f<p;){const v=f+p+1>>1;c.textContent=s.slice(0,v),ct(c,t).h<=n?f=v:p=v-1}let d=f;for(;d>0&&!/\s/.test(s[d-1]);)d--;d===0&&(d=f);const _=s.slice(0,d).replace(/\s+$/,""),h=s.slice(d).replace(/^\s+/,"");return c.textContent=_,u.textContent=h,{head:_?c:null,tail:h?u:null}}function $c(e,t,n){const i=e.tagName;if(i==="P")return ra(e,t,n);if(i==="UL"||i==="OL"){const r=e.cloneNode(!1),s=e.cloneNode(!1),a=Array.from(e.children);for(let o=0;o<a.length;o++)if(r.appendChild(a[o].cloneNode(!0)),ct(r,t).h>n){r.removeChild(r.lastChild);for(let u=o;u<a.length;u++)s.appendChild(a[u].cloneNode(!0));return{head:r.childNodes.length?r:null,tail:s.childNodes.length?s:null}}return{head:r,tail:null}}return{head:null,tail:null}}function Ec(e){const t=e.measurer_el??e.measurerEl,n=e.page_px??e.pagePx,i=e.pad,r=e.columns,s=e.column_gap??e.columnGap;if(!t||!n||!i)return{pages:[],heads:[],foots:[]};Hn=t;const a=n.h-(i.top+i.bottom),o=Math.max(1,Number(r)||1),c=(Number(s)||0)*ze,u=n.w-(i.left+i.right),f=o>1?(u-c*(o-1))/o:u,p=Array.from(t.childNodes).filter(C=>C.nodeType===1),d=[],_=[],h=[];let v=[],m=0,S=0,E=0,z="",j="";const R=()=>{d.push(v.join("")),_.push(z),h.push(j),v=[],m=0,S=0,E=0},$=()=>{m<o-1?(m+=1,S=0,E=0):R()},A=C=>{v.push(C)};let I=0;for(;I<p.length;){const C=p[I];if(C.hasAttribute&&C.hasAttribute("data-runhead")){z=C.getAttribute("data-runhead")||"",I++;continue}if(C.hasAttribute&&C.hasAttribute("data-runfoot")){j=C.getAttribute("data-runfoot")||"",I++;continue}if(C.hasAttribute&&C.hasAttribute("data-pagebreak")){R(),I++;continue}if(C.hasAttribute&&C.hasAttribute("data-colbreak")){A('<div class="force-colbreak"></div>'),$(),I++;continue}if(C.hasAttribute&&C.hasAttribute("data-rowbreak")){const ie=ct(C,f),He=S===0?ie.h:ie.h-Math.min(E,ie.mt);He<=a-S?(A(C.outerHTML),S+=He,E=ie.mb,I++):$();continue}if(["META","LINK","SCRIPT","STYLE"].includes(C.tagName)){I++;continue}const Q=C,de=Sc(Q),H=ct(Q,de?u:f),Ne=S===0?H.h:H.h-Math.min(E,H.mt),ge=a-S;if(Ne<=ge){A(Q.outerHTML),S+=Ne,E=H.mb,I++;continue}if(H.h<=a){$();continue}const ve=de?u:f,{head:V,tail:K}=$c(Q,ve,ge);if(V){const ie=ct(V,ve),He=S===0?ie.h:ie.h-Math.min(E,ie.mt);if(He<=a-S){A(V.outerHTML),S+=He,E=ie.mb,K&&p.splice(I+1,0,K),I++;continue}else{$();continue}}A(Q.outerHTML),R(),I++}return d.push(v.join("")),_.push(z),h.push(j),Hn=null,{pages:d,heads:_,foots:h}}function Ac(e,t,n,i,r,s,a,o,c,u,f){const p=m=>`${m}mm`,d=u==="spreads"?e.w*2+f:e.w,_=e.h,h=`
@page { size: ${p(d)} ${p(_)}; margin: 0; }
@media print {
  body { background: #fff !important; }
  .topbar, .workspace .left, .workspace .splitter, .right .spreads { display: none !important; }
  #print-root { display: block !important; }
  #print-root .print-page { width: ${p(e.w)}; height: ${p(e.h)}; background: #fff; box-shadow: none !important; page-break-after: always; }
  #print-root .print-page:last-child { page-break-after: auto; }
  #print-root .print-sheet { display: flex; align-items: stretch; width: ${p(d)}; height: ${p(_)}; page-break-after: always; background: #fff; }
  #print-root .print-sheet:last-child { page-break-after: auto; }
  #print-root .print-gutter { width: ${p(f)}; flex: 0 0 ${p(f)}; }
  #print-root .print-inner {
    box-sizing: border-box; width: 100%; height: 100%; overflow: hidden;
    padding: ${p(t.top)} ${p(t.right)} ${p(t.bottom)} ${p(t.left)};
    --pad-top:${p(t.top)}; --pad-right:${p(t.right)}; --pad-bottom:${p(t.bottom)}; --pad-left:${p(t.left)};
    column-count: ${n}; column-gap: ${p(i)};
    font-family: ${r}; font-size: ${s}pt; line-height: ${a};
    text-align: ${o==="justify"?"justify":"left"}; hyphens: ${c};
  }
  #print-root .print-inner > :first-child { margin-top: 0 !important; }
  #print-root .print-inner :where(h1,h2,h3,h4,h5,h6,p,ul,ol,blockquote):first-child { margin-top: 0 !important; }
  #print-root .print-inner img:first-child { margin-top: 0 !important; }
  #print-root .print-inner .img-page {
    display:block;
    width: calc(100% + var(--pad-left) + var(--pad-right));
    height: calc(100% + var(--pad-top) + var(--pad-bottom));
    margin-left: calc(-1 * var(--pad-left));
    margin-top: calc(-1 * var(--pad-top));
    object-fit: cover;
    break-inside: avoid;
    column-span: all;
    padding: 0 !important;
  }
}
`;let v=document.getElementById("print-rules");v||(v=document.createElement("style"),v.id="print-rules",document.head.appendChild(v)),v.textContent=h}function zc(e=""){return String(e).toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"").slice(0,80)||"book"}function Tc(e,t){const n=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),i=URL.createObjectURL(n),r=document.createElement("a");r.href=i,r.download=e,document.body.appendChild(r),r.click(),r.remove(),URL.revokeObjectURL(i)}function Rc(e){return{__type:"zine-book",__version:2,savedAt:new Date().toISOString(),...e}}async function Ic(e){const t=await Oo(e.markdown),n=Rc({...e,assets:t});Tc(`${zc(e.title)}.zine.json`,n)}function Cc(e,t){e&&(t.title(e.title),t.page_size(e.page_size),t.margins(e.margins),t.columns(Number(e.columns)),t.column_gap(Number(e.column_gap)),t.font_family(e.font_family),t.base_font_pt(Number(e.base_font_pt)),t.line_height(Number(e.line_height)),t.justify(e.justify),t.hyphens(e.hyphens),t.print_mode(e.print_mode),t.spread_gutter(Number(e.spread_gutter)),typeof e.left_percent=="number"&&t.left_percent(Math.max(20,Math.min(80,e.left_percent))),t.markdown(e.markdown))}async function Pc(e,t,n){try{const i=await e.text(),r=JSON.parse(i);r.assets&&await jo(r.assets),Cc(r,t),await Ge(),await n()}catch(i){console.error(i),alert("Import failed: invalid or corrupted file.")}finally{const i=document.getElementById("import_book");i&&(i.value="")}}var Lc=et("<option> </option>"),Nc=et('<label>Gutter <input type="number" min="0" step="1"/> mm</label>'),Mc=et("<button></button>"),qc=et('<div class="page"><div class="page-running-header"> </div> <div><!></div> <div class="page-running-footer"> </div> <div></div></div>'),Oc=et('<div class="print-page"><div class="print-running-header"> </div> <div><!></div> <div class="print-running-footer"> </div> <div></div></div>'),jc=et('<div class="print-sheet"><div class="print-page"><div class="print-running-header"> </div> <div><!></div> <div class="print-running-footer"> </div> <div class="print-page-number lef"></div></div> <div class="print-gutter"></div> <div class="print-page"><div class="print-running-header"> </div> <div><!></div> <div class="print-running-footer"> </div> <div class="print-page-number rig"></div></div></div>'),Dc=et('<div class="topbar"><div class="group"><label>PDF Title <input type="text" placeholder="Title…"/></label> <label>Size <select></select></label> <button>Reset margins</button></div> <div class="group"><label>T <input type="number" min="0" step="1"/> mm</label> <label>R <input type="number" min="0" step="1"/> mm</label> <label>B <input type="number" min="0" step="1"/> mm</label> <label>L <input type="number" min="0" step="1"/> mm</label></div> <div class="group"><label>Cols <input type="number" min="1" step="1"/></label> <label>Gap <input type="number" min="0" step="1"/> mm</label></div> <div class="group"><label>Font <select><option>Serif</option><option>Sans</option><option>Mono</option></select></label> <label>Size <input type="number" min="3" step="0.5"/> pt</label> <label>LH <input type="number" min="0.5" step="0.1"/></label> <button>A−</button> <button>A+</button> <label><select><option>Ragged</option><option>Justify</option></select></label> <label><select><option>No hyphens</option><option>Hyphens auto</option></select></label></div> <div class="group"><label>Print <select><option>Single pages</option><option>Spreads (2-up)</option></select></label> <!></div> <div class="group right"><button>+ Head</button> <button>+ Foot</button> <input type="file" id="image_input" accept="image/*" multiple style="display:none"/> <input type="file" id="image_input_full" accept="image/*" multiple style="display:none"/> <button>+ Image</button> <button>+ Full Image</button> <button>Span all</button> <!> <button>+ Col Break</button> <button>+ Row Break</button> <button>+ Page Break</button></div> <div class="group right"><button>Save</button> <input id="import_book" type="file" accept="application/json" style="display:none"/> <button>Import</button> <button class="primary">Print / PDF</button></div> <div class="zoombar"><input type="range" min="25" max="200" step="5"/> <button type="button">100%</button> <span class="zoomval"> </span></div></div> <div class="workspace"><section class="left"><div class="editor"><div class="header"><div>Markdown</div> <div class="meta"> </div></div> <textarea spellcheck="false"></textarea> <div class="hint storage-indicator"> </div></div></section> <div class="splitter" title="Drag to resize"></div> <section class="right"><div id="measurer"><!></div> <div class="spreads-viewport"><div class="spreads-scale"><div class="spreads"></div></div></div> <div id="print-root" aria-hidden="true" style="display:none"><!></div></section></div>',1);function Bc(e,t){es(t,!1);const n=P(),i=P(),r=P(),s=P(),a=P(),o=P(),c=P(),u=P(),f=P(),p=P(),d=`## Can we write while we are typesetting a book?
[[pagebreak]]`;let _=P(localStorage.getItem("zine:title")??"Untitled Zine"),h=P(localStorage.getItem("zine:page_size")??"A7"),v=P(JSON.parse(localStorage.getItem("zine:margins")??JSON.stringify(st.A7.margins))),m=P(localStorage.getItem("zine:markdown")??d),S=P(Number(localStorage.getItem("zine:columns")??1)),E=P(Number(localStorage.getItem("zine:column_gap")??5)),z=P(localStorage.getItem("zine:font_family")??"Courier, monospace"),j=P(Number(localStorage.getItem("zine:base_font_pt")??8)),R=P(Number(localStorage.getItem("zine:line_height")??1)),$=P(localStorage.getItem("zine:justify")??"left"),A=P(localStorage.getItem("zine:hyphens")??"auto"),I=P(localStorage.getItem("zine:print_mode")??"pages"),C=P(Number(localStorage.getItem("zine:spread_gutter")??6)),Q=P(Number(localStorage.getItem("zine:zoom")??100)),de=P(""),H=P([]),Ne=P([]),ge=P(),ve=P(""),V=P([]),K=P([]);const ie=96/72;function He(g){const x=g.target?.files?.[0];x&&Pc(x,{title:b=>w(_,b??l(_)),page_size:b=>w(h,b??l(h)),margins:b=>w(v,b??l(v)),markdown:b=>w(m,b??l(m)),columns:b=>w(S,b??l(S)),column_gap:b=>w(E,b??l(E)),font_family:b=>w(z,b??l(z)),base_font_pt:b=>w(j,b??l(j)),line_height:b=>w(R,b??l(R)),justify:b=>w($,b??l($)),hyphens:b=>w(A,b??l(A)),print_mode:b=>w(I,b??l(I)),spread_gutter:b=>w(C,b??l(C)),left_percent:b=>w(be,b??l(be))},_n)}function ia(){Ic({title:l(_),page_size:l(h),margins:l(v),markdown:l(m),columns:l(S),column_gap:l(E),font_family:l(z),base_font_pt:l(j),line_height:l(R),justify:l($),hyphens:l(A),print_mode:l(I),spread_gutter:l(C),left_percent:l(be)})}async function gr(){const g=await Zs();w(ve,`Storage ${g.toFixed(1)} MB`)}let vn;async function _n(){vn&&clearTimeout(vn),vn=setTimeout(async()=>{if(!l(ge))return;await Ge(),w(de,await Bi(l(p))),await Ge();const g=Ec({measurerEl:l(ge),pagePx:l(r),pad:l(s),columns:l(S),columnGap:l(E)});w(H,g.pages),w(V,g.heads),w(K,g.foots);const x=[];if(l(H).length){x.push([null,l(H)[0]]);for(let b=1;b<l(H).length;b+=2)x.push([l(H)[b]??null,l(H)[b+1]??null])}w(Ne,x),Ac(l(i),l(v),l(S),l(E),l(z),l(j),l(R),l($),l(A),l(I),l(C))},60)}function Ue(g){const x=l(Ze),b=x?.selectionStart??l(m).length,T=x?.selectionEnd??l(m).length;w(m,l(m).slice(0,b)+g+l(m).slice(T)),Ge().then(()=>{const M=b+g.length;x?.setSelectionRange(M,M),x?.focus()})}function sa(g){const x=l(Ze),b=x?.selectionStart??l(m).length,T=x?.selectionEnd??l(m).length,M=l(m).slice(b,T)||"",q=l(m).slice(0,b),Y=l(m).slice(T),W=`

<div class="${g}">
${M}
</div>

`;w(m,q+W+Y),Ge().then(()=>{const re=(q+W).length;x?.setSelectionRange(re,re),x?.focus()})}function aa(g){const x=l(Ze),b=x?.selectionStart??l(m).length,T=x?.selectionEnd??l(m).length,M=l(m).slice(b,T)||"",q=l(m).slice(0,b),Y=l(m).slice(T),W=`

<div class="cols" style="column-count:${g};">
${M}
</div>

`;w(m,q+W+Y),Ge().then(()=>{const re=(q+W).length;x?.setSelectionRange(re,re),x?.focus()})}const la=()=>Ue(`

[[rowbreak:1]]

`),oa=()=>Ue(`

[[pagebreak]]

`),ca=()=>Ue(`

[[colbreak]]

`),ua=()=>Ue(`

[[head: Your Heading]]

`),fa=()=>Ue(`

[[foot: Your Footer]]

`);async function mn(g,x=!1){const{key:b,file:T}=await Co(g);Ue(x?`

[[pagebreak]]
<img src="appimg://${b}" alt="${T.name}" class="img-page" />
[[pagebreak]]
`:`

![${T.name}](appimg://${b})

`),await Lo(l(m)).catch(()=>{}),await gr()}let bn=0;async function kn(g){for(;bn>=1;)await new Promise(x=>setTimeout(x,30));bn++;try{return await g()}finally{bn--}}function pa(g){g.preventDefault(),Array.from(g.dataTransfer.files||[]).filter(b=>b.type.startsWith("image/")).reduce((b,T)=>b.then(()=>kn(()=>mn(T,!1))),Promise.resolve())}const ha=g=>g.preventDefault();function da(g){const b=Array.from(g.clipboardData?.items||[]).find(T=>T.type.startsWith("image/"));b&&(g.preventDefault(),kn(()=>mn(b.getAsFile(),!1)))}async function vr(g,x){const b=Array.from(g.target.files||[]);for(const T of b)await kn(()=>mn(T,x));g.target.value=""}const ga=()=>{document.title=l(_),window.print()};let Ze=P();qs(async()=>{l(Ze)?.focus(),w(de,await Bi(l(p))),await _n(),await gr()}),_o(No);let be=P(Number(localStorage.getItem("zine:left_percent")??48)),wn=!1,_r=0,mr=l(be);function va(g){wn=!0,_r=g.clientX,mr=l(be),window.addEventListener("mousemove",br),window.addEventListener("mouseup",kr)}function br(g){if(!wn)return;const x=document.querySelector(".workspace")?.clientWidth||1,T=(g.clientX-_r)/x*100;w(be,Math.max(20,Math.min(80,Math.round((mr+T)*10)/10)))}function kr(){wn=!1,window.removeEventListener("mousemove",br),window.removeEventListener("mouseup",kr)}function _a(g,x){const b=g.lastIndexOf(`

`,Math.max(0,x-1)),T=g.indexOf(`

`,x),M=b>=0?b+2:0,q=T>=0?T:g.length;return[M,q]}function wr(g){const x=l(Ze),b=x?.selectionStart??l(m).length,T=x?.selectionEnd??l(m).length;let M=b,q=T;M===q&&([M,q]=_a(l(m),M));let Y=l(m).slice(0,M),W=l(m).slice(M,q),re=l(m).slice(q);const ke=/^<span style="font-size:([\d.]+)em">([\s\S]*)<\/span>$/,oe=W.match(ke);if(oe){let se=parseFloat(oe[1]);const Me=oe[2];W=`<span style="font-size:${Math.max(.5,Math.min(4,se+g))}em">${Me}</span>`}else W=`<span style="font-size:${1+g}em">${W}</span>`;w(m,Y+W+re),Ge().then(()=>{const se=(Y+W).length;x?.setSelectionRange(se,se),x?.focus()})}const ma=()=>wr(-.1),ba=()=>wr(.1);F(()=>l(Q),()=>{localStorage.setItem("zine:zoom",String(l(Q)))}),F(()=>l(Q),()=>{w(n,Math.max(10,Math.min(400,l(Q)))/100)}),F(()=>l(_),()=>{localStorage.setItem("zine:title",l(_))}),F(()=>l(h),()=>{localStorage.setItem("zine:page_size",l(h))}),F(()=>l(v),()=>{localStorage.setItem("zine:margins",JSON.stringify(l(v)))}),F(()=>l(m),()=>{localStorage.setItem("zine:markdown",l(m))}),F(()=>l(S),()=>{localStorage.setItem("zine:columns",String(l(S)))}),F(()=>l(E),()=>{localStorage.setItem("zine:column_gap",String(l(E)))}),F(()=>l(z),()=>{localStorage.setItem("zine:font_family",l(z))}),F(()=>l(j),()=>{localStorage.setItem("zine:base_font_pt",String(l(j)))}),F(()=>l(R),()=>{localStorage.setItem("zine:line_height",String(l(R)))}),F(()=>l($),()=>{localStorage.setItem("zine:justify",l($))}),F(()=>l(A),()=>{localStorage.setItem("zine:hyphens",l(A))}),F(()=>l(I),()=>{localStorage.setItem("zine:print_mode",l(I))}),F(()=>l(C),()=>{localStorage.setItem("zine:spread_gutter",String(l(C)))}),F(()=>l(h),()=>{w(i,st[l(h)]??st.A7)}),F(()=>(l(i),ze),()=>{w(r,{w:Math.round(l(i).w*ze),h:Math.round(l(i).h*ze)})}),F(()=>(l(v),ze),()=>{w(s,{top:Math.round(l(v).top*ze),right:Math.round(l(v).right*ze),bottom:Math.round(l(v).bottom*ze),left:Math.round(l(v).left*ze)})}),F(()=>l(j),()=>{w(a,Math.round(l(j)*ie*100)/100)}),F(()=>(l(z),l(a),l(R),l($),l(A)),()=>{w(o,`
    font-family:${l(z)};
    font-size:${l(a)}px;
    line-height:${l(R)};
    text-align:${l($)==="justify"?"justify":"left"};
    hyphens:${l(A)};
  `)}),F(()=>(l(r),l(v),l(z)),()=>{w(c,`
  width:${l(r).w}px;
  height:${l(r).h}px;
  --margin-bottom:${l(v).bottom};
  font-family:${l(z)};
  `)}),F(()=>(l(s),l(S),l(E),l(o)),()=>{w(u,`
    padding:${l(s).top}px ${l(s).right}px ${l(s).bottom}px ${l(s).left}px;
    --pad-top:${l(s).top}px; --pad-right:${l(s).right}px; --pad-bottom:${l(s).bottom}px; --pad-left:${l(s).left}px;
    column-count:${l(S)}; column-gap:${l(E)}mm;
    ${l(o)}
  `)}),F(()=>(l(r),l(s),l(o)),()=>{w(f,`
    position:absolute; left:-99999px; top:0; opacity:0; pointer-events:none;
    width:${l(r).w-(l(s).left+l(s).right)}px;
    ${l(o)}
  `)}),F(()=>l(m),()=>{w(p,yc(l(m)))}),F(()=>(l(p),l(r),l(S),l(E),l(s),l(a),l(R),l($),l(A),l(z),l(I),l(C),l(i)),()=>{l(p),l(r).h,l(r).w,l(S),l(E),l(s).top,l(s).right,l(s).bottom,l(s).left,l(a),l(R),l($),l(A),l(z),l(I),l(C),l(i).id,_n()}),F(()=>l(be),()=>{localStorage.setItem("zine:left_percent",String(l(be)))}),Ql(),vo();var xr=Dc(),yr=Rn(xr),Sr=y(yr),$r=y(Sr),ka=k(y($r)),Er=k($r,2),Ar=k(y(Er));_e(()=>{l(h),mt(()=>{})}),kt(Ar,5,()=>(Cs(st),U(()=>Object.values(st))),bt,(g,x)=>{var b=Lc(),T=y(b),M={};_e(()=>{ce(T,(l(x),U(()=>l(x).label))),M!==(M=(l(x),U(()=>l(x).id)))&&(b.value=(b.__value=(l(x),U(()=>l(x).id)))??"")}),Ae(g,b)});var wa=k(Er,2),zr=k(Sr,2),Tr=y(zr),xa=k(y(Tr)),Rr=k(Tr,2),ya=k(y(Rr)),Ir=k(Rr,2),Sa=k(y(Ir)),$a=k(Ir,2),Ea=k(y($a)),Cr=k(zr,2),Pr=y(Cr),Aa=k(y(Pr)),za=k(Pr,2),Ta=k(y(za)),Lr=k(Cr,2),Nr=y(Lr),Mr=k(y(Nr));_e(()=>{l(z),mt(()=>{})});var xn=y(Mr);xn.value=xn.__value="Georgia, Times New Roman, serif";var yn=k(xn);yn.value=yn.__value="Helvetica, Arial, sans-serif";var qr=k(yn);qr.value=qr.__value="Courier, monospace";var Or=k(Nr,2),Ra=k(y(Or)),jr=k(Or,2),Ia=k(y(jr)),Dr=k(jr,2),Br=k(Dr,2),Fr=k(Br,2),Hr=y(Fr);_e(()=>{l($),mt(()=>{})});var Sn=y(Hr);Sn.value=Sn.__value="left";var Ur=k(Sn);Ur.value=Ur.__value="justify";var Ca=k(Fr,2),Zr=y(Ca);_e(()=>{l(A),mt(()=>{})});var $n=y(Zr);$n.value=$n.__value="none";var Gr=k($n);Gr.value=Gr.__value="auto";var Wr=k(Lr,2),Qr=y(Wr),Vr=k(y(Qr));_e(()=>{l(I),mt(()=>{})});var En=y(Vr);En.value=En.__value="pages";var Yr=k(En);Yr.value=Yr.__value="spreads";var Pa=k(Qr,2);{var La=g=>{var x=Nc(),b=k(y(x));ue(b,()=>l(C),T=>w(C,T)),Ae(g,x)};Ni(Pa,g=>{l(I)==="spreads"&&g(La)})}var Xr=k(Wr,2),Jr=y(Xr),Kr=k(Jr,2),ei=k(Kr,2),ti=k(ei,2),ni=k(ti,2),ri=k(ni,2),ii=k(ri,2),si=k(ii,2);kt(si,1,()=>(l(S),U(()=>Array(l(S)))),bt,(g,x,b)=>{var T=Mc();T.textContent=`${b+1} col`,Z("click",T,()=>aa(b+1)),Ae(g,T)});var ai=k(si,2),li=k(ai,2),Na=k(li,2),oi=k(Xr,2),ci=y(oi),ui=k(ci,2),fi=k(ui,2),Ma=k(fi,2),qa=k(oi,2),pi=y(qa),hi=k(pi,2),Oa=k(hi,2),ja=y(Oa),di=k(yr,2),Dt=y(di),Da=y(Dt),gi=y(Da),Ba=k(y(gi),2),Fa=y(Ba),Bt=k(gi,2);Oi(Bt,g=>w(Ze,g),()=>l(Ze));var Ha=k(Bt,2),Ua=y(Ha),vi=k(Dt,2),Za=k(vi,2),Ft=y(Za),Ga=y(Ft);wt(Ga,()=>l(de)),Oi(Ft,g=>w(ge,g),()=>l(ge));var _i=k(Ft,2),mi=y(_i),Wa=y(mi);kt(Wa,5,()=>l(H),bt,(g,x,b)=>{var T=qc(),M=y(T),q=y(M),Y=k(M,2);let W;var re=y(Y);wt(re,()=>l(x));var ke=k(Y,2),oe=y(ke),se=k(ke,2);it(se,1,`page-number ${b%2===0?"rig":"lef"}`),se.textContent=b+1,_e(Me=>{xt(T,l(c)),ce(q,(l(V),U(()=>l(V)[b]||""))),W=it(Y,1,"page-inner preview",null,W,Me),xt(Y,l(u)),ce(oe,(l(K),U(()=>l(K)[b]||"")))},[()=>({fullpage:l(x).includes("img-page")})]),Ae(g,T)});var Qa=k(_i,2),Va=y(Qa);{var Ya=g=>{var x=Li(),b=Rn(x);kt(b,1,()=>l(H),bt,(T,M,q)=>{var Y=Oc(),W=y(Y),re=y(W),ke=k(W,2);let oe;var se=y(ke);wt(se,()=>l(M));var Me=k(ke,2),vt=y(Me),Ht=k(Me,2);it(Ht,1,`print-page-number ${q%2===0?"rig":"lef"}`),Ht.textContent=q+1,_e(An=>{ce(re,(l(V),U(()=>l(V)[q]||""))),oe=it(ke,1,"print-inner",null,oe,An),ce(vt,(l(K),U(()=>l(K)[q]||"")))},[()=>({fullpage:l(M).includes("img-page")})]),Ae(T,Y)}),Ae(g,x)},Xa=g=>{var x=Li(),b=Rn(x);kt(b,1,()=>l(Ne),bt,(T,M,q)=>{var Y=jc(),W=y(Y),re=y(W),ke=y(re),oe=k(re,2);let se;var Me=y(oe);wt(Me,()=>(l(M),U(()=>l(M)[0]||"")));var vt=k(oe,2),Ht=y(vt),An=k(vt,2);An.textContent=2*q+1;var Ja=k(W,4),bi=y(Ja),Ka=y(bi),zn=k(bi,2);let ki;var el=y(zn);wt(el,()=>(l(M),U(()=>l(M)[1]||"")));var wi=k(zn,2),tl=y(wi),nl=k(wi,2);nl.textContent=2*q+2,_e((rl,il)=>{ce(ke,(l(V),U(()=>q===0?"":l(V)[2*q-1]||""))),se=it(oe,1,"print-inner",null,se,rl),ce(Ht,(l(K),U(()=>q===0?"":l(K)[2*q-1]||""))),ce(Ka,(l(V),U(()=>l(V)[2*q]||q===0&&l(V)[0]||""))),ki=it(zn,1,"print-inner",null,ki,il),ce(tl,(l(K),U(()=>l(K)[2*q]||q===0&&l(K)[0]||"")))},[()=>({fullpage:(l(M)[0]||"").includes("img-page")}),()=>({fullpage:(l(M)[1]||"").includes("img-page")})]),Ae(T,Y)}),Ae(g,x)};Ni(Va,g=>{l(I)==="pages"?g(Ya):g(Xa,!1)})}_e(g=>{ce(ja,`${g??""}%`),xt(di,`grid-template-columns:${l(be)}% 8px ${100-l(be)}%`),ce(Fa,`${l(H),U(()=>l(H).length)??""} pages · ${l(S)??""} col`),ce(Ua,l(ve)),xt(Ft,l(f)),xt(mi,`transform:scale(${l(n)}); transform-origin: top left;`)},[()=>(l(Q),U(()=>Math.round(l(Q))))]),ue(ka,()=>l(_),g=>w(_,g)),yt(Ar,()=>l(h),g=>w(h,g)),Z("click",wa,()=>{w(v,{...st[l(h)].margins})}),ue(xa,()=>l(v).top,g=>Ut(v,l(v).top=g)),ue(ya,()=>l(v).right,g=>Ut(v,l(v).right=g)),ue(Sa,()=>l(v).bottom,g=>Ut(v,l(v).bottom=g)),ue(Ea,()=>l(v).left,g=>Ut(v,l(v).left=g)),ue(Aa,()=>l(S),g=>w(S,g)),ue(Ta,()=>l(E),g=>w(E,g)),yt(Mr,()=>l(z),g=>w(z,g)),ue(Ra,()=>l(j),g=>w(j,g)),ue(Ia,()=>l(R),g=>w(R,g)),Z("click",Dr,ma),Z("click",Br,ba),yt(Hr,()=>l($),g=>w($,g)),yt(Zr,()=>l(A),g=>w(A,g)),yt(Vr,()=>l(I),g=>w(I,g)),Z("click",Jr,ua),Z("click",Kr,fa),Z("change",ei,g=>vr(g,!1)),Z("change",ti,g=>vr(g,!0)),Z("click",ni,()=>document.getElementById("image_input").click()),Z("click",ri,()=>document.getElementById("image_input_full").click()),Z("click",ii,()=>sa("span-all")),Z("click",ai,ca),Z("click",li,la),Z("click",Na,oa),Z("click",ci,ia),Z("change",ui,He),Z("click",fi,()=>document.getElementById("import_book").click()),Z("click",Ma,ga),ue(pi,()=>l(Q),g=>w(Q,g)),Z("click",hi,()=>w(Q,100)),ue(Bt,()=>l(m),g=>w(m,g)),Z("paste",Bt,da),Z("dragover",Dt,go(ha)),Z("drop",Dt,pa),Z("mousedown",vi,va),Ae(e,xr),ts()}ao(Bc,{target:document.getElementById("app")});
